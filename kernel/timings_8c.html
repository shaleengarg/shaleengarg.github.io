<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linux/kernel: irq/timings.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linux/kernel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2afccf18bcf8d7f040e2ec2def3a539b.html">irq</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">timings.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/kernel.h&gt;</code><br />
<code>#include &lt;linux/percpu.h&gt;</code><br />
<code>#include &lt;linux/slab.h&gt;</code><br />
<code>#include &lt;linux/static_key.h&gt;</code><br />
<code>#include &lt;linux/interrupt.h&gt;</code><br />
<code>#include &lt;linux/idr.h&gt;</code><br />
<code>#include &lt;linux/irq.h&gt;</code><br />
<code>#include &lt;linux/math64.h&gt;</code><br />
<code>#include &lt;trace/events/irq.h&gt;</code><br />
<code>#include &quot;<a class="el" href="internals_8h_source.html">internals.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for timings.c:</div>
<div class="dyncontent">
<div class="center"><img src="timings_8c__incl.png" border="0" usemap="#irq_2timings_8c" alt=""/></div>
<map name="irq_2timings_8c" id="irq_2timings_8c">
<area shape="rect" id="node11" href="internals_8h.html" title="internals.h" alt="" coords="1135,80,1217,107"/>
<area shape="rect" id="node16" href="debug_8h.html" title="debug.h" alt="" coords="1346,155,1414,181"/>
<area shape="rect" id="node17" href="settings_8h.html" title="settings.h" alt="" coords="1438,155,1517,181"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structirqt__stat.html">irqt_stat</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a04cbe298536d84deb154ce74032cfcfd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#a04cbe298536d84deb154ce74032cfcfd">DEFINE_STATIC_KEY_FALSE</a> (irq_timing_enabled)</td></tr>
<tr class="separator:a04cbe298536d84deb154ce74032cfcfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a85fa763fba380868ecf855e4f046f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#a3a85fa763fba380868ecf855e4f046f6">DEFINE_PER_CPU</a> (struct irq_timings, irq_timings)</td></tr>
<tr class="separator:a3a85fa763fba380868ecf855e4f046f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbbd57a6e8ebab8d23b0ad7b27b6ad17"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#acbbd57a6e8ebab8d23b0ad7b27b6ad17">DEFINE_IDR</a> (irqt_stats)</td></tr>
<tr class="separator:acbbd57a6e8ebab8d23b0ad7b27b6ad17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000e6705022db1c5078046facfddb2f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#a000e6705022db1c5078046facfddb2f8">irq_timings_enable</a> (void)</td></tr>
<tr class="separator:a000e6705022db1c5078046facfddb2f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47fcb76deb41db744ff77e80734a8177"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#a47fcb76deb41db744ff77e80734a8177">irq_timings_disable</a> (void)</td></tr>
<tr class="separator:a47fcb76deb41db744ff77e80734a8177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4691bcccd0280f6dec0fca375a848bde"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#a4691bcccd0280f6dec0fca375a848bde">irqs_update</a> (struct <a class="el" href="structirqt__stat.html">irqt_stat</a> *irqs, u64 ts)</td></tr>
<tr class="separator:a4691bcccd0280f6dec0fca375a848bde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c7aed3825512b48d882d577e73aeacc"><td class="memItemLeft" align="right" valign="top">u64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#a5c7aed3825512b48d882d577e73aeacc">irq_timings_next_event</a> (u64 now)</td></tr>
<tr class="separator:a5c7aed3825512b48d882d577e73aeacc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af023b5525c863dc239fd6f81d6b5944b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#af023b5525c863dc239fd6f81d6b5944b">irq_timings_free</a> (int irq)</td></tr>
<tr class="separator:af023b5525c863dc239fd6f81d6b5944b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a731fbd755b6c71dcfd81d3f3a585f3a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timings_8c.html#a731fbd755b6c71dcfd81d3f3a585f3a8">irq_timings_alloc</a> (int irq)</td></tr>
<tr class="separator:a731fbd755b6c71dcfd81d3f3a585f3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="acbbd57a6e8ebab8d23b0ad7b27b6ad17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbbd57a6e8ebab8d23b0ad7b27b6ad17">&#9670;&nbsp;</a></span>DEFINE_IDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static DEFINE_IDR </td>
          <td>(</td>
          <td class="paramtype">irqt_stats&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3a85fa763fba380868ecf855e4f046f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a85fa763fba380868ecf855e4f046f6">&#9670;&nbsp;</a></span>DEFINE_PER_CPU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_PER_CPU </td>
          <td>(</td>
          <td class="paramtype">struct irq_timings&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">irq_timings&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a04cbe298536d84deb154ce74032cfcfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04cbe298536d84deb154ce74032cfcfd">&#9670;&nbsp;</a></span>DEFINE_STATIC_KEY_FALSE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_STATIC_KEY_FALSE </td>
          <td>(</td>
          <td class="paramtype">irq_timing_enabled&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a731fbd755b6c71dcfd81d3f3a585f3a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a731fbd755b6c71dcfd81d3f3a585f3a8">&#9670;&nbsp;</a></span>irq_timings_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int irq_timings_alloc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>irq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="timings_8c_a731fbd755b6c71dcfd81d3f3a585f3a8_icgraph.png" border="0" usemap="#timings_8c_a731fbd755b6c71dcfd81d3f3a585f3a8_icgraph" alt=""/></div>
<map name="timings_8c_a731fbd755b6c71dcfd81d3f3a585f3a8_icgraph" id="timings_8c_a731fbd755b6c71dcfd81d3f3a585f3a8_icgraph">
<area shape="rect" id="node2" href="internals_8h.html#a22beb7f32bcd2acd3151122908298b6b" title="irq_pm_remove_action" alt="" coords="172,31,325,57"/>
<area shape="rect" id="node3" href="internals_8h.html#a6b2f7d69a77fa9fbf21fbe15ecd79ed6" title="irq_desc_is_chained" alt="" coords="373,31,513,57"/>
<area shape="rect" id="node4" href="pm_8c.html#a391df03db1485b944149824ddbf93fdb" title="suspend_device_irq" alt="" coords="561,5,699,32"/>
<area shape="rect" id="node6" href="proc_8c.html#a7ec2f5f133407333cf5e6ad40e8f1588" title="init_irq_proc" alt="" coords="584,56,676,83"/>
<area shape="rect" id="node5" href="pm_8c.html#a0c327e13fc051112d2fc49f774624f4d" title="suspend_device_irqs" alt="" coords="747,5,891,32"/>
</map>
</div>

</div>
</div>
<a id="a47fcb76deb41db744ff77e80734a8177"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47fcb76deb41db744ff77e80734a8177">&#9670;&nbsp;</a></span>irq_timings_disable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void irq_timings_disable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="timings_8c_a47fcb76deb41db744ff77e80734a8177_icgraph.png" border="0" usemap="#timings_8c_a47fcb76deb41db744ff77e80734a8177_icgraph" alt=""/></div>
<map name="timings_8c_a47fcb76deb41db744ff77e80734a8177_icgraph" id="timings_8c_a47fcb76deb41db744ff77e80734a8177_icgraph">
<area shape="rect" id="node2" href="internals_8h.html#a22beb7f32bcd2acd3151122908298b6b" title="irq_pm_remove_action" alt="" coords="187,31,340,57"/>
<area shape="rect" id="node3" href="internals_8h.html#a6b2f7d69a77fa9fbf21fbe15ecd79ed6" title="irq_desc_is_chained" alt="" coords="388,31,528,57"/>
<area shape="rect" id="node4" href="pm_8c.html#a391df03db1485b944149824ddbf93fdb" title="suspend_device_irq" alt="" coords="576,5,713,32"/>
<area shape="rect" id="node6" href="proc_8c.html#a7ec2f5f133407333cf5e6ad40e8f1588" title="init_irq_proc" alt="" coords="599,56,691,83"/>
<area shape="rect" id="node5" href="pm_8c.html#a0c327e13fc051112d2fc49f774624f4d" title="suspend_device_irqs" alt="" coords="761,5,905,32"/>
</map>
</div>

</div>
</div>
<a id="a000e6705022db1c5078046facfddb2f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000e6705022db1c5078046facfddb2f8">&#9670;&nbsp;</a></span>irq_timings_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void irq_timings_enable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="timings_8c_a000e6705022db1c5078046facfddb2f8_icgraph.png" border="0" usemap="#timings_8c_a000e6705022db1c5078046facfddb2f8_icgraph" alt=""/></div>
<map name="timings_8c_a000e6705022db1c5078046facfddb2f8_icgraph" id="timings_8c_a000e6705022db1c5078046facfddb2f8_icgraph">
<area shape="rect" id="node2" href="internals_8h.html#a22beb7f32bcd2acd3151122908298b6b" title="irq_pm_remove_action" alt="" coords="184,31,337,57"/>
<area shape="rect" id="node3" href="internals_8h.html#a6b2f7d69a77fa9fbf21fbe15ecd79ed6" title="irq_desc_is_chained" alt="" coords="385,31,525,57"/>
<area shape="rect" id="node4" href="pm_8c.html#a391df03db1485b944149824ddbf93fdb" title="suspend_device_irq" alt="" coords="573,5,711,32"/>
<area shape="rect" id="node6" href="proc_8c.html#a7ec2f5f133407333cf5e6ad40e8f1588" title="init_irq_proc" alt="" coords="596,56,688,83"/>
<area shape="rect" id="node5" href="pm_8c.html#a0c327e13fc051112d2fc49f774624f4d" title="suspend_device_irqs" alt="" coords="759,5,903,32"/>
</map>
</div>

</div>
</div>
<a id="af023b5525c863dc239fd6f81d6b5944b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af023b5525c863dc239fd6f81d6b5944b">&#9670;&nbsp;</a></span>irq_timings_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void irq_timings_free </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>irq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="timings_8c_af023b5525c863dc239fd6f81d6b5944b_icgraph.png" border="0" usemap="#timings_8c_af023b5525c863dc239fd6f81d6b5944b_icgraph" alt=""/></div>
<map name="timings_8c_af023b5525c863dc239fd6f81d6b5944b_icgraph" id="timings_8c_af023b5525c863dc239fd6f81d6b5944b_icgraph">
<area shape="rect" id="node2" href="internals_8h.html#a22beb7f32bcd2acd3151122908298b6b" title="irq_pm_remove_action" alt="" coords="168,31,321,57"/>
<area shape="rect" id="node3" href="internals_8h.html#a6b2f7d69a77fa9fbf21fbe15ecd79ed6" title="irq_desc_is_chained" alt="" coords="369,31,509,57"/>
<area shape="rect" id="node4" href="pm_8c.html#a391df03db1485b944149824ddbf93fdb" title="suspend_device_irq" alt="" coords="557,5,695,32"/>
<area shape="rect" id="node6" href="proc_8c.html#a7ec2f5f133407333cf5e6ad40e8f1588" title="init_irq_proc" alt="" coords="580,56,672,83"/>
<area shape="rect" id="node5" href="pm_8c.html#a0c327e13fc051112d2fc49f774624f4d" title="suspend_device_irqs" alt="" coords="743,5,887,32"/>
</map>
</div>

</div>
</div>
<a id="a5c7aed3825512b48d882d577e73aeacc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c7aed3825512b48d882d577e73aeacc">&#9670;&nbsp;</a></span>irq_timings_next_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u64 irq_timings_next_event </td>
          <td>(</td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>irq_timings_next_event - Return when the next event is supposed to arrive</p>
<p>During the last busy cycle, the number of interrupts is incremented and stored in the irq_timings structure. This information is necessary to:</p>
<ul>
<li><p class="startli">know if the index in the table wrapped up:</p>
<p class="startli">If more than the array size interrupts happened during the last busy/idle cycle, the index wrapped up and we have to begin with the next element in the array which is the last one in the sequence, otherwise it is a the index 0.</p>
</li>
<li>have an indication of the interrupts activity on this CPU (eg. irq/sec)</li>
</ul>
<p>The values are 'consumed' after inserting in the statistical model, thus the count is reinitialized.</p>
<p>The array of values <b>must</b> be browsed in the time direction, the timestamp must increase between an element and the next one.</p>
<p>Returns a nanosec time based estimation of the earliest interrupt, U64_MAX otherwise. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="timings_8c_a5c7aed3825512b48d882d577e73aeacc_cgraph.png" border="0" usemap="#timings_8c_a5c7aed3825512b48d882d577e73aeacc_cgraph" alt=""/></div>
<map name="timings_8c_a5c7aed3825512b48d882d577e73aeacc_cgraph" id="timings_8c_a5c7aed3825512b48d882d577e73aeacc_cgraph">
<area shape="rect" id="node2" href="timings_8c.html#a4691bcccd0280f6dec0fca375a848bde" title="irqs_update" alt="" coords="209,5,299,32"/>
</map>
</div>

</div>
</div>
<a id="a4691bcccd0280f6dec0fca375a848bde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4691bcccd0280f6dec0fca375a848bde">&#9670;&nbsp;</a></span>irqs_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void irqs_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structirqt__stat.html">irqt_stat</a> *&#160;</td>
          <td class="paramname"><em>irqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>ts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>irqs_update - update the irq timing statistics with a new timestamp</p>
<p>: an <a class="el" href="structirqt__stat.html">irqt_stat</a> struct pointer : the new timestamp</p>
<p>The statistics are computed online, in other words, the code is designed to compute the statistics on a stream of values rather than doing multiple passes on the values to compute the average, then the variance. The integer division introduces a loss of precision but with an acceptable error margin regarding the results we would have with the double floating precision: we are dealing with nanosec, so big numbers, consequently the mantisse is negligeable, especially when converting the time in usec afterwards.</p>
<p>The computation happens at idle time. When the CPU is not idle, the interrupts' timestamps are stored in the circular buffer, when the CPU goes idle and this routine is called, all the buffer's values are injected in the statistical model continuying to extend the statistics from the previous busy-idle cycle.</p>
<p>The observations showed a device will trigger a burst of periodic interrupts followed by one or two peaks of longer time, for instance when a SD card device flushes its cache, then the periodic intervals occur again. A one second inactivity period resets the stats, that gives us the certitude the statistical values won't exceed 1x10^9, thus the computation won't overflow.</p>
<p>Basically, the purpose of the algorithm is to watch the periodic interrupts and eliminate the peaks.</p>
<p>An interrupt is considered periodically stable if the interval of its occurences follow the normal distribution, thus the values comply with: </p><pre class="fragment"> avg - 3 x stddev &lt; value &lt; avg + 3 x stddev
</pre><p>Which can be simplified to: </p><pre class="fragment"> -3 x stddev &lt; value - avg &lt; 3 x stddev

 abs(value - avg) &lt; 3 x stddev
</pre><p>In order to save a costly square root computation, we use the variance. For the record, stddev = sqrt(variance). The equation above becomes: </p><pre class="fragment"> abs(value - avg) &lt; 3 x sqrt(variance)
</pre><p>And finally we square it: </p><pre class="fragment"> (value - avg) ^ 2 &lt; (3 x sqrt(variance)) ^ 2

 (value - avg) x (value - avg) &lt; 9 x variance
</pre><p>Statistically speaking, any values out of this interval is considered as an anomaly and is discarded. However, a normal distribution appears when the number of samples is 30 (it is the rule of thumb in statistics, cf. "30 samples" on Internet). When there are three consecutive anomalies, the statistics are resetted. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="timings_8c_a4691bcccd0280f6dec0fca375a848bde_icgraph.png" border="0" usemap="#timings_8c_a4691bcccd0280f6dec0fca375a848bde_icgraph" alt=""/></div>
<map name="timings_8c_a4691bcccd0280f6dec0fca375a848bde_icgraph" id="timings_8c_a4691bcccd0280f6dec0fca375a848bde_icgraph">
<area shape="rect" id="node2" href="timings_8c.html#a5c7aed3825512b48d882d577e73aeacc" title="irq_timings_next_event" alt="" coords="143,5,299,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
