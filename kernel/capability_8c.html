<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linux/kernel: capability.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linux/kernel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('capability_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">capability.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/audit.h&gt;</code><br />
<code>#include &lt;linux/capability.h&gt;</code><br />
<code>#include &lt;linux/mm.h&gt;</code><br />
<code>#include &lt;linux/export.h&gt;</code><br />
<code>#include &lt;linux/security.h&gt;</code><br />
<code>#include &lt;linux/syscalls.h&gt;</code><br />
<code>#include &lt;linux/pid_namespace.h&gt;</code><br />
<code>#include &lt;linux/user_namespace.h&gt;</code><br />
<code>#include &lt;linux/uaccess.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for capability.c:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c__incl.png" border="0" usemap="#capability_8c" alt=""/></div>
<map name="capability_8c" id="capability_8c">
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1f8c165bf4196327bc3abff648276d92"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a1f8c165bf4196327bc3abff648276d92">pr_fmt</a>(fmt)&#160;&#160;&#160;KBUILD_MODNAME &quot;: &quot; fmt</td></tr>
<tr class="separator:a1f8c165bf4196327bc3abff648276d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9ebeeb46bac46029df9af960321c15f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a9ebeeb46bac46029df9af960321c15f0">EXPORT_SYMBOL</a> (<a class="el" href="capability_8c.html#a3c192236bcea145545aed1763fa26b0c">__cap_empty_set</a>)</td></tr>
<tr class="separator:a9ebeeb46bac46029df9af960321c15f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4383412385cfd16b710e8c88ea21dda5"><td class="memItemLeft" align="right" valign="top">static int __init&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a4383412385cfd16b710e8c88ea21dda5">file_caps_disable</a> (char *str)</td></tr>
<tr class="separator:a4383412385cfd16b710e8c88ea21dda5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54fa6717cffe6a85586fb015366c9fbf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a54fa6717cffe6a85586fb015366c9fbf">__setup</a> (&quot;no_file_caps&quot;, file_caps_disable)</td></tr>
<tr class="separator:a54fa6717cffe6a85586fb015366c9fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08dc3ef52010e537d0245d595ca06513"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a08dc3ef52010e537d0245d595ca06513">file_ns_capable</a> (const struct file *file, struct user_namespace *ns, int cap)</td></tr>
<tr class="separator:a08dc3ef52010e537d0245d595ca06513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a482bfcb1e8a9597f3096f3264c86b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a5a482bfcb1e8a9597f3096f3264c86b7">EXPORT_SYMBOL</a> (<a class="el" href="capability_8c.html#a08dc3ef52010e537d0245d595ca06513">file_ns_capable</a>)</td></tr>
<tr class="separator:a5a482bfcb1e8a9597f3096f3264c86b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c3e14a4220912450452d20d62a791db"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a1c3e14a4220912450452d20d62a791db">privileged_wrt_inode_uidgid</a> (struct user_namespace *ns, const struct inode *inode)</td></tr>
<tr class="separator:a1c3e14a4220912450452d20d62a791db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fd2807eceb354784672589e0ceaedbd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a7fd2807eceb354784672589e0ceaedbd">capable_wrt_inode_uidgid</a> (const struct inode *inode, int cap)</td></tr>
<tr class="separator:a7fd2807eceb354784672589e0ceaedbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab76ef662d7d1ae3e3717059e404cd0d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#aab76ef662d7d1ae3e3717059e404cd0d">EXPORT_SYMBOL</a> (<a class="el" href="capability_8c.html#a7fd2807eceb354784672589e0ceaedbd">capable_wrt_inode_uidgid</a>)</td></tr>
<tr class="separator:aab76ef662d7d1ae3e3717059e404cd0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce6160a031ac5a4691f029ff7d2ca3a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a9ce6160a031ac5a4691f029ff7d2ca3a">ptracer_capable</a> (struct task_struct *tsk, struct user_namespace *ns)</td></tr>
<tr class="separator:a9ce6160a031ac5a4691f029ff7d2ca3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3c192236bcea145545aed1763fa26b0c"><td class="memItemLeft" align="right" valign="top">const kernel_cap_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a3c192236bcea145545aed1763fa26b0c">__cap_empty_set</a> = CAP_EMPTY_SET</td></tr>
<tr class="separator:a3c192236bcea145545aed1763fa26b0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ef2a06941a6f2805efa2e096b3d5fe6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="capability_8c.html#a1ef2a06941a6f2805efa2e096b3d5fe6">file_caps_enabled</a> = 1</td></tr>
<tr class="separator:a1ef2a06941a6f2805efa2e096b3d5fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1f8c165bf4196327bc3abff648276d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f8c165bf4196327bc3abff648276d92">&#9670;&nbsp;</a></span>pr_fmt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define pr_fmt</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt</td><td>)</td>
          <td>&#160;&#160;&#160;KBUILD_MODNAME &quot;: &quot; fmt</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a54fa6717cffe6a85586fb015366c9fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54fa6717cffe6a85586fb015366c9fbf">&#9670;&nbsp;</a></span>__setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__setup </td>
          <td>(</td>
          <td class="paramtype">&quot;no_file_caps&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="capability_8c.html#a4383412385cfd16b710e8c88ea21dda5">file_caps_disable</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c_a54fa6717cffe6a85586fb015366c9fbf_icgraph.png" border="0" usemap="#capability_8c_a54fa6717cffe6a85586fb015366c9fbf_icgraph" alt=""/></div>
<map name="capability_8c_a54fa6717cffe6a85586fb015366c9fbf_icgraph" id="capability_8c_a54fa6717cffe6a85586fb015366c9fbf_icgraph">
<area shape="rect" id="node2" href="capability_8c.html#a4383412385cfd16b710e8c88ea21dda5" title="file_caps_disable" alt="" coords="121,5,244,32"/>
</map>
</div>

</div>
</div>
<a id="a7fd2807eceb354784672589e0ceaedbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fd2807eceb354784672589e0ceaedbd">&#9670;&nbsp;</a></span>capable_wrt_inode_uidgid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool capable_wrt_inode_uidgid </td>
          <td>(</td>
          <td class="paramtype">const struct inode *&#160;</td>
          <td class="paramname"><em>inode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>capable_wrt_inode_uidgid - Check nsown_capable and uid and gid mapped : The inode in question : The capability in question</p>
<p>Return true if the current task has the given capability targeted at its own user namespace and that the given inode's uid and gid are mapped into the current user namespace. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c_a7fd2807eceb354784672589e0ceaedbd_cgraph.png" border="0" usemap="#capability_8c_a7fd2807eceb354784672589e0ceaedbd_cgraph" alt=""/></div>
<map name="capability_8c_a7fd2807eceb354784672589e0ceaedbd_cgraph" id="capability_8c_a7fd2807eceb354784672589e0ceaedbd_cgraph">
<area shape="rect" id="node2" href="capability_8c.html#a1c3e14a4220912450452d20d62a791db" title="privileged_wrt_inode\l_uidgid" alt="" coords="224,5,364,47"/>
<area shape="rect" id="node3" href="capability_8c.html#a9ebeeb46bac46029df9af960321c15f0" title="EXPORT_SYMBOL" alt="" coords="225,71,363,98"/>
</map>
</div>

</div>
</div>
<a id="a9ebeeb46bac46029df9af960321c15f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ebeeb46bac46029df9af960321c15f0">&#9670;&nbsp;</a></span>EXPORT_SYMBOL() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="capability_8c.html#a3c192236bcea145545aed1763fa26b0c">__cap_empty_set</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c_a9ebeeb46bac46029df9af960321c15f0_icgraph.png" border="0" usemap="#capability_8c_a9ebeeb46bac46029df9af960321c15f0_icgraph" alt=""/></div>
<map name="capability_8c_a9ebeeb46bac46029df9af960321c15f0_icgraph" id="capability_8c_a9ebeeb46bac46029df9af960321c15f0_icgraph">
<area shape="rect" id="node2" href="capability_8c.html#a4383412385cfd16b710e8c88ea21dda5" title="file_caps_disable" alt="" coords="216,31,339,57"/>
<area shape="rect" id="node3" href="capability_8c.html#a08dc3ef52010e537d0245d595ca06513" title="file_ns_capable" alt="" coords="221,81,333,108"/>
<area shape="rect" id="node12" href="capability_8c.html#a7fd2807eceb354784672589e0ceaedbd" title="capable_wrt_inode_uidgid" alt="" coords="192,132,363,159"/>
<area shape="rect" id="node4" href="resource_8c.html#af92e072fbe57068ecf0d2b8c4c2f58f7" title="r_next" alt="" coords="456,31,515,57"/>
<area shape="rect" id="node7" href="user__namespace_8c.html#a1e5c43866a243b5ba0fc0a9cd6b60060" title="map_write" alt="" coords="655,119,738,145"/>
<area shape="rect" id="node11" href="user__namespace_8c.html#ac640cd879c90db9e1db4b273915e32f6" title="new_idmap_permitted" alt="" coords="411,132,560,159"/>
<area shape="rect" id="node5" href="resource_8c.html#acf5bc0c60fc2b71e1510e7ac60bb1b26" title="iomem_map_sanity_check" alt="" coords="608,5,785,32"/>
<area shape="rect" id="node6" href="resource_8c.html#a184eef72c2fa756b02f90b48a2dd753b" title="iomem_is_exclusive" alt="" coords="627,56,767,83"/>
<area shape="rect" id="node8" href="user__namespace_8c.html#a80bc0e2862f5831a39aef4b9d2866744" title="proc_uid_map_write" alt="" coords="840,68,979,95"/>
<area shape="rect" id="node9" href="user__namespace_8c.html#ab94ee35b0f0178b555d280b66cbbebfb" title="proc_gid_map_write" alt="" coords="840,119,979,145"/>
<area shape="rect" id="node10" href="user__namespace_8c.html#a05eb79f9cde2a28d7bdfbfaebbfda927" title="proc_projid_map_write" alt="" coords="833,169,985,196"/>
</map>
</div>

</div>
</div>
<a id="a5a482bfcb1e8a9597f3096f3264c86b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a482bfcb1e8a9597f3096f3264c86b7">&#9670;&nbsp;</a></span>EXPORT_SYMBOL() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="capability_8c.html#a08dc3ef52010e537d0245d595ca06513">file_ns_capable</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aab76ef662d7d1ae3e3717059e404cd0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab76ef662d7d1ae3e3717059e404cd0d">&#9670;&nbsp;</a></span>EXPORT_SYMBOL() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="capability_8c.html#a7fd2807eceb354784672589e0ceaedbd">capable_wrt_inode_uidgid</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4383412385cfd16b710e8c88ea21dda5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4383412385cfd16b710e8c88ea21dda5">&#9670;&nbsp;</a></span>file_caps_disable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __init file_caps_disable </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c_a4383412385cfd16b710e8c88ea21dda5_cgraph.png" border="0" usemap="#capability_8c_a4383412385cfd16b710e8c88ea21dda5_cgraph" alt=""/></div>
<map name="capability_8c_a4383412385cfd16b710e8c88ea21dda5_cgraph" id="capability_8c_a4383412385cfd16b710e8c88ea21dda5_cgraph">
<area shape="rect" id="node2" href="capability_8c.html#a54fa6717cffe6a85586fb015366c9fbf" title="__setup" alt="" coords="215,56,283,83"/>
<area shape="rect" id="node3" href="pid_8c.html#af075039d0d8ec1e5b7a9a867955642dc" title="find_task_by_vpid" alt="" coords="186,107,313,133"/>
<area shape="rect" id="node10" href="futex_8c.html#a9be33ba9ef2900b7d353516aa28953da" title="SYSCALL_DEFINE2" alt="" coords="176,157,323,184"/>
<area shape="rect" id="node11" href="cred_8c.html#aae17c6a2e03b98739c06f01fc324148b" title="prepare_creds" alt="" coords="197,208,301,235"/>
<area shape="rect" id="node13" href="cred_8c.html#ad290f71432e80bcea2b8f59edf356ab7" title="abort_creds" alt="" coords="399,259,489,285"/>
<area shape="rect" id="node16" href="cred_8c.html#a5fa73ef22873164a105b62f7e56f2f0c" title="commit_creds" alt="" coords="392,309,496,336"/>
<area shape="rect" id="node19" href="capability_8c.html#a9ebeeb46bac46029df9af960321c15f0" title="EXPORT_SYMBOL" alt="" coords="180,360,319,387"/>
<area shape="rect" id="node4" href="pid_8c.html#af70fb3dc88568a19fbbc923e0e0e327b" title="find_task_by_pid_ns" alt="" coords="373,56,515,83"/>
<area shape="rect" id="node9" href="pid_8c.html#aa94fe396f2fa94f1ad5a869a8eea8244" title="task_active_pid_ns" alt="" coords="377,107,511,133"/>
<area shape="rect" id="node5" href="pid_8c.html#a75123b0c8154ceabf56d0ab969a53b9a" title="pid_task" alt="" coords="607,5,677,32"/>
<area shape="rect" id="node7" href="pid_8c.html#abcbe556500524c0bc0ceb59210c3beec" title="find_pid_ns" alt="" coords="598,56,686,83"/>
<area shape="rect" id="node6" href="pid_8c.html#aff1d1f4744a61562f2e537a6b79bcc1d" title="EXPORT_SYMBOL" alt="" coords="783,5,922,32"/>
<area shape="rect" id="node8" href="pid_8c.html#abde93ee1205f66322131353b6a8757b2" title="EXPORT_SYMBOL_GPL" alt="" coords="767,81,939,108"/>
<area shape="rect" id="node12" href="cred_8c.html#ac95c30bfb1ac0cde3e088c2b1a4966fe" title="set_cred_subscribers" alt="" coords="371,157,517,184"/>
<area shape="rect" id="node15" href="cred_8c.html#aa3db4889c8ed414e4b1a22732cb7aacf" title="EXPORT_SYMBOL" alt="" coords="573,208,711,235"/>
<area shape="rect" id="node14" href="cred_8c.html#ac0f6d775e0a6862c6e15d2cd63ec880c" title="read_cred_subscribers" alt="" coords="565,259,719,285"/>
<area shape="rect" id="node17" href="cred_8c.html#a05d98f28ff77e1618ec8152a9f35325a" title="cred_cap_issubset" alt="" coords="577,360,707,387"/>
<area shape="rect" id="node18" href="cred_8c.html#acab5f1f563b97061ade28a4c2c78ff68" title="alter_cred_subscribers" alt="" coords="565,309,719,336"/>
</map>
</div>

</div>
</div>
<a id="a08dc3ef52010e537d0245d595ca06513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08dc3ef52010e537d0245d595ca06513">&#9670;&nbsp;</a></span>file_ns_capable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool file_ns_capable </td>
          <td>(</td>
          <td class="paramtype">const struct file *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct user_namespace *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c_a08dc3ef52010e537d0245d595ca06513_cgraph.png" border="0" usemap="#capability_8c_a08dc3ef52010e537d0245d595ca06513_cgraph" alt=""/></div>
<map name="capability_8c_a08dc3ef52010e537d0245d595ca06513_cgraph" id="capability_8c_a08dc3ef52010e537d0245d595ca06513_cgraph">
<area shape="rect" id="node2" href="capability_8c.html#a9ebeeb46bac46029df9af960321c15f0" title="EXPORT_SYMBOL" alt="" coords="165,5,304,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c_a08dc3ef52010e537d0245d595ca06513_icgraph.png" border="0" usemap="#capability_8c_a08dc3ef52010e537d0245d595ca06513_icgraph" alt=""/></div>
<map name="capability_8c_a08dc3ef52010e537d0245d595ca06513_icgraph" id="capability_8c_a08dc3ef52010e537d0245d595ca06513_icgraph">
<area shape="rect" id="node2" href="resource_8c.html#af92e072fbe57068ecf0d2b8c4c2f58f7" title="r_next" alt="" coords="211,31,269,57"/>
<area shape="rect" id="node5" href="user__namespace_8c.html#a1e5c43866a243b5ba0fc0a9cd6b60060" title="map_write" alt="" coords="410,119,493,145"/>
<area shape="rect" id="node9" href="user__namespace_8c.html#ac640cd879c90db9e1db4b273915e32f6" title="new_idmap_permitted" alt="" coords="165,132,315,159"/>
<area shape="rect" id="node3" href="resource_8c.html#acf5bc0c60fc2b71e1510e7ac60bb1b26" title="iomem_map_sanity_check" alt="" coords="363,5,540,32"/>
<area shape="rect" id="node4" href="resource_8c.html#a184eef72c2fa756b02f90b48a2dd753b" title="iomem_is_exclusive" alt="" coords="381,56,521,83"/>
<area shape="rect" id="node6" href="user__namespace_8c.html#a80bc0e2862f5831a39aef4b9d2866744" title="proc_uid_map_write" alt="" coords="595,68,733,95"/>
<area shape="rect" id="node7" href="user__namespace_8c.html#ab94ee35b0f0178b555d280b66cbbebfb" title="proc_gid_map_write" alt="" coords="595,119,733,145"/>
<area shape="rect" id="node8" href="user__namespace_8c.html#a05eb79f9cde2a28d7bdfbfaebbfda927" title="proc_projid_map_write" alt="" coords="588,169,740,196"/>
</map>
</div>

</div>
</div>
<a id="a1c3e14a4220912450452d20d62a791db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c3e14a4220912450452d20d62a791db">&#9670;&nbsp;</a></span>privileged_wrt_inode_uidgid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool privileged_wrt_inode_uidgid </td>
          <td>(</td>
          <td class="paramtype">struct user_namespace *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct inode *&#160;</td>
          <td class="paramname"><em>inode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>privileged_wrt_inode_uidgid - Do capabilities in the namespace work over the inode? : The user namespace in question : The inode in question</p>
<p>Return true if the inode uid and gid are within the namespace. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c_a1c3e14a4220912450452d20d62a791db_icgraph.png" border="0" usemap="#capability_8c_a1c3e14a4220912450452d20d62a791db_icgraph" alt=""/></div>
<map name="capability_8c_a1c3e14a4220912450452d20d62a791db_icgraph" id="capability_8c_a1c3e14a4220912450452d20d62a791db_icgraph">
<area shape="rect" id="node2" href="capability_8c.html#a7fd2807eceb354784672589e0ceaedbd" title="capable_wrt_inode_uidgid" alt="" coords="193,13,364,39"/>
</map>
</div>

</div>
</div>
<a id="a9ce6160a031ac5a4691f029ff7d2ca3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ce6160a031ac5a4691f029ff7d2ca3a">&#9670;&nbsp;</a></span>ptracer_capable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ptracer_capable </td>
          <td>(</td>
          <td class="paramtype">struct task_struct *&#160;</td>
          <td class="paramname"><em>tsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct user_namespace *&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ptracer_capable - Determine if the ptracer holds CAP_SYS_PTRACE in the namespace : The task that may be ptraced : The user namespace to search for CAP_SYS_PTRACE in</p>
<p>Return true if the task that is ptracing the current task had CAP_SYS_PTRACE in the specified user namespace. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="capability_8c_a9ce6160a031ac5a4691f029ff7d2ca3a_icgraph.png" border="0" usemap="#capability_8c_a9ce6160a031ac5a4691f029ff7d2ca3a_icgraph" alt=""/></div>
<map name="capability_8c_a9ce6160a031ac5a4691f029ff7d2ca3a_icgraph" id="capability_8c_a9ce6160a031ac5a4691f029ff7d2ca3a_icgraph">
<area shape="rect" id="node2" href="ptrace_8c.html#a926c735941e0ee68b84e4f458c9cc597" title="ptrace_access_vm" alt="" coords="168,81,300,108"/>
<area shape="rect" id="node3" href="ptrace_8c.html#a40518cc0f6fd111bc3d18036cd7787ae" title="ptrace_readdata" alt="" coords="374,5,489,32"/>
<area shape="rect" id="node4" href="ptrace_8c.html#a0acf2c7ceaf0d3aa42771bdb8031f4b9" title="ptrace_writedata" alt="" coords="372,56,491,83"/>
<area shape="rect" id="node5" href="ptrace_8c.html#a08d79c2e0c814d6c46b7cc5a0d67ceb2" title="generic_ptrace_peekdata" alt="" coords="348,107,515,133"/>
<area shape="rect" id="node7" href="ptrace_8c.html#aad4d3340d6dfdbb390ffee3d05054442" title="generic_ptrace_pokedata" alt="" coords="719,107,885,133"/>
<area shape="rect" id="node6" href="ptrace_8c.html#a997fa2d54d41aefc751e7f2881be3d89" title="ptrace_request" alt="" coords="563,107,671,133"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3c192236bcea145545aed1763fa26b0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c192236bcea145545aed1763fa26b0c">&#9670;&nbsp;</a></span>__cap_empty_set</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const kernel_cap_t __cap_empty_set = CAP_EMPTY_SET</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1ef2a06941a6f2805efa2e096b3d5fe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ef2a06941a6f2805efa2e096b3d5fe6">&#9670;&nbsp;</a></span>file_caps_enabled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int file_caps_enabled = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="capability_8c.html">capability.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
