<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linux/fs: ntfs/mft.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linux/fs
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mft_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mft.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/fs.h&gt;</code><br />
<code>#include &lt;linux/highmem.h&gt;</code><br />
<code>#include &lt;linux/pagemap.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ntfs_2inode_8h_source.html">inode.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for mft.h:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h__incl.png" border="0" usemap="#ntfs_2mft_8h" alt=""/></div>
<map name="ntfs_2mft_8h" id="ntfs_2mft_8h">
<area shape="rect" id="node5" href="ntfs_2inode_8h.html" title="inode.h" alt="" coords="357,80,421,107"/>
<area shape="rect" id="node11" href="layout_8h.html" title="layout.h" alt="" coords="330,379,398,405"/>
<area shape="rect" id="node15" href="types_8h.html" title="types.h" alt="" coords="665,453,730,480"/>
<area shape="rect" id="node16" href="volume_8h.html" title="volume.h" alt="" coords="452,304,527,331"/>
<area shape="rect" id="node19" href="runlist_8h.html" title="runlist.h" alt="" coords="453,229,521,256"/>
<area shape="rect" id="node20" href="ntfs_2debug_8h.html" title="debug.h" alt="" coords="81,155,149,181"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h__dep__incl.png" border="0" usemap="#ntfs_2mft_8hdep" alt=""/></div>
<map name="ntfs_2mft_8hdep" id="ntfs_2mft_8hdep">
<area shape="rect" id="node2" href="ntfs_2aops_8c.html" title="ntfs/aops.c" alt="" coords="5,80,92,107"/>
<area shape="rect" id="node3" href="attrib_8c.html" title="ntfs/attrib.c" alt="" coords="117,80,205,107"/>
<area shape="rect" id="node4" href="ntfs_2dir_8c.html" title="ntfs/dir.c" alt="" coords="229,80,303,107"/>
<area shape="rect" id="node5" href="ntfs_2file_8c.html" title="ntfs/file.c" alt="" coords="327,80,403,107"/>
<area shape="rect" id="node6" href="index_8h.html" title="ntfs/index.h" alt="" coords="427,80,518,107"/>
<area shape="rect" id="node9" href="ntfs_2inode_8c.html" title="ntfs/inode.c" alt="" coords="542,80,633,107"/>
<area shape="rect" id="node10" href="mft_8c.html" title="ntfs/mft.c" alt="" coords="657,80,736,107"/>
<area shape="rect" id="node11" href="ntfs_2namei_8c.html" title="ntfs/namei.c" alt="" coords="760,80,855,107"/>
<area shape="rect" id="node7" href="index_8c.html" title="ntfs/index.c" alt="" coords="370,155,461,181"/>
<area shape="rect" id="node8" href="ntfs_2super_8c.html" title="ntfs/super.c" alt="" coords="485,155,575,181"/>
</map>
</div>
</div>
<p><a href="mft_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aab879cd658d486f45345e08fa15f276c"><td class="memItemLeft" align="right" valign="top">MFT_RECORD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mft_8h.html#aab879cd658d486f45345e08fa15f276c">map_mft_record</a> (<a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> *ni)</td></tr>
<tr class="separator:aab879cd658d486f45345e08fa15f276c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdca69e797b129f8be7643ed91f691bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mft_8h.html#acdca69e797b129f8be7643ed91f691bd">unmap_mft_record</a> (<a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> *ni)</td></tr>
<tr class="separator:acdca69e797b129f8be7643ed91f691bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf9229d5b335c334e2fc0a9a33eef54b"><td class="memItemLeft" align="right" valign="top">MFT_RECORD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mft_8h.html#abf9229d5b335c334e2fc0a9a33eef54b">map_extent_mft_record</a> (<a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> *base_ni, <a class="el" href="layout_8h.html#ae241e6fcd8dd743bca056ecbdb614973">MFT_REF</a> mref, <a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> **ntfs_ino)</td></tr>
<tr class="separator:abf9229d5b335c334e2fc0a9a33eef54b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a811ffb1e431fb1a2eb8646378b4cebe4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mft_8h.html#a811ffb1e431fb1a2eb8646378b4cebe4">unmap_extent_mft_record</a> (<a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> *ni)</td></tr>
<tr class="separator:a811ffb1e431fb1a2eb8646378b4cebe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abf9229d5b335c334e2fc0a9a33eef54b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf9229d5b335c334e2fc0a9a33eef54b">&#9670;&nbsp;</a></span>map_extent_mft_record()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MFT_RECORD* map_extent_mft_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> *&#160;</td>
          <td class="paramname"><em>base_ni</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="layout_8h.html#ae241e6fcd8dd743bca056ecbdb614973">MFT_REF</a>&#160;</td>
          <td class="paramname"><em>mref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> **&#160;</td>
          <td class="paramname"><em>ntfs_ino</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>map_extent_mft_record - load an extent inode and attach it to its base : base ntfs inode : mft reference of the extent inode to load : on successful return, pointer to the ntfs_inode structure</p>
<p>Load the extent mft record  and attach it to its base inode . Return the mapped extent mft record if IS_ERR(result) is false. Otherwise PTR_ERR(result) gives the negative error code.</p>
<p>On successful return,  contains a pointer to the ntfs_inode structure of the mapped extent inode. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h_abf9229d5b335c334e2fc0a9a33eef54b_cgraph.png" border="0" usemap="#mft_8h_abf9229d5b335c334e2fc0a9a33eef54b_cgraph" alt=""/></div>
<map name="mft_8h_abf9229d5b335c334e2fc0a9a33eef54b_cgraph" id="mft_8h_abf9229d5b335c334e2fc0a9a33eef54b_cgraph">
<area shape="rect" id="node2" href="mft_8c.html#aab879cd658d486f45345e08fa15f276c" title="map_mft_record" alt="" coords="665,1574,781,1601"/>
<area shape="rect" id="node4" href="ntfs_2aops_8h.html#addce11ccc5af85679488fa76ccc6b622" title="ntfs_map_page" alt="" coords="1110,1434,1221,1461"/>
<area shape="rect" id="node5" href="ntfs_2aops_8h.html#a1598f6a34c91644e4e765b5b04080784" title="ntfs_unmap_page" alt="" coords="1296,1434,1421,1461"/>
<area shape="rect" id="node6" href="mft_8c.html#acdca69e797b129f8be7643ed91f691bd" title="unmap_mft_record" alt="" coords="658,1625,789,1651"/>
<area shape="rect" id="node8" href="ntfs_2inode_8c.html#a22bd60d25a91bd05b32ace0795fcc196" title="ntfs_new_extent_inode" alt="" coords="424,131,580,158"/>
<area shape="rect" id="node11" href="ntfs_2inode_8c.html#a43b97ae96340d9713766df90037dacbe" title="ntfs_clear_extent_inode" alt="" coords="422,486,582,513"/>
<area shape="rect" id="node13" href="ntfs_2inode_8h.html#ade15d2f33de0865b12ce2a4623dbf58c" title="VFS_I" alt="" coords="694,875,753,902"/>
<area shape="rect" id="node15" href="malloc_8h.html#ab6824be4d6e004aa075b1fe66fd0d737" title="ntfs_free" alt="" coords="911,854,985,881"/>
<area shape="rect" id="node17" href="fs-writeback_8c.html#aadbb11843f415987b2be1fcd5850152e" title="__mark_inode_dirty" alt="" coords="435,385,569,411"/>
<area shape="rect" id="node22" href="itree__common_8c.html#a182737ecd86ab9ca3806858e693d4db9" title="block_end" alt="" coords="461,841,543,867"/>
<area shape="rect" id="node23" href="task__mmu_8c.html#a2f4ec22f05a033fb31002acee65e9364" title="m_start" alt="" coords="469,435,535,462"/>
<area shape="rect" id="node26" href="buffer_8c.html#a94ca9132735bfcb0b0b2ae9531461cc8" title="alloc_page_buffers" alt="" coords="437,1675,567,1702"/>
<area shape="rect" id="node27" href="ntfs_2inode_8h.html#a6efd5f611b35ed752fdf15917c707e6d" title="NTFS_I" alt="" coords="689,199,757,226"/>
<area shape="rect" id="node28" href="runlist_8c.html#a9437be86ebe30bd60e86d305679943e1" title="ntfs_rl_vcn_to_lcn" alt="" coords="438,537,566,563"/>
<area shape="rect" id="node29" href="buffer_8c.html#aac5852df82371e20e891b02a37461248" title="end_buffer_write_sync" alt="" coords="425,1726,579,1753"/>
<area shape="rect" id="node30" href="buffer_8c.html#ab65df498c54845f497bae7afe9222c91" title="submit_bh" alt="" coords="461,1777,543,1803"/>
<area shape="rect" id="node31" href="mst_8c.html#adaa9822efa2e93a57fc059a39c8ed7dd" title="post_write_mst_fixup" alt="" coords="429,1827,575,1854"/>
<area shape="rect" id="node32" href="mst_8c.html#a8f55ce8380cd832314e8308a19e0f8a9" title="pre_write_mst_fixup" alt="" coords="433,1878,571,1905"/>
<area shape="rect" id="node33" href="inode_8c.html#ad2a7d900c04745e54c8d2f3847922a59" title="igrab" alt="" coords="477,1929,527,1955"/>
<area shape="rect" id="node34" href="inode_8c.html#aa28e352a61659eb916065442f9393d3d" title="ilookup5_nowait" alt="" coords="445,1979,559,2006"/>
<area shape="rect" id="node35" href="ntfs_2inode_8c.html#a6d8b96cf26fa5d3d90420acd32a57453" title="ntfs_test_inode" alt="" coords="447,233,557,259"/>
<area shape="rect" id="node36" href="inode_8c.html#a378733dcbf0fb08359b9a02145ac8fc3" title="iput" alt="" coords="481,2030,523,2057"/>
<area shape="rect" id="node37" href="attrib_8c.html#a937e974578d952b68aefb51cdca1a5e1" title="ntfs_attr_find_vcn\l_nolock" alt="" coords="439,2081,565,2123"/>
<area shape="rect" id="node38" href="runlist_8c.html#a88bf16d765cbf410f22d562dcdd92213" title="ntfs_runlists_merge" alt="" coords="655,939,791,966"/>
<area shape="rect" id="node39" href="attrib_8c.html#a790cab56d5e72fa613e5ac57c74d000d" title="ntfs_attr_get_search_ctx" alt="" coords="640,1473,807,1499"/>
<area shape="rect" id="node40" href="attrib_8c.html#ad0fa0a5955dbd1e17a84b12d3dc3e5d2" title="ntfs_attr_lookup" alt="" coords="666,1523,781,1550"/>
<area shape="rect" id="node41" href="ntfs_2endian_8h.html#a2e96c421837ca8d7008130e9d8bdcfdb" title="sle64_to_cpu" alt="" coords="674,991,773,1018"/>
<area shape="rect" id="node42" href="ntfs_2endian_8h.html#a32083373aca4ead974dd8f68ff3374eb" title="cpu_to_sle64" alt="" coords="674,1042,773,1069"/>
<area shape="rect" id="node43" href="attrib_8c.html#ae39c510288e49f68010493e93cf02ab8" title="ntfs_attr_reinit_search_ctx" alt="" coords="635,1194,811,1221"/>
<area shape="rect" id="node44" href="mft_8h.html#a811ffb1e431fb1a2eb8646378b4cebe4" title="unmap_extent_mft_record" alt="" coords="861,1169,1035,1195"/>
<area shape="rect" id="node45" href="attrib_8c.html#a4959e9081ff22f6912010201efcc1c0b" title="ntfs_attr_put_search_ctx" alt="" coords="419,1118,585,1145"/>
<area shape="rect" id="node46" href="mft_8c.html#abf9229d5b335c334e2fc0a9a33eef54b" title="map_extent_mft_record" alt="" coords="212,1346,371,1373"/>
<area shape="rect" id="node47" href="inode_8c.html#ae03a9f08d4efbf91ff44e29c1369314e" title="new_inode" alt="" coords="460,2147,544,2174"/>
<area shape="rect" id="node48" href="ntfs_2inode_8h.html#aeea6b534f12d270732818f1335215630" title="ntfs_init_big_inode" alt="" coords="437,283,567,310"/>
<area shape="rect" id="node49" href="ntfs_8h.html#aacad4e9194c28722076e08a6002a1c65" title="ntfs_ffs" alt="" coords="469,2198,535,2225"/>
<area shape="rect" id="node50" href="inode_8c.html#ab2eaca3b9ec87b9dd6568776059cb715" title="current_time" alt="" coords="455,2249,549,2275"/>
<area shape="rect" id="node3" href="mft_8c.html#ae88ce25e1f8572300849e75a5e157e5b" title="map_mft_record_page" alt="" coords="873,1485,1023,1511"/>
<area shape="rect" id="node7" href="mft_8c.html#a7f853eae19270e8962f1d1e7a910f9b5" title="unmap_mft_record_page" alt="" coords="1083,1561,1248,1587"/>
<area shape="rect" id="node9" href="ntfs_2inode_8c.html#a8497e257479bd48f497dd04eb0a34750" title="ntfs_alloc_extent_inode" alt="" coords="644,149,803,175"/>
<area shape="rect" id="node10" href="ntfs_2inode_8c.html#ab985cfa10772115a5f42ef4dc97ce719" title="__ntfs_init_inode" alt="" coords="663,98,783,125"/>
<area shape="rect" id="node12" href="bad__inode_8c.html#a7db3c62ffb9390ef7191a63e19073333" title="is_bad_inode" alt="" coords="674,447,773,474"/>
<area shape="rect" id="node14" href="ntfs_2inode_8c.html#abbc5f657cb686d3a983afcbbffc41031" title="__ntfs_clear_inode" alt="" coords="658,717,789,743"/>
<area shape="rect" id="node16" href="ntfs_2inode_8c.html#ad4e37700ea8d70a20fb28f28fcf2d4d5" title="ntfs_destroy_extent\l_inode" alt="" coords="655,651,792,692"/>
<area shape="rect" id="node18" href="fs-writeback_8c.html#af5890cdc0a937a4f944928bd1880d49b" title="block_dump___mark_inode\l_dirty" alt="" coords="633,251,813,292"/>
<area shape="rect" id="node19" href="fs-writeback_8c.html#ad0ca24311e1c0ba76d3810d240f72b08" title="locked_inode_to_wb\l_and_lock_list" alt="" coords="653,316,793,357"/>
<area shape="rect" id="node20" href="fs-writeback_8c.html#a2a36a21e075aa2a912f5c3cb027692cf" title="inode_io_list_move\l_locked" alt="" coords="657,381,790,423"/>
<area shape="rect" id="node21" href="fs-writeback_8c.html#a044f1d7ff09b03f639232ec0e6a88ee1" title="EXPORT_SYMBOL" alt="" coords="654,498,793,525"/>
<area shape="rect" id="node24" href="proc_2internal_8h.html#a24c9a350b2a54f68919aa6cb1141237f" title="get_proc_task" alt="" coords="671,549,775,575"/>
<area shape="rect" id="node25" href="task__mmu_8c.html#aebeee2d239410fd823cea3e2b005ccf4" title="hold_task_mempolicy" alt="" coords="649,599,797,626"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h_abf9229d5b335c334e2fc0a9a33eef54b_icgraph.png" border="0" usemap="#mft_8h_abf9229d5b335c334e2fc0a9a33eef54b_icgraph" alt=""/></div>
<map name="mft_8h_abf9229d5b335c334e2fc0a9a33eef54b_icgraph" id="mft_8h_abf9229d5b335c334e2fc0a9a33eef54b_icgraph">
<area shape="rect" id="node2" href="attrib_8c.html#aa1ca8eef91a0f2e47720a6e8fafe53c1" title="ntfs_external_attr_find" alt="" coords="212,690,363,717"/>
<area shape="rect" id="node3" href="attrib_8h.html#ad0fa0a5955dbd1e17a84b12d3dc3e5d2" title="ntfs_attr_lookup" alt="" coords="411,658,525,685"/>
<area shape="rect" id="node4" href="ntfs_2dir_8h.html#a9e749d316c242a247306a9c23a468396" title="ntfs_lookup_inode_by_name" alt="" coords="1027,861,1213,887"/>
<area shape="rect" id="node8" href="ntfs_2namei_8c.html#a0ffa88e6d3aa875d3313c7b039c61bf8" title="ntfs_lookup" alt="" coords="2049,303,2139,330"/>
<area shape="rect" id="node9" href="ntfs_2dir_8c.html#ab1bc16b9eb8282df6442679416ef57fe" title="ntfs_readdir" alt="" coords="2635,367,2726,394"/>
<area shape="rect" id="node10" href="ntfs_2file_8c.html#aa2102e40ac22e5e2b0aa0ff7219b7d61" title="ntfs_file_open" alt="" coords="1287,287,1390,314"/>
<area shape="rect" id="node11" href="ntfs_2inode_8c.html#a95369e929e520667ddb68d49c9e4bde4" title="ntfs_is_extended_system_file" alt="" coords="573,607,768,634"/>
<area shape="rect" id="node12" href="ntfs_2inode_8c.html#abb7b69ff7b1ae5e34a80a17ec6bb0f87" title="ntfs_read_locked_inode" alt="" coords="1616,911,1775,938"/>
<area shape="rect" id="node15" href="ntfs_2super_8c.html#a65f19878e9f4e16ea2c57ae3b729a73e" title="load_system_files" alt="" coords="2617,563,2744,590"/>
<area shape="rect" id="node16" href="ntfs_2namei_8c.html#ab7fb2735edcadcdb47d7a21a99cc782e" title="ntfs_get_parent" alt="" coords="2038,886,2150,913"/>
<area shape="rect" id="node20" href="ntfs_2inode_8h.html#a9dbdefee1eb75094e80ab0268c88f09d" title="ntfs_read_inode_mount" alt="" coords="1823,1363,1980,1390"/>
<area shape="rect" id="node22" href="ntfs_2inode_8c.html#ab7dc20a011b54a05dd7a1c0863293565" title="ntfs_read_locked_attr\l_inode" alt="" coords="2208,976,2355,1017"/>
<area shape="rect" id="node24" href="ntfs_2inode_8c.html#aeb9292c6b4bdf01df143a7d248a0d0d1" title="ntfs_read_locked_index\l_inode" alt="" coords="2601,1188,2760,1229"/>
<area shape="rect" id="node26" href="ntfs_2inode_8h.html#ac0991afa8122474f9cabc7803999f1bb" title="ntfs_show_options" alt="" coords="1630,1317,1761,1343"/>
<area shape="rect" id="node27" href="ntfs_2super_8c.html#a66c83e6846c0c69569a1fc56aaaac0ae" title="parse_options" alt="" coords="1465,1342,1567,1369"/>
<area shape="rect" id="node29" href="ntfs_2aops_8c.html#a856218b8b640a4ea98da04280391d1d2" title="ntfs_readpage" alt="" coords="1464,439,1568,466"/>
<area shape="rect" id="node30" href="attrib_8h.html#a97cf5279f8c3012e3faa44114c667bd9" title="ntfs_map_runlist_nolock" alt="" coords="816,405,979,431"/>
<area shape="rect" id="node43" href="attrib_8h.html#a4959e9081ff22f6912010201efcc1c0b" title="ntfs_attr_put_search_ctx" alt="" coords="587,962,754,989"/>
<area shape="rect" id="node46" href="index_8h.html#ade674a6a98f55203a81c587b177a6d4d" title="ntfs_index_lookup" alt="" coords="834,759,961,786"/>
<area shape="rect" id="node5" href="ntfs_2super_8c.html#a3ac011e0fc26b08a55c6105af8a6aa9d" title="ntfs_setup_allocators" alt="" coords="2967,874,3113,901"/>
<area shape="rect" id="node6" href="ntfs_2super_8c.html#a1afed2018068359ea80abae0cf8c4c96" title="ntfs_fill_super" alt="" coords="3161,671,3264,698"/>
<area shape="rect" id="node7" href="ntfs_2super_8c.html#a56d671e0fc29d48f7d8da76a48de59f2" title="ntfs_mount" alt="" coords="3312,671,3399,698"/>
<area shape="rect" id="node13" href="ntfs_2inode_8h.html#aa96c9ef81adffe095044a53a49d5d581" title="ntfs_iget" alt="" coords="1865,582,1937,609"/>
<area shape="rect" id="node14" href="ntfs_2super_8c.html#a1ebda87bfe4deabac37c4d07f9714210" title="load_and_init_upcase" alt="" coords="2405,481,2551,507"/>
<area shape="rect" id="node17" href="ntfs_2namei_8c.html#a165e61fa447531537b45b1f149919e90" title="ntfs_nfs_get_inode" alt="" coords="2028,582,2160,609"/>
<area shape="rect" id="node18" href="ntfs_2namei_8c.html#ad17f9e2b817c67072d09bb98eea5fff6" title="ntfs_fh_to_dentry" alt="" coords="2220,582,2343,609"/>
<area shape="rect" id="node19" href="ntfs_2namei_8c.html#a9439d6466934893029b39ef861d97d4e" title="ntfs_fh_to_parent" alt="" coords="2220,633,2343,659"/>
<area shape="rect" id="node21" href="ntfs_2inode_8h.html#aeea6b534f12d270732818f1335215630" title="ntfs_init_big_inode" alt="" coords="2029,1255,2159,1282"/>
<area shape="rect" id="node23" href="ntfs_2inode_8h.html#a5cbfd09234c5615f6dbf757587558bd3" title="ntfs_attr_iget" alt="" coords="2429,874,2527,901"/>
<area shape="rect" id="node25" href="ntfs_2inode_8h.html#a37b51bf418feea6397cf91df09e49802" title="ntfs_index_iget" alt="" coords="2808,1191,2919,1218"/>
<area shape="rect" id="node28" href="ntfs_2super_8c.html#a52405ca547ba5af07b3d38d2c20d8b3c" title="ntfs_remount" alt="" coords="1646,1266,1745,1293"/>
<area shape="rect" id="node31" href="attrib_8h.html#a31d302aa72ec21e818ed6e3d464db190" title="ntfs_map_runlist" alt="" coords="1061,466,1179,493"/>
<area shape="rect" id="node40" href="attrib_8h.html#ad8696242c04d743f91c946d835ac610a" title="ntfs_attr_vcn_to_lcn\l_nolock" alt="" coords="1050,400,1190,441"/>
<area shape="rect" id="node42" href="attrib_8h.html#a937e974578d952b68aefb51cdca1a5e1" title="ntfs_attr_find_vcn\l_nolock" alt="" coords="1057,517,1183,559"/>
<area shape="rect" id="node32" href="ntfs_2aops_8c.html#a46e8a3da71b6e60c7048ef41af7a87c9" title="ntfs_read_block" alt="" coords="1281,389,1396,415"/>
<area shape="rect" id="node33" href="ntfs_8h.html#a6f4a2644da3c2e4ce52b8aa1bd836b56" title="ntfs_read_compressed\l_block" alt="" coords="1261,541,1416,583"/>
<area shape="rect" id="node34" href="ntfs_8h.html#a7bd82112df01116e1297aa8165d02ff2" title="NTFS_SB" alt="" coords="1475,607,1557,634"/>
<area shape="rect" id="node35" href="ntfs_2inode_8h.html#ab985cfa10772115a5f42ef4dc97ce719" title="__ntfs_init_inode" alt="" coords="1635,1165,1755,1191"/>
<area shape="rect" id="node37" href="ntfs_2super_8c.html#a58c501f669c6e38b284337e1a5fb7272" title="read_ntfs_boot_sector" alt="" coords="2403,430,2553,457"/>
<area shape="rect" id="node38" href="ntfs_2super_8c.html#a0f0b5a10bd9cec19fbe1f7b915c21dd0" title="ntfs_put_super" alt="" coords="1641,557,1749,583"/>
<area shape="rect" id="node39" href="ntfs_2super_8c.html#af3079da93586021932032559f19eb98f" title="ntfs_statfs" alt="" coords="1653,607,1737,634"/>
<area shape="rect" id="node36" href="ntfs_2inode_8h.html#a22bd60d25a91bd05b32ace0795fcc196" title="ntfs_new_extent_inode" alt="" coords="1823,1306,1979,1333"/>
<area shape="rect" id="node41" href="ntfs_2aops_8c.html#a6b7f721e57652e7ef4efff1484ba5c7c" title="ntfs_bmap" alt="" coords="1297,338,1380,365"/>
<area shape="rect" id="node44" href="attrib_8h.html#a5b3c6da7b30052eb909742ccb604568a" title="ntfs_attr_size" alt="" coords="1465,1190,1567,1217"/>
<area shape="rect" id="node45" href="index_8h.html#a1640cd8852408112d9a32e018dce9b62" title="ntfs_index_ctx_put" alt="" coords="831,1215,963,1242"/>
</map>
</div>

</div>
</div>
<a id="aab879cd658d486f45345e08fa15f276c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab879cd658d486f45345e08fa15f276c">&#9670;&nbsp;</a></span>map_mft_record()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MFT_RECORD* map_mft_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> *&#160;</td>
          <td class="paramname"><em>ni</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>map_mft_record - map, pin and lock an mft record : ntfs inode whose MFT record to map</p>
<p>First, take the mrec_lock mutex. We might now be sleeping, while waiting for the mutex if it was already locked by someone else.</p>
<p>The page of the record is mapped using <a class="el" href="mft_8c.html#ae88ce25e1f8572300849e75a5e157e5b">map_mft_record_page()</a> before being returned to the caller.</p>
<p>This in turn uses <a class="el" href="ntfs_2aops_8h.html#addce11ccc5af85679488fa76ccc6b622">ntfs_map_page()</a> to get the page containing the wanted mft record (it in turn calls read_cache_page() which reads it in from disk if necessary, increments the use count on the page so that it cannot disappear under us and returns a reference to the page cache page).</p>
<p>If read_cache_page() invokes <a class="el" href="ntfs_2aops_8c.html#a856218b8b640a4ea98da04280391d1d2">ntfs_readpage()</a> to load the page from disk, it sets PG_locked and clears PG_uptodate on the page. Once I/O has completed and the post-read mst fixups on each mft record in the page have been performed, the page gets PG_uptodate set and PG_locked cleared (this is done in our asynchronous I/O completion handler end_buffer_read_mft_async()). <a class="el" href="ntfs_2aops_8h.html#addce11ccc5af85679488fa76ccc6b622">ntfs_map_page()</a> waits for PG_locked to become clear and checks if PG_uptodate is set and returns an error code if not. This provides sufficient protection against races when reading/using the page.</p>
<p>However there is the write mapping to think about. Doing the above described checking here will be fine, because when initiating the write we will set PG_locked and clear PG_uptodate making sure nobody is touching the page contents. Doing the locking this way means that the commit to disk code in the page cache code paths is automatically sufficiently locked with us as we will not touch a page that has been locked or is not uptodate. The only locking problem then is them locking the page while we are accessing it.</p>
<p>So that code will end up having to own the mrec_lock of all mft records/inodes present in the page before I/O can proceed. In that case we wouldn't need to bother with PG_locked and PG_uptodate as nobody will be accessing anything without owning the mrec_lock mutex. But we do need to use them because of the read_cache_page() invocation and the code becomes so much simpler this way that it is well worth it.</p>
<p>The mft record is now ours and we return a pointer to it. You need to check the returned pointer with IS_ERR() and if that is true, PTR_ERR() will return the error code.</p>
<p>NOTE: Caller is responsible for setting the mft record dirty before calling <a class="el" href="mft_8c.html#acdca69e797b129f8be7643ed91f691bd">unmap_mft_record()</a>. This is obviously only necessary if the caller really modified the mft record... Q: Do we want to recycle one of the VFS inode state bits instead? A: No, the inode ones mean we want to change the mft record, not we want to write it out. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h_aab879cd658d486f45345e08fa15f276c_cgraph.png" border="0" usemap="#mft_8h_aab879cd658d486f45345e08fa15f276c_cgraph" alt=""/></div>
<map name="mft_8h_aab879cd658d486f45345e08fa15f276c_cgraph" id="mft_8h_aab879cd658d486f45345e08fa15f276c_cgraph">
<area shape="rect" id="node2" href="mft_8c.html#ae88ce25e1f8572300849e75a5e157e5b" title="map_mft_record_page" alt="" coords="169,31,320,57"/>
<area shape="rect" id="node3" href="ntfs_2aops_8h.html#addce11ccc5af85679488fa76ccc6b622" title="ntfs_map_page" alt="" coords="368,5,479,32"/>
<area shape="rect" id="node4" href="ntfs_2aops_8h.html#a1598f6a34c91644e4e765b5b04080784" title="ntfs_unmap_page" alt="" coords="527,31,652,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h_aab879cd658d486f45345e08fa15f276c_icgraph.png" border="0" usemap="#mft_8h_aab879cd658d486f45345e08fa15f276c_icgraph" alt=""/></div>
<map name="mft_8h_aab879cd658d486f45345e08fa15f276c_icgraph" id="mft_8h_aab879cd658d486f45345e08fa15f276c_icgraph">
<area shape="rect" id="node2" href="ntfs_2dir_8h.html#a9e749d316c242a247306a9c23a468396" title="ntfs_lookup_inode_by_name" alt="" coords="1571,909,1757,935"/>
<area shape="rect" id="node6" href="ntfs_2namei_8c.html#a0ffa88e6d3aa875d3313c7b039c61bf8" title="ntfs_lookup" alt="" coords="2419,998,2509,1025"/>
<area shape="rect" id="node7" href="ntfs_2dir_8c.html#ab1bc16b9eb8282df6442679416ef57fe" title="ntfs_readdir" alt="" coords="2823,935,2914,962"/>
<area shape="rect" id="node8" href="ntfs_2file_8c.html#aa2102e40ac22e5e2b0aa0ff7219b7d61" title="ntfs_file_open" alt="" coords="2019,514,2122,541"/>
<area shape="rect" id="node9" href="ntfs_2inode_8c.html#abb7b69ff7b1ae5e34a80a17ec6bb0f87" title="ntfs_read_locked_inode" alt="" coords="169,1542,328,1569"/>
<area shape="rect" id="node12" href="ntfs_2super_8c.html#a65f19878e9f4e16ea2c57ae3b729a73e" title="load_system_files" alt="" coords="2805,2125,2932,2151"/>
<area shape="rect" id="node13" href="ntfs_2namei_8c.html#ab7fb2735edcadcdb47d7a21a99cc782e" title="ntfs_get_parent" alt="" coords="1608,1517,1720,1543"/>
<area shape="rect" id="node19" href="ntfs_2inode_8c.html#ab7dc20a011b54a05dd7a1c0863293565" title="ntfs_read_locked_attr\l_inode" alt="" coords="2391,1628,2537,1669"/>
<area shape="rect" id="node21" href="ntfs_2inode_8c.html#aeb9292c6b4bdf01df143a7d248a0d0d1" title="ntfs_read_locked_index\l_inode" alt="" coords="2789,1679,2948,1720"/>
<area shape="rect" id="node23" href="mft_8h.html#abf9229d5b335c334e2fc0a9a33eef54b" title="map_extent_mft_record" alt="" coords="760,1237,919,1263"/>
<area shape="rect" id="node27" href="ntfs_2inode_8h.html#ac0991afa8122474f9cabc7803999f1bb" title="ntfs_show_options" alt="" coords="2399,1061,2529,1087"/>
<area shape="rect" id="node28" href="ntfs_2super_8c.html#a66c83e6846c0c69569a1fc56aaaac0ae" title="parse_options" alt="" coords="1613,301,1715,327"/>
<area shape="rect" id="node30" href="ntfs_2aops_8c.html#a856218b8b640a4ea98da04280391d1d2" title="ntfs_readpage" alt="" coords="2217,645,2321,671"/>
<area shape="rect" id="node31" href="attrib_8h.html#a97cf5279f8c3012e3faa44114c667bd9" title="ntfs_map_runlist_nolock" alt="" coords="1583,530,1745,557"/>
<area shape="rect" id="node44" href="attrib_8h.html#a4959e9081ff22f6912010201efcc1c0b" title="ntfs_attr_put_search_ctx" alt="" coords="1342,1135,1509,1162"/>
<area shape="rect" id="node47" href="index_8h.html#ade674a6a98f55203a81c587b177a6d4d" title="ntfs_index_lookup" alt="" coords="1601,631,1727,658"/>
<area shape="rect" id="node3" href="ntfs_2super_8c.html#a3ac011e0fc26b08a55c6105af8a6aa9d" title="ntfs_setup_allocators" alt="" coords="3195,1686,3341,1713"/>
<area shape="rect" id="node4" href="ntfs_2super_8c.html#a1afed2018068359ea80abae0cf8c4c96" title="ntfs_fill_super" alt="" coords="3389,1390,3492,1417"/>
<area shape="rect" id="node5" href="ntfs_2super_8c.html#a56d671e0fc29d48f7d8da76a48de59f2" title="ntfs_mount" alt="" coords="3540,1390,3627,1417"/>
<area shape="rect" id="node10" href="ntfs_2inode_8h.html#aa96c9ef81adffe095044a53a49d5d581" title="ntfs_iget" alt="" coords="1389,2175,1461,2202"/>
<area shape="rect" id="node17" href="ntfs_2inode_8h.html#a9dbdefee1eb75094e80ab0268c88f09d" title="ntfs_read_inode_mount" alt="" coords="376,1719,533,1746"/>
<area shape="rect" id="node11" href="ntfs_2super_8c.html#a1ebda87bfe4deabac37c4d07f9714210" title="load_and_init_upcase" alt="" coords="2196,2283,2343,2310"/>
<area shape="rect" id="node14" href="ntfs_2namei_8c.html#a165e61fa447531537b45b1f149919e90" title="ntfs_nfs_get_inode" alt="" coords="1598,2226,1730,2253"/>
<area shape="rect" id="node15" href="ntfs_2namei_8c.html#ad17f9e2b817c67072d09bb98eea5fff6" title="ntfs_fh_to_dentry" alt="" coords="1814,2175,1937,2202"/>
<area shape="rect" id="node16" href="ntfs_2namei_8c.html#a9439d6466934893029b39ef861d97d4e" title="ntfs_fh_to_parent" alt="" coords="1814,2226,1937,2253"/>
<area shape="rect" id="node18" href="ntfs_2inode_8h.html#aeea6b534f12d270732818f1335215630" title="ntfs_init_big_inode" alt="" coords="581,1897,712,1923"/>
<area shape="rect" id="node20" href="ntfs_2inode_8h.html#a5cbfd09234c5615f6dbf757587558bd3" title="ntfs_attr_iget" alt="" coords="2614,2074,2713,2101"/>
<area shape="rect" id="node22" href="ntfs_2inode_8h.html#a37b51bf418feea6397cf91df09e49802" title="ntfs_index_iget" alt="" coords="3016,1686,3127,1713"/>
<area shape="rect" id="node24" href="attrib_8c.html#aa1ca8eef91a0f2e47720a6e8fafe53c1" title="ntfs_external_attr_find" alt="" coords="967,954,1117,981"/>
<area shape="rect" id="node25" href="attrib_8h.html#ad0fa0a5955dbd1e17a84b12d3dc3e5d2" title="ntfs_attr_lookup" alt="" coords="1165,954,1280,981"/>
<area shape="rect" id="node26" href="ntfs_2inode_8c.html#a95369e929e520667ddb68d49c9e4bde4" title="ntfs_is_extended_system_file" alt="" coords="1328,1415,1523,1442"/>
<area shape="rect" id="node29" href="ntfs_2super_8c.html#a52405ca547ba5af07b3d38d2c20d8b3c" title="ntfs_remount" alt="" coords="2415,1111,2513,1138"/>
<area shape="rect" id="node32" href="attrib_8h.html#a31d302aa72ec21e818ed6e3d464db190" title="ntfs_map_runlist" alt="" coords="1816,682,1935,709"/>
<area shape="rect" id="node41" href="attrib_8h.html#ad8696242c04d743f91c946d835ac610a" title="ntfs_attr_vcn_to_lcn\l_nolock" alt="" coords="1805,464,1945,505"/>
<area shape="rect" id="node43" href="attrib_8h.html#a937e974578d952b68aefb51cdca1a5e1" title="ntfs_attr_find_vcn\l_nolock" alt="" coords="1812,399,1939,440"/>
<area shape="rect" id="node33" href="ntfs_2aops_8c.html#a46e8a3da71b6e60c7048ef41af7a87c9" title="ntfs_read_block" alt="" coords="2013,615,2128,642"/>
<area shape="rect" id="node34" href="ntfs_8h.html#a6f4a2644da3c2e4ce52b8aa1bd836b56" title="ntfs_read_compressed\l_block" alt="" coords="1993,667,2148,708"/>
<area shape="rect" id="node35" href="ntfs_8h.html#a7bd82112df01116e1297aa8165d02ff2" title="NTFS_SB" alt="" coords="2228,1365,2311,1391"/>
<area shape="rect" id="node36" href="ntfs_2inode_8h.html#ab985cfa10772115a5f42ef4dc97ce719" title="__ntfs_init_inode" alt="" coords="2404,1922,2524,1949"/>
<area shape="rect" id="node38" href="ntfs_2super_8c.html#a58c501f669c6e38b284337e1a5fb7272" title="read_ntfs_boot_sector" alt="" coords="2996,1213,3147,1239"/>
<area shape="rect" id="node39" href="ntfs_2super_8c.html#a0f0b5a10bd9cec19fbe1f7b915c21dd0" title="ntfs_put_super" alt="" coords="2410,1314,2518,1341"/>
<area shape="rect" id="node40" href="ntfs_2super_8c.html#af3079da93586021932032559f19eb98f" title="ntfs_statfs" alt="" coords="2422,1365,2506,1391"/>
<area shape="rect" id="node37" href="ntfs_2inode_8h.html#a22bd60d25a91bd05b32ace0795fcc196" title="ntfs_new_extent_inode" alt="" coords="2585,1922,2741,1949"/>
<area shape="rect" id="node42" href="ntfs_2aops_8c.html#a6b7f721e57652e7ef4efff1484ba5c7c" title="ntfs_bmap" alt="" coords="2029,463,2112,490"/>
<area shape="rect" id="node45" href="attrib_8h.html#a5b3c6da7b30052eb909742ccb604568a" title="ntfs_attr_size" alt="" coords="1613,1567,1715,1594"/>
<area shape="rect" id="node46" href="index_8h.html#a1640cd8852408112d9a32e018dce9b62" title="ntfs_index_ctx_put" alt="" coords="1598,1111,1730,1138"/>
</map>
</div>

</div>
</div>
<a id="a811ffb1e431fb1a2eb8646378b4cebe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a811ffb1e431fb1a2eb8646378b4cebe4">&#9670;&nbsp;</a></span>unmap_extent_mft_record()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void unmap_extent_mft_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> *&#160;</td>
          <td class="paramname"><em>ni</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h_a811ffb1e431fb1a2eb8646378b4cebe4_cgraph.png" border="0" usemap="#mft_8h_a811ffb1e431fb1a2eb8646378b4cebe4_cgraph" alt=""/></div>
<map name="mft_8h_a811ffb1e431fb1a2eb8646378b4cebe4_cgraph" id="mft_8h_a811ffb1e431fb1a2eb8646378b4cebe4_cgraph">
<area shape="rect" id="node2" href="mft_8h.html#acdca69e797b129f8be7643ed91f691bd" title="unmap_mft_record" alt="" coords="227,5,357,32"/>
<area shape="rect" id="node3" href="mft_8c.html#a7f853eae19270e8962f1d1e7a910f9b5" title="unmap_mft_record_page" alt="" coords="405,5,571,32"/>
<area shape="rect" id="node4" href="ntfs_2aops_8h.html#a1598f6a34c91644e4e765b5b04080784" title="ntfs_unmap_page" alt="" coords="619,5,744,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h_a811ffb1e431fb1a2eb8646378b4cebe4_icgraph.png" border="0" usemap="#mft_8h_a811ffb1e431fb1a2eb8646378b4cebe4_icgraph" alt=""/></div>
<map name="mft_8h_a811ffb1e431fb1a2eb8646378b4cebe4_icgraph" id="mft_8h_a811ffb1e431fb1a2eb8646378b4cebe4_icgraph">
<area shape="rect" id="node2" href="attrib_8h.html#a97cf5279f8c3012e3faa44114c667bd9" title="ntfs_map_runlist_nolock" alt="" coords="451,787,613,813"/>
<area shape="rect" id="node30" href="mft_8h.html#abf9229d5b335c334e2fc0a9a33eef54b" title="map_extent_mft_record" alt="" coords="1785,741,1944,768"/>
<area shape="rect" id="node31" href="attrib_8c.html#aa1ca8eef91a0f2e47720a6e8fafe53c1" title="ntfs_external_attr_find" alt="" coords="1992,599,2143,625"/>
<area shape="rect" id="node38" href="attrib_8h.html#a4959e9081ff22f6912010201efcc1c0b" title="ntfs_attr_put_search_ctx" alt="" coords="2367,1131,2534,1157"/>
<area shape="rect" id="node48" href="attrib_8h.html#ae39c510288e49f68010493e93cf02ab8" title="ntfs_attr_reinit_search_ctx" alt="" coords="227,432,403,459"/>
<area shape="rect" id="node3" href="ntfs_2file_8c.html#aa2102e40ac22e5e2b0aa0ff7219b7d61" title="ntfs_file_open" alt="" coords="2618,195,2721,221"/>
<area shape="rect" id="node4" href="attrib_8h.html#a31d302aa72ec21e818ed6e3d464db190" title="ntfs_map_runlist" alt="" coords="672,2283,791,2309"/>
<area shape="rect" id="node45" href="attrib_8h.html#ad8696242c04d743f91c946d835ac610a" title="ntfs_attr_vcn_to_lcn\l_nolock" alt="" coords="661,670,801,711"/>
<area shape="rect" id="node47" href="attrib_8h.html#a937e974578d952b68aefb51cdca1a5e1" title="ntfs_attr_find_vcn\l_nolock" alt="" coords="1397,771,1524,813"/>
<area shape="rect" id="node5" href="ntfs_2aops_8c.html#a46e8a3da71b6e60c7048ef41af7a87c9" title="ntfs_read_block" alt="" coords="1052,2363,1167,2389"/>
<area shape="rect" id="node6" href="ntfs_2aops_8c.html#a856218b8b640a4ea98da04280391d1d2" title="ntfs_readpage" alt="" coords="2617,2261,2721,2288"/>
<area shape="rect" id="node7" href="ntfs_8h.html#a6f4a2644da3c2e4ce52b8aa1bd836b56" title="ntfs_read_compressed\l_block" alt="" coords="849,2246,1004,2287"/>
<area shape="rect" id="node8" href="ntfs_8h.html#a7bd82112df01116e1297aa8165d02ff2" title="NTFS_SB" alt="" coords="1068,1780,1151,1807"/>
<area shape="rect" id="node9" href="ntfs_2dir_8c.html#ab1bc16b9eb8282df6442679416ef57fe" title="ntfs_readdir" alt="" coords="3059,1561,3150,1588"/>
<area shape="rect" id="node10" href="ntfs_2inode_8h.html#ab985cfa10772115a5f42ef4dc97ce719" title="__ntfs_init_inode" alt="" coords="1215,1167,1335,1193"/>
<area shape="rect" id="node13" href="ntfs_2inode_8c.html#abb7b69ff7b1ae5e34a80a17ec6bb0f87" title="ntfs_read_locked_inode" alt="" coords="3025,675,3184,701"/>
<area shape="rect" id="node16" href="ntfs_2super_8c.html#a1afed2018068359ea80abae0cf8c4c96" title="ntfs_fill_super" alt="" coords="3807,1249,3909,1276"/>
<area shape="rect" id="node20" href="ntfs_2namei_8c.html#a0ffa88e6d3aa875d3313c7b039c61bf8" title="ntfs_lookup" alt="" coords="3466,1384,3555,1411"/>
<area shape="rect" id="node25" href="ntfs_2inode_8h.html#a9dbdefee1eb75094e80ab0268c88f09d" title="ntfs_read_inode_mount" alt="" coords="3232,295,3389,321"/>
<area shape="rect" id="node26" href="ntfs_2inode_8c.html#ab7dc20a011b54a05dd7a1c0863293565" title="ntfs_read_locked_attr\l_inode" alt="" coords="2596,1739,2743,1781"/>
<area shape="rect" id="node28" href="ntfs_2inode_8c.html#aeb9292c6b4bdf01df143a7d248a0d0d1" title="ntfs_read_locked_index\l_inode" alt="" coords="3025,1849,3184,1890"/>
<area shape="rect" id="node35" href="ntfs_2inode_8h.html#ac0991afa8122474f9cabc7803999f1bb" title="ntfs_show_options" alt="" coords="2819,1333,2949,1360"/>
<area shape="rect" id="node37" href="ntfs_2super_8c.html#a52405ca547ba5af07b3d38d2c20d8b3c" title="ntfs_remount" alt="" coords="2835,1257,2933,1284"/>
<area shape="rect" id="node42" href="ntfs_2super_8c.html#a58c501f669c6e38b284337e1a5fb7272" title="read_ntfs_boot_sector" alt="" coords="1587,2084,1737,2111"/>
<area shape="rect" id="node43" href="ntfs_2super_8c.html#a0f0b5a10bd9cec19fbe1f7b915c21dd0" title="ntfs_put_super" alt="" coords="1221,1755,1329,1781"/>
<area shape="rect" id="node44" href="ntfs_2super_8c.html#af3079da93586021932032559f19eb98f" title="ntfs_statfs" alt="" coords="1233,1805,1317,1832"/>
<area shape="rect" id="node11" href="ntfs_2inode_8h.html#a22bd60d25a91bd05b32ace0795fcc196" title="ntfs_new_extent_inode" alt="" coords="1383,1116,1539,1143"/>
<area shape="rect" id="node12" href="ntfs_2inode_8h.html#aeea6b534f12d270732818f1335215630" title="ntfs_init_big_inode" alt="" coords="1597,1141,1727,1168"/>
<area shape="rect" id="node14" href="ntfs_2inode_8h.html#aa96c9ef81adffe095044a53a49d5d581" title="ntfs_iget" alt="" coords="3275,1080,3347,1107"/>
<area shape="rect" id="node15" href="ntfs_2super_8c.html#a3ac011e0fc26b08a55c6105af8a6aa9d" title="ntfs_setup_allocators" alt="" coords="3437,1711,3584,1737"/>
<area shape="rect" id="node18" href="ntfs_2super_8c.html#a1ebda87bfe4deabac37c4d07f9714210" title="load_and_init_upcase" alt="" coords="3437,1080,3584,1107"/>
<area shape="rect" id="node19" href="ntfs_2super_8c.html#a65f19878e9f4e16ea2c57ae3b729a73e" title="load_system_files" alt="" coords="3632,1156,3759,1183"/>
<area shape="rect" id="node21" href="ntfs_2namei_8c.html#ab7fb2735edcadcdb47d7a21a99cc782e" title="ntfs_get_parent" alt="" coords="3455,928,3567,955"/>
<area shape="rect" id="node22" href="ntfs_2namei_8c.html#a165e61fa447531537b45b1f149919e90" title="ntfs_nfs_get_inode" alt="" coords="3445,979,3577,1005"/>
<area shape="rect" id="node17" href="ntfs_2super_8c.html#a56d671e0fc29d48f7d8da76a48de59f2" title="ntfs_mount" alt="" coords="3957,1249,4044,1276"/>
<area shape="rect" id="node23" href="ntfs_2namei_8c.html#ad17f9e2b817c67072d09bb98eea5fff6" title="ntfs_fh_to_dentry" alt="" coords="3634,953,3757,980"/>
<area shape="rect" id="node24" href="ntfs_2namei_8c.html#a9439d6466934893029b39ef861d97d4e" title="ntfs_fh_to_parent" alt="" coords="3634,1004,3757,1031"/>
<area shape="rect" id="node27" href="ntfs_2inode_8h.html#a5cbfd09234c5615f6dbf757587558bd3" title="ntfs_attr_iget" alt="" coords="2835,1696,2933,1723"/>
<area shape="rect" id="node29" href="ntfs_2inode_8h.html#a37b51bf418feea6397cf91df09e49802" title="ntfs_index_iget" alt="" coords="3255,1791,3366,1817"/>
<area shape="rect" id="node32" href="attrib_8h.html#ad0fa0a5955dbd1e17a84b12d3dc3e5d2" title="ntfs_attr_lookup" alt="" coords="2191,827,2305,853"/>
<area shape="rect" id="node33" href="ntfs_2dir_8h.html#a9e749d316c242a247306a9c23a468396" title="ntfs_lookup_inode_by_name" alt="" coords="2791,1485,2977,1512"/>
<area shape="rect" id="node34" href="ntfs_2inode_8c.html#a95369e929e520667ddb68d49c9e4bde4" title="ntfs_is_extended_system_file" alt="" coords="2353,371,2548,397"/>
<area shape="rect" id="node36" href="ntfs_2super_8c.html#a66c83e6846c0c69569a1fc56aaaac0ae" title="parse_options" alt="" coords="2618,928,2721,955"/>
<area shape="rect" id="node41" href="index_8h.html#ade674a6a98f55203a81c587b177a6d4d" title="ntfs_index_lookup" alt="" coords="2606,1029,2733,1056"/>
<area shape="rect" id="node39" href="attrib_8h.html#a5b3c6da7b30052eb909742ccb604568a" title="ntfs_attr_size" alt="" coords="2619,573,2720,600"/>
<area shape="rect" id="node40" href="index_8h.html#a1640cd8852408112d9a32e018dce9b62" title="ntfs_index_ctx_put" alt="" coords="2603,1232,2735,1259"/>
<area shape="rect" id="node46" href="ntfs_2aops_8c.html#a6b7f721e57652e7ef4efff1484ba5c7c" title="ntfs_bmap" alt="" coords="885,685,968,712"/>
</map>
</div>

</div>
</div>
<a id="acdca69e797b129f8be7643ed91f691bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdca69e797b129f8be7643ed91f691bd">&#9670;&nbsp;</a></span>unmap_mft_record()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unmap_mft_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ntfs_2inode_8h.html#a1c95663e61da6e9ba52c4a8957911f55">ntfs_inode</a> *&#160;</td>
          <td class="paramname"><em>ni</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>unmap_mft_record - release a mapped mft record : ntfs inode whose MFT record to unmap</p>
<p>We release the page mapping and the mrec_lock mutex which unmaps the mft record and releases it for others to get hold of. We also release the ntfs inode by decrementing the ntfs inode reference count.</p>
<p>NOTE: If caller has modified the mft record, it is imperative to set the mft record dirty BEFORE calling <a class="el" href="mft_8c.html#acdca69e797b129f8be7643ed91f691bd">unmap_mft_record()</a>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h_acdca69e797b129f8be7643ed91f691bd_cgraph.png" border="0" usemap="#mft_8h_acdca69e797b129f8be7643ed91f691bd_cgraph" alt=""/></div>
<map name="mft_8h_acdca69e797b129f8be7643ed91f691bd_cgraph" id="mft_8h_acdca69e797b129f8be7643ed91f691bd_cgraph">
<area shape="rect" id="node2" href="mft_8c.html#a7f853eae19270e8962f1d1e7a910f9b5" title="unmap_mft_record_page" alt="" coords="184,5,349,32"/>
<area shape="rect" id="node3" href="ntfs_2aops_8h.html#a1598f6a34c91644e4e765b5b04080784" title="ntfs_unmap_page" alt="" coords="397,5,523,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mft_8h_acdca69e797b129f8be7643ed91f691bd_icgraph.png" border="0" usemap="#mft_8h_acdca69e797b129f8be7643ed91f691bd_icgraph" alt=""/></div>
<map name="mft_8h_acdca69e797b129f8be7643ed91f691bd_icgraph" id="mft_8h_acdca69e797b129f8be7643ed91f691bd_icgraph">
<area shape="rect" id="node2" href="ntfs_2dir_8h.html#a9e749d316c242a247306a9c23a468396" title="ntfs_lookup_inode_by_name" alt="" coords="2031,1968,2217,1995"/>
<area shape="rect" id="node6" href="ntfs_2namei_8c.html#a0ffa88e6d3aa875d3313c7b039c61bf8" title="ntfs_lookup" alt="" coords="2879,1221,2969,1248"/>
<area shape="rect" id="node7" href="ntfs_2dir_8c.html#ab1bc16b9eb8282df6442679416ef57fe" title="ntfs_readdir" alt="" coords="3283,1816,3374,1843"/>
<area shape="rect" id="node8" href="ntfs_2file_8c.html#aa2102e40ac22e5e2b0aa0ff7219b7d61" title="ntfs_file_open" alt="" coords="2479,2415,2582,2441"/>
<area shape="rect" id="node9" href="ntfs_2inode_8c.html#abb7b69ff7b1ae5e34a80a17ec6bb0f87" title="ntfs_read_locked_inode" alt="" coords="629,853,788,880"/>
<area shape="rect" id="node12" href="ntfs_2super_8c.html#a65f19878e9f4e16ea2c57ae3b729a73e" title="load_system_files" alt="" coords="3265,296,3392,323"/>
<area shape="rect" id="node13" href="ntfs_2namei_8c.html#ab7fb2735edcadcdb47d7a21a99cc782e" title="ntfs_get_parent" alt="" coords="2068,651,2180,677"/>
<area shape="rect" id="node19" href="ntfs_2inode_8c.html#ab7dc20a011b54a05dd7a1c0863293565" title="ntfs_read_locked_attr\l_inode" alt="" coords="2851,795,2997,837"/>
<area shape="rect" id="node21" href="ntfs_2inode_8c.html#aeb9292c6b4bdf01df143a7d248a0d0d1" title="ntfs_read_locked_index\l_inode" alt="" coords="3249,913,3408,954"/>
<area shape="rect" id="node23" href="mft_8h.html#abf9229d5b335c334e2fc0a9a33eef54b" title="map_extent_mft_record" alt="" coords="1220,1715,1379,1741"/>
<area shape="rect" id="node27" href="ntfs_2inode_8h.html#ac0991afa8122474f9cabc7803999f1bb" title="ntfs_show_options" alt="" coords="2859,1165,2989,1192"/>
<area shape="rect" id="node28" href="ntfs_2super_8c.html#a66c83e6846c0c69569a1fc56aaaac0ae" title="parse_options" alt="" coords="2073,2019,2175,2045"/>
<area shape="rect" id="node30" href="ntfs_2aops_8c.html#a856218b8b640a4ea98da04280391d1d2" title="ntfs_readpage" alt="" coords="2677,2212,2781,2239"/>
<area shape="rect" id="node31" href="attrib_8h.html#a97cf5279f8c3012e3faa44114c667bd9" title="ntfs_map_runlist_nolock" alt="" coords="2043,2339,2205,2365"/>
<area shape="rect" id="node44" href="attrib_8h.html#a4959e9081ff22f6912010201efcc1c0b" title="ntfs_attr_put_search_ctx" alt="" coords="1802,1992,1969,2019"/>
<area shape="rect" id="node46" href="index_8h.html#a1640cd8852408112d9a32e018dce9b62" title="ntfs_index_ctx_put" alt="" coords="2058,2389,2190,2416"/>
<area shape="rect" id="node47" href="index_8h.html#ade674a6a98f55203a81c587b177a6d4d" title="ntfs_index_lookup" alt="" coords="2061,1488,2187,1515"/>
<area shape="rect" id="node48" href="mft_8h.html#a811ffb1e431fb1a2eb8646378b4cebe4" title="unmap_extent_mft_record" alt="" coords="184,1968,357,1995"/>
<area shape="rect" id="node3" href="ntfs_2super_8c.html#a3ac011e0fc26b08a55c6105af8a6aa9d" title="ntfs_setup_allocators" alt="" coords="3655,877,3801,904"/>
<area shape="rect" id="node4" href="ntfs_2super_8c.html#a1afed2018068359ea80abae0cf8c4c96" title="ntfs_fill_super" alt="" coords="3849,953,3952,980"/>
<area shape="rect" id="node5" href="ntfs_2super_8c.html#a56d671e0fc29d48f7d8da76a48de59f2" title="ntfs_mount" alt="" coords="4000,953,4087,980"/>
<area shape="rect" id="node10" href="ntfs_2inode_8h.html#aa96c9ef81adffe095044a53a49d5d581" title="ntfs_iget" alt="" coords="1849,397,1921,424"/>
<area shape="rect" id="node17" href="ntfs_2inode_8h.html#a9dbdefee1eb75094e80ab0268c88f09d" title="ntfs_read_inode_mount" alt="" coords="836,1056,993,1083"/>
<area shape="rect" id="node11" href="ntfs_2super_8c.html#a1ebda87bfe4deabac37c4d07f9714210" title="load_and_init_upcase" alt="" coords="2656,257,2803,284"/>
<area shape="rect" id="node14" href="ntfs_2namei_8c.html#a165e61fa447531537b45b1f149919e90" title="ntfs_nfs_get_inode" alt="" coords="2058,347,2190,373"/>
<area shape="rect" id="node15" href="ntfs_2namei_8c.html#ad17f9e2b817c67072d09bb98eea5fff6" title="ntfs_fh_to_dentry" alt="" coords="2274,347,2397,373"/>
<area shape="rect" id="node16" href="ntfs_2namei_8c.html#a9439d6466934893029b39ef861d97d4e" title="ntfs_fh_to_parent" alt="" coords="2274,296,2397,323"/>
<area shape="rect" id="node18" href="ntfs_2inode_8h.html#aeea6b534f12d270732818f1335215630" title="ntfs_init_big_inode" alt="" coords="1041,803,1172,829"/>
<area shape="rect" id="node20" href="ntfs_2inode_8h.html#a5cbfd09234c5615f6dbf757587558bd3" title="ntfs_attr_iget" alt="" coords="3074,811,3173,837"/>
<area shape="rect" id="node22" href="ntfs_2inode_8h.html#a37b51bf418feea6397cf91df09e49802" title="ntfs_index_iget" alt="" coords="3476,917,3587,944"/>
<area shape="rect" id="node24" href="attrib_8c.html#aa1ca8eef91a0f2e47720a6e8fafe53c1" title="ntfs_external_attr_find" alt="" coords="1427,1867,1577,1893"/>
<area shape="rect" id="node25" href="attrib_8h.html#ad0fa0a5955dbd1e17a84b12d3dc3e5d2" title="ntfs_attr_lookup" alt="" coords="1625,1563,1740,1589"/>
<area shape="rect" id="node26" href="ntfs_2inode_8c.html#a95369e929e520667ddb68d49c9e4bde4" title="ntfs_is_extended_system_file" alt="" coords="1788,1259,1983,1285"/>
<area shape="rect" id="node29" href="ntfs_2super_8c.html#a52405ca547ba5af07b3d38d2c20d8b3c" title="ntfs_remount" alt="" coords="2875,1355,2973,1381"/>
<area shape="rect" id="node32" href="attrib_8h.html#a31d302aa72ec21e818ed6e3d464db190" title="ntfs_map_runlist" alt="" coords="2276,2288,2395,2315"/>
<area shape="rect" id="node41" href="attrib_8h.html#ad8696242c04d743f91c946d835ac610a" title="ntfs_attr_vcn_to_lcn\l_nolock" alt="" coords="2265,2542,2405,2583"/>
<area shape="rect" id="node43" href="attrib_8h.html#a937e974578d952b68aefb51cdca1a5e1" title="ntfs_attr_find_vcn\l_nolock" alt="" coords="2272,2222,2399,2263"/>
<area shape="rect" id="node33" href="ntfs_2aops_8c.html#a46e8a3da71b6e60c7048ef41af7a87c9" title="ntfs_read_block" alt="" coords="2473,2237,2588,2264"/>
<area shape="rect" id="node34" href="ntfs_8h.html#a6f4a2644da3c2e4ce52b8aa1bd836b56" title="ntfs_read_compressed\l_block" alt="" coords="2453,2121,2608,2162"/>
<area shape="rect" id="node35" href="ntfs_8h.html#a7bd82112df01116e1297aa8165d02ff2" title="NTFS_SB" alt="" coords="2688,904,2771,931"/>
<area shape="rect" id="node36" href="ntfs_2inode_8h.html#ab985cfa10772115a5f42ef4dc97ce719" title="__ntfs_init_inode" alt="" coords="2864,655,2984,681"/>
<area shape="rect" id="node38" href="ntfs_2super_8c.html#a58c501f669c6e38b284337e1a5fb7272" title="read_ntfs_boot_sector" alt="" coords="3456,863,3607,889"/>
<area shape="rect" id="node39" href="ntfs_2super_8c.html#a0f0b5a10bd9cec19fbe1f7b915c21dd0" title="ntfs_put_super" alt="" coords="2870,1013,2978,1040"/>
<area shape="rect" id="node40" href="ntfs_2super_8c.html#af3079da93586021932032559f19eb98f" title="ntfs_statfs" alt="" coords="2882,963,2966,989"/>
<area shape="rect" id="node37" href="ntfs_2inode_8h.html#a22bd60d25a91bd05b32ace0795fcc196" title="ntfs_new_extent_inode" alt="" coords="3045,655,3201,681"/>
<area shape="rect" id="node42" href="ntfs_2aops_8c.html#a6b7f721e57652e7ef4efff1484ba5c7c" title="ntfs_bmap" alt="" coords="2489,2549,2572,2576"/>
<area shape="rect" id="node45" href="attrib_8h.html#a5b3c6da7b30052eb909742ccb604568a" title="ntfs_attr_size" alt="" coords="2073,1005,2175,1032"/>
<area shape="rect" id="node49" href="attrib_8h.html#ae39c510288e49f68010493e93cf02ab8" title="ntfs_attr_reinit_search_ctx" alt="" coords="405,1715,581,1741"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_99323eb50d8b7f308e54c5b64a386026.html">ntfs</a></li><li class="navelem"><a class="el" href="mft_8h.html">mft.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
