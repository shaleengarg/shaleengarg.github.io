<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linux/fs: ecryptfs/keystore.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linux/fs
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('keystore_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">keystore.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;crypto/hash.h&gt;</code><br />
<code>#include &lt;crypto/skcipher.h&gt;</code><br />
<code>#include &lt;linux/string.h&gt;</code><br />
<code>#include &lt;linux/pagemap.h&gt;</code><br />
<code>#include &lt;linux/key.h&gt;</code><br />
<code>#include &lt;linux/random.h&gt;</code><br />
<code>#include &lt;linux/scatterlist.h&gt;</code><br />
<code>#include &lt;linux/slab.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ecryptfs__kernel_8h_source.html">ecryptfs_kernel.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for keystore.c:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c__incl.png" border="0" usemap="#ecryptfs_2keystore_8c" alt=""/></div>
<map name="ecryptfs_2keystore_8c" id="ecryptfs_2keystore_8c">
<area shape="rect" id="node10" href="ecryptfs__kernel_8h.html" title="ecryptfs_kernel.h" alt="" coords="628,80,751,107"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structecryptfs__write__tag__70__packet__silly__stack.html">ecryptfs_write_tag_70_packet_silly_stack</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structecryptfs__parse__tag__70__packet__silly__stack.html">ecryptfs_parse_tag_70_packet_silly_stack</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8e375031494d4e18494b23647b117360"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a8e375031494d4e18494b23647b117360">process_request_key_err</a> (long err_code)</td></tr>
<tr class="separator:a8e375031494d4e18494b23647b117360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab524d5a4683b8dbfa8762584dc110b78"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#ab524d5a4683b8dbfa8762584dc110b78">process_find_global_auth_tok_for_sig_err</a> (int err_code)</td></tr>
<tr class="separator:ab524d5a4683b8dbfa8762584dc110b78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a927e62aec0955db0c1a411dac02486e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4">ecryptfs_parse_packet_length</a> (unsigned char *<a class="el" href="rock_8h.html#a1bfe8b027f6e5624818c1a92b91bf6d2">data</a>, size_t *<a class="el" href="cifspdu_8h.html#a9eb13703e1b3d14d62f2666b1c09b41f">size</a>, size_t *length_size)</td></tr>
<tr class="separator:a927e62aec0955db0c1a411dac02486e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58141bba8fe1839782991135894cc340"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a58141bba8fe1839782991135894cc340">ecryptfs_write_packet_length</a> (char *dest, size_t <a class="el" href="cifspdu_8h.html#a9eb13703e1b3d14d62f2666b1c09b41f">size</a>, size_t *packet_size_length)</td></tr>
<tr class="separator:a58141bba8fe1839782991135894cc340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a139436651ca07d4aa32396fbae14d1f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a139436651ca07d4aa32396fbae14d1f9">write_tag_64_packet</a> (char *signature, struct ecryptfs_session_key *<a class="el" href="structsession__key.html">session_key</a>, char **packet, size_t *packet_len)</td></tr>
<tr class="separator:a139436651ca07d4aa32396fbae14d1f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01fe01b7c058e56d355ac11eca7a3749"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a01fe01b7c058e56d355ac11eca7a3749">parse_tag_65_packet</a> (struct ecryptfs_session_key *<a class="el" href="structsession__key.html">session_key</a>, u8 *cipher_code, struct <a class="el" href="structecryptfs__message.html">ecryptfs_message</a> *msg)</td></tr>
<tr class="separator:a01fe01b7c058e56d355ac11eca7a3749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98ebf885256c3ac84ee176459d46455c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a98ebf885256c3ac84ee176459d46455c">write_tag_66_packet</a> (char *signature, u8 cipher_code, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, char **packet, size_t *packet_len)</td></tr>
<tr class="separator:a98ebf885256c3ac84ee176459d46455c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae69ad5279272fb61e4b704482e2ba126"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#ae69ad5279272fb61e4b704482e2ba126">parse_tag_67_packet</a> (struct <a class="el" href="structecryptfs__key__record.html">ecryptfs_key_record</a> *key_rec, struct <a class="el" href="structecryptfs__message.html">ecryptfs_message</a> *msg)</td></tr>
<tr class="separator:ae69ad5279272fb61e4b704482e2ba126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51fbc3dfa25435572fbb4c39efb8b515"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515">ecryptfs_verify_version</a> (u16 <a class="el" href="summary_8h.html#ac21c5e21e8a44a607c448b05de413ed4">version</a>)</td></tr>
<tr class="separator:a51fbc3dfa25435572fbb4c39efb8b515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34bd330acbf6c1cfc0347a8e6337fc1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1">ecryptfs_verify_auth_tok_from_key</a> (struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> *auth_tok_key, struct ecryptfs_auth_tok **auth_tok)</td></tr>
<tr class="separator:ad34bd330acbf6c1cfc0347a8e6337fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a486092d42d552350a77e9cb58526f000"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a486092d42d552350a77e9cb58526f000">ecryptfs_find_global_auth_tok_for_sig</a> (struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> **auth_tok_key, struct ecryptfs_auth_tok **auth_tok, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat, char *sig)</td></tr>
<tr class="separator:a486092d42d552350a77e9cb58526f000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad400c5f10bbfd94c8fadd91a2cc3f908"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908">ecryptfs_find_auth_tok_for_sig</a> (struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> **auth_tok_key, struct ecryptfs_auth_tok **auth_tok, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat, char *sig)</td></tr>
<tr class="separator:ad400c5f10bbfd94c8fadd91a2cc3f908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a954c6998fe1c4a445153fda4ff4c1b8e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e">ecryptfs_write_tag_70_packet</a> (char *dest, size_t *remaining_bytes, size_t *packet_size, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat, char *filename, size_t filename_size)</td></tr>
<tr class="separator:a954c6998fe1c4a445153fda4ff4c1b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09ab4784796d57d0e2ab0ff611cc6eee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee">ecryptfs_parse_tag_70_packet</a> (char **filename, size_t *filename_size, size_t *packet_size, struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat, char *<a class="el" href="rock_8h.html#a1bfe8b027f6e5624818c1a92b91bf6d2">data</a>, size_t max_packet_size)</td></tr>
<tr class="separator:a09ab4784796d57d0e2ab0ff611cc6eee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5192f320ce5afdac99056c1e06ad771f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a5192f320ce5afdac99056c1e06ad771f">ecryptfs_get_auth_tok_sig</a> (char **sig, struct ecryptfs_auth_tok *auth_tok)</td></tr>
<tr class="separator:a5192f320ce5afdac99056c1e06ad771f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd91ea24b792d9718c66c4f930ef730"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730">decrypt_pki_encrypted_session_key</a> (struct ecryptfs_auth_tok *auth_tok, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:a5cd91ea24b792d9718c66c4f930ef730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a8b7a243cf75059dfee4f58aed97a2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a90a8b7a243cf75059dfee4f58aed97a2">wipe_auth_tok_list</a> (struct list_head *auth_tok_list_head)</td></tr>
<tr class="separator:a90a8b7a243cf75059dfee4f58aed97a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f59c651d74024aedd73031beadeca5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#ac0f59c651d74024aedd73031beadeca5">parse_tag_1_packet</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, unsigned char *<a class="el" href="rock_8h.html#a1bfe8b027f6e5624818c1a92b91bf6d2">data</a>, struct list_head *auth_tok_list, struct ecryptfs_auth_tok **new_auth_tok, size_t *packet_size, size_t max_packet_size)</td></tr>
<tr class="separator:ac0f59c651d74024aedd73031beadeca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c87c3d9f5f82f8e86006f94b9130d3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a32c87c3d9f5f82f8e86006f94b9130d3">parse_tag_3_packet</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, unsigned char *<a class="el" href="rock_8h.html#a1bfe8b027f6e5624818c1a92b91bf6d2">data</a>, struct list_head *auth_tok_list, struct ecryptfs_auth_tok **new_auth_tok, size_t *packet_size, size_t max_packet_size)</td></tr>
<tr class="separator:a32c87c3d9f5f82f8e86006f94b9130d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30981d0242b86acbe5a11d007022a828"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a30981d0242b86acbe5a11d007022a828">parse_tag_11_packet</a> (unsigned char *<a class="el" href="rock_8h.html#a1bfe8b027f6e5624818c1a92b91bf6d2">data</a>, unsigned char *contents, size_t max_contents_bytes, size_t *tag_11_contents_size, size_t *packet_size, size_t max_packet_size)</td></tr>
<tr class="separator:a30981d0242b86acbe5a11d007022a828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6b148e66717e54b2087a18b51531450"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450">ecryptfs_keyring_auth_tok_for_sig</a> (struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> **auth_tok_key, struct ecryptfs_auth_tok **auth_tok, char *sig)</td></tr>
<tr class="separator:ab6b148e66717e54b2087a18b51531450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b8a7767d3634e57b9fbe484cc680ad0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0">decrypt_passphrase_encrypted_session_key</a> (struct ecryptfs_auth_tok *auth_tok, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat)</td></tr>
<tr class="separator:a9b8a7767d3634e57b9fbe484cc680ad0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ad4f9a58b735c6d9891a06df838671"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671">ecryptfs_parse_packet_set</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, unsigned char *src, struct dentry *ecryptfs_dentry)</td></tr>
<tr class="separator:a44ad4f9a58b735c6d9891a06df838671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97cf4aa86d30a50e38ab1f56f014f1bc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a97cf4aa86d30a50e38ab1f56f014f1bc">pki_encrypt_session_key</a> (struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> *auth_tok_key, struct ecryptfs_auth_tok *auth_tok, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct <a class="el" href="structecryptfs__key__record.html">ecryptfs_key_record</a> *key_rec)</td></tr>
<tr class="separator:a97cf4aa86d30a50e38ab1f56f014f1bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3526c198eba1a1f96e489796fad16ee8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a3526c198eba1a1f96e489796fad16ee8">write_tag_1_packet</a> (char *dest, size_t *remaining_bytes, struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> *auth_tok_key, struct ecryptfs_auth_tok *auth_tok, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct <a class="el" href="structecryptfs__key__record.html">ecryptfs_key_record</a> *key_rec, size_t *packet_size)</td></tr>
<tr class="separator:a3526c198eba1a1f96e489796fad16ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa635b6e3a4e2bc10bc02d2a3d6636fa9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#aa635b6e3a4e2bc10bc02d2a3d6636fa9">write_tag_11_packet</a> (char *dest, size_t *remaining_bytes, char *contents, size_t contents_length, size_t *packet_length)</td></tr>
<tr class="separator:aa635b6e3a4e2bc10bc02d2a3d6636fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f9c9afc806ac6cee810aa85b04f7d6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6">write_tag_3_packet</a> (char *dest, size_t *remaining_bytes, struct ecryptfs_auth_tok *auth_tok, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct <a class="el" href="structecryptfs__key__record.html">ecryptfs_key_record</a> *key_rec, size_t *packet_size)</td></tr>
<tr class="separator:a93f9c9afc806ac6cee810aa85b04f7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea269faf109dfdfbe811ff5af549c8dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc">ecryptfs_generate_key_packet_set</a> (char *dest_base, struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, struct dentry *ecryptfs_dentry, size_t *<a class="el" href="rock_8h.html#aa1460ec7ef11d3c3a91c8ee9fb6380d5">len</a>, size_t max)</td></tr>
<tr class="separator:aea269faf109dfdfbe811ff5af549c8dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac9a69d1ef9650a4dc86067d4632c41"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#acac9a69d1ef9650a4dc86067d4632c41">ecryptfs_add_keysig</a> (struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *crypt_stat, char *sig)</td></tr>
<tr class="separator:acac9a69d1ef9650a4dc86067d4632c41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f72f93b79ccb808683efa544874bc1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#aa8f72f93b79ccb808683efa544874bc1">ecryptfs_add_global_auth_tok</a> (struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *mount_crypt_stat, char *sig, u32 global_auth_tok_flags)</td></tr>
<tr class="separator:aa8f72f93b79ccb808683efa544874bc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7e11b9687c1ed0cc0c32701bb0a93a0e"><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a7e11b9687c1ed0cc0c32701bb0a93a0e">ecryptfs_auth_tok_list_item_cache</a></td></tr>
<tr class="separator:a7e11b9687c1ed0cc0c32701bb0a93a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cfeae3a03bede73d490821e4071eb31"><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a3cfeae3a03bede73d490821e4071eb31">ecryptfs_key_record_cache</a></td></tr>
<tr class="separator:a3cfeae3a03bede73d490821e4071eb31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb072438521d5788c4dd4e7832a6bfc6"><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#acb072438521d5788c4dd4e7832a6bfc6">ecryptfs_key_sig_cache</a></td></tr>
<tr class="separator:acb072438521d5788c4dd4e7832a6bfc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18399523ae392d824f1d15e5cfec19c2"><td class="memItemLeft" align="right" valign="top">struct kmem_cache *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keystore_8c.html#a18399523ae392d824f1d15e5cfec19c2">ecryptfs_global_auth_tok_cache</a></td></tr>
<tr class="separator:a18399523ae392d824f1d15e5cfec19c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9b8a7767d3634e57b9fbe484cc680ad0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b8a7767d3634e57b9fbe484cc680ad0">&#9670;&nbsp;</a></span>decrypt_passphrase_encrypted_session_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int decrypt_passphrase_encrypted_session_key </td>
          <td>(</td>
          <td class="paramtype">struct ecryptfs_auth_tok *&#160;</td>
          <td class="paramname"><em>auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>decrypt_passphrase_encrypted_session_key - Decrypt the session key with the given auth_tok. : The passphrase authentication token to use to encrypt the FEK : The cryptographic context</p>
<p>Returns zero on success; non-zero error otherwise </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a9b8a7767d3634e57b9fbe484cc680ad0_cgraph.png" border="0" usemap="#keystore_8c_a9b8a7767d3634e57b9fbe484cc680ad0_cgraph" alt=""/></div>
<map name="keystore_8c_a9b8a7767d3634e57b9fbe484cc680ad0_cgraph" id="keystore_8c_a9b8a7767d3634e57b9fbe484cc680ad0_cgraph">
<area shape="rect" id="node2" href="ecryptfs_2debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="236,5,372,32"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#ae54bca868720dfaccd8b4817f93fb70a" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="220,57,388,98"/>
<area shape="rect" id="node8" href="ecryptfs_2crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="243,123,365,149"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="459,39,596,65"/>
<area shape="rect" id="node5" href="ecryptfs_2crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="436,89,619,116"/>
<area shape="rect" id="node6" href="ecryptfs_2crypto_8c.html#a88557d40f80d1debaac45a30526e9f0e" title="ecryptfs_process_key\l_cipher" alt="" coords="667,82,817,123"/>
<area shape="rect" id="node7" href="ecryptfs_2crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="865,82,1007,123"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a9b8a7767d3634e57b9fbe484cc680ad0_icgraph.png" border="0" usemap="#keystore_8c_a9b8a7767d3634e57b9fbe484cc680ad0_icgraph" alt=""/></div>
<map name="keystore_8c_a9b8a7767d3634e57b9fbe484cc680ad0_icgraph" id="keystore_8c_a9b8a7767d3634e57b9fbe484cc680ad0_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="220,42,399,69"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="447,42,625,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="673,42,836,69"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="884,5,1003,47"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="887,71,1000,98"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1051,13,1155,39"/>
</map>
</div>

</div>
</div>
<a id="a5cd91ea24b792d9718c66c4f930ef730"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cd91ea24b792d9718c66c4f930ef730">&#9670;&nbsp;</a></span>decrypt_pki_encrypted_session_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int decrypt_pki_encrypted_session_key </td>
          <td>(</td>
          <td class="paramtype">struct ecryptfs_auth_tok *&#160;</td>
          <td class="paramname"><em>auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>decrypt_pki_encrypted_session_key - Decrypt the session key with the given auth_tok. : The key authentication token used to decrypt the session key : The cryptographic context</p>
<p>Returns zero on success; non-zero error otherwise. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a5cd91ea24b792d9718c66c4f930ef730_cgraph.png" border="0" usemap="#keystore_8c_a5cd91ea24b792d9718c66c4f930ef730_cgraph" alt=""/></div>
<map name="keystore_8c_a5cd91ea24b792d9718c66c4f930ef730_cgraph" id="keystore_8c_a5cd91ea24b792d9718c66c4f930ef730_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a5192f320ce5afdac99056c1e06ad771f" title="ecryptfs_get_auth_tok_sig" alt="" coords="211,18,385,45"/>
<area shape="rect" id="node3" href="keystore_8c.html#a139436651ca07d4aa32396fbae14d1f9" title="write_tag_64_packet" alt="" coords="227,69,369,95"/>
<area shape="rect" id="node5" href="messaging_8c.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="216,119,380,146"/>
<area shape="rect" id="node11" href="messaging_8c.html#a92e74fb407527dec54a9faba414ea92a" title="ecryptfs_wait_for_response" alt="" coords="207,170,389,197"/>
<area shape="rect" id="node13" href="keystore_8c.html#a01fe01b7c058e56d355ac11eca7a3749" title="parse_tag_65_packet" alt="" coords="225,221,371,247"/>
<area shape="rect" id="node15" href="ecryptfs_2crypto_8c.html#a9ec4f1a07858b147d07a4691fccc9741" title="ecryptfs_cipher_code\l_to_string" alt="" coords="225,272,371,313"/>
<area shape="rect" id="node16" href="ecryptfs_2debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="230,338,366,365"/>
<area shape="rect" id="node4" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="444,39,595,80"/>
<area shape="rect" id="node6" href="messaging_8c.html#a10730ea01271b89e1dbd74f64cff553f" title="ecryptfs_send_message\l_locked" alt="" coords="437,104,601,145"/>
<area shape="rect" id="node7" href="messaging_8c.html#a89d78e3d4381d564f3f3384901acd3da" title="ecryptfs_find_daemon\l_by_euid" alt="" coords="654,5,805,47"/>
<area shape="rect" id="node8" href="messaging_8c.html#a3cf131d292b1e79c317132d722ad3bb3" title="ecryptfs_acquire_free\l_msg_ctx" alt="" coords="656,71,803,112"/>
<area shape="rect" id="node9" href="messaging_8c.html#a4e5308be4f4821f928b20d7469c21267" title="ecryptfs_msg_ctx_free\l_to_alloc" alt="" coords="652,136,807,177"/>
<area shape="rect" id="node10" href="miscdev_8c.html#a6daf51b4a7c7274ac0e7e7beeeab775d" title="ecryptfs_send_miscdev" alt="" coords="649,202,809,229"/>
<area shape="rect" id="node12" href="messaging_8c.html#afa5f0c6e4ccfb9753a323ff2c5ae993c" title="ecryptfs_msg_ctx_alloc\l_to_free" alt="" coords="439,169,599,211"/>
<area shape="rect" id="node14" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="442,235,597,276"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a5cd91ea24b792d9718c66c4f930ef730_icgraph.png" border="0" usemap="#keystore_8c_a5cd91ea24b792d9718c66c4f930ef730_icgraph" alt=""/></div>
<map name="keystore_8c_a5cd91ea24b792d9718c66c4f930ef730_icgraph" id="keystore_8c_a5cd91ea24b792d9718c66c4f930ef730_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="207,42,385,69"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="433,42,612,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="660,42,823,69"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="871,5,989,47"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="873,71,987,98"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1037,13,1141,39"/>
</map>
</div>

</div>
</div>
<a id="aa8f72f93b79ccb808683efa544874bc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8f72f93b79ccb808683efa544874bc1">&#9670;&nbsp;</a></span>ecryptfs_add_global_auth_tok()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_add_global_auth_tok </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>global_auth_tok_flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_aa8f72f93b79ccb808683efa544874bc1_icgraph.png" border="0" usemap="#keystore_8c_aa8f72f93b79ccb808683efa544874bc1_icgraph" alt=""/></div>
<map name="keystore_8c_aa8f72f93b79ccb808683efa544874bc1_icgraph" id="keystore_8c_aa8f72f93b79ccb808683efa544874bc1_icgraph">
<area shape="rect" id="node2" href="ecryptfs_2main_8c.html#a8ec3ce5c1be8d64f41497847d4a2191f" title="ecryptfs_parse_options" alt="" coords="205,13,362,39"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="192,63,375,90"/>
<area shape="rect" id="node3" href="ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="423,13,535,39"/>
<area shape="rect" id="node4" href="ecryptfs_2main_8c.html#afc526befd9b281d81555e8ee7f643d6e" title="ecryptfs_kill_block\l_super" alt="" coords="583,5,713,47"/>
</map>
</div>

</div>
</div>
<a id="acac9a69d1ef9650a4dc86067d4632c41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac9a69d1ef9650a4dc86067d4632c41">&#9670;&nbsp;</a></span>ecryptfs_add_keysig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_add_keysig </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_acac9a69d1ef9650a4dc86067d4632c41_icgraph.png" border="0" usemap="#keystore_8c_acac9a69d1ef9650a4dc86067d4632c41_icgraph" alt=""/></div>
<map name="keystore_8c_acac9a69d1ef9650a4dc86067d4632c41_icgraph" id="keystore_8c_acac9a69d1ef9650a4dc86067d4632c41_icgraph">
<area shape="rect" id="node2" href="ecryptfs_2crypto_8c.html#a81000f6bbd25c79214005d46daa3d6ca" title="ecryptfs_copy_mount\l_wide_sigs_to_inode_sigs" alt="" coords="200,35,375,76"/>
<area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="196,101,379,127"/>
<area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a324be797fb8eff4327b7e380210148df" title="ecryptfs_new_file_context" alt="" coords="427,42,601,69"/>
<area shape="rect" id="node4" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="649,42,796,69"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="844,5,963,47"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="847,71,959,98"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1011,13,1115,39"/>
</map>
</div>

</div>
</div>
<a id="ad400c5f10bbfd94c8fadd91a2cc3f908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad400c5f10bbfd94c8fadd91a2cc3f908">&#9670;&nbsp;</a></span>ecryptfs_find_auth_tok_for_sig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_find_auth_tok_for_sig </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> **&#160;</td>
          <td class="paramname"><em>auth_tok_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok **&#160;</td>
          <td class="paramname"><em>auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_find_auth_tok_for_sig : Set to the matching auth_tok; NULL if not found : inode crypt_stat crypto context : Sig of auth_tok to find</p>
<p>For now, this function simply looks at the registered auth_tok's linked off the mount_crypt_stat, so all the auth_toks that can be used must be registered at mount time. This function could potentially try a lot harder to find auth_tok's (e.g., by calling out to ecryptfsd to dynamically retrieve an auth_tok object) so that static registration of auth_tok's will no longer be necessary.</p>
<p>Returns zero on no error; non-zero on error </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ad400c5f10bbfd94c8fadd91a2cc3f908_cgraph.png" border="0" usemap="#keystore_8c_ad400c5f10bbfd94c8fadd91a2cc3f908_cgraph" alt=""/></div>
<map name="keystore_8c_ad400c5f10bbfd94c8fadd91a2cc3f908_cgraph" id="keystore_8c_ad400c5f10bbfd94c8fadd91a2cc3f908_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a486092d42d552350a77e9cb58526f000" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="189,29,327,71"/>
<area shape="rect" id="node7" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="183,95,333,136"/>
<area shape="rect" id="node3" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1" title="ecryptfs_verify_auth\l_tok_from_key" alt="" coords="405,31,545,72"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="616,13,823,39"/>
<area shape="rect" id="node6" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="641,63,798,90"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a580da71e4af9cdf7b9c749dd686f0cdf" title="ecryptfs_get_encrypted\l_key_payload_data" alt="" coords="871,5,1029,47"/>
<area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#add65e0a3cb09fdffdcc1828b0e331d32" title="ecryptfs_get_encrypted_key" alt="" coords="381,99,568,126"/>
<area shape="rect" id="node9" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="391,150,559,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ad400c5f10bbfd94c8fadd91a2cc3f908_icgraph.png" border="0" usemap="#keystore_8c_ad400c5f10bbfd94c8fadd91a2cc3f908_icgraph" alt=""/></div>
<map name="keystore_8c_ad400c5f10bbfd94c8fadd91a2cc3f908_icgraph" id="keystore_8c_ad400c5f10bbfd94c8fadd91a2cc3f908_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="207,91,337,133"/>
<area shape="rect" id="node8" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="205,157,339,198"/>
<area shape="rect" id="node15" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="183,223,361,249"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a7c08ddd3f800324ed36c5f9b4544c870" title="ecryptfs_encrypt_filename" alt="" coords="413,55,588,81"/>
<area shape="rect" id="node7" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="409,105,592,132"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#aa0f5463cff0ed1050e3f754759add6d1" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="648,47,795,89"/>
<area shape="rect" id="node5" href="ecryptfs_2inode_8c.html#a12d536a3a1a72ba18dcc8ff49a79e9af" title="ecryptfs_lookup" alt="" coords="863,5,978,32"/>
<area shape="rect" id="node6" href="ecryptfs_2inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="860,56,981,83"/>
<area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#ad92bd4ca5b5dec50558342a288e4da03" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="427,157,574,198"/>
<area shape="rect" id="node10" href="ecryptfs_2file_8c.html#aaee78a54b5aaf1796ee1f1a8afc990ea" title="ecryptfs_filldir" alt="" coords="670,113,773,140"/>
<area shape="rect" id="node12" href="ecryptfs_2inode_8c.html#a07fd8a464f9fc168e4a490421ff61cb7" title="ecryptfs_readlink_lower" alt="" coords="642,164,801,191"/>
<area shape="rect" id="node11" href="ecryptfs_2file_8c.html#a8997e4f7523880bfe681e8e13a7159cb" title="ecryptfs_readdir" alt="" coords="863,111,978,137"/>
<area shape="rect" id="node13" href="ecryptfs_2inode_8c.html#a450e9a3a23567116f4c583f062e5174e" title="ecryptfs_get_link" alt="" coords="860,161,981,188"/>
<area shape="rect" id="node14" href="ecryptfs_2inode_8c.html#a6c79d00b1445b0a82a5cadc0c8374250" title="ecryptfs_getattr_link" alt="" coords="851,212,991,239"/>
<area shape="rect" id="node16" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="411,244,590,271"/>
<area shape="rect" id="node17" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="640,271,803,297"/>
<area shape="rect" id="node18" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="861,263,980,305"/>
<area shape="rect" id="node20" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="864,329,977,356"/>
<area shape="rect" id="node19" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1039,271,1143,297"/>
</map>
</div>

</div>
</div>
<a id="a486092d42d552350a77e9cb58526f000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a486092d42d552350a77e9cb58526f000">&#9670;&nbsp;</a></span>ecryptfs_find_global_auth_tok_for_sig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_find_global_auth_tok_for_sig </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> **&#160;</td>
          <td class="paramname"><em>auth_tok_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok **&#160;</td>
          <td class="paramname"><em>auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a486092d42d552350a77e9cb58526f000_cgraph.png" border="0" usemap="#keystore_8c_a486092d42d552350a77e9cb58526f000_cgraph" alt=""/></div>
<map name="keystore_8c_a486092d42d552350a77e9cb58526f000_cgraph" id="keystore_8c_a486092d42d552350a77e9cb58526f000_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1" title="ecryptfs_verify_auth\l_tok_from_key" alt="" coords="192,31,332,72"/>
<area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="380,13,587,39"/>
<area shape="rect" id="node5" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="405,63,562,90"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a580da71e4af9cdf7b9c749dd686f0cdf" title="ecryptfs_get_encrypted\l_key_payload_data" alt="" coords="635,5,793,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a486092d42d552350a77e9cb58526f000_icgraph.png" border="0" usemap="#keystore_8c_a486092d42d552350a77e9cb58526f000_icgraph" alt=""/></div>
<map name="keystore_8c_a486092d42d552350a77e9cb58526f000_icgraph" id="keystore_8c_a486092d42d552350a77e9cb58526f000_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="205,198,334,239"/>
<area shape="rect" id="node22" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="192,274,347,315"/>
<area shape="rect" id="node3" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="421,119,551,161"/>
<area shape="rect" id="node9" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="419,185,553,226"/>
<area shape="rect" id="node16" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="397,251,575,277"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a7c08ddd3f800324ed36c5f9b4544c870" title="ecryptfs_encrypt_filename" alt="" coords="629,71,804,97"/>
<area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="625,129,808,156"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#aa0f5463cff0ed1050e3f754759add6d1" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="864,49,1011,90"/>
<area shape="rect" id="node6" href="ecryptfs_2inode_8c.html#a12d536a3a1a72ba18dcc8ff49a79e9af" title="ecryptfs_lookup" alt="" coords="1079,5,1194,32"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1076,56,1197,83"/>
<area shape="rect" id="node10" href="ecryptfs__kernel_8h.html#ad92bd4ca5b5dec50558342a288e4da03" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="643,183,790,225"/>
<area shape="rect" id="node11" href="ecryptfs_2file_8c.html#aaee78a54b5aaf1796ee1f1a8afc990ea" title="ecryptfs_filldir" alt="" coords="886,132,989,159"/>
<area shape="rect" id="node13" href="ecryptfs_2inode_8c.html#a07fd8a464f9fc168e4a490421ff61cb7" title="ecryptfs_readlink_lower" alt="" coords="858,191,1017,217"/>
<area shape="rect" id="node12" href="ecryptfs_2file_8c.html#a8997e4f7523880bfe681e8e13a7159cb" title="ecryptfs_readdir" alt="" coords="1079,107,1194,133"/>
<area shape="rect" id="node14" href="ecryptfs_2inode_8c.html#a450e9a3a23567116f4c583f062e5174e" title="ecryptfs_get_link" alt="" coords="1076,157,1197,184"/>
<area shape="rect" id="node15" href="ecryptfs_2inode_8c.html#a6c79d00b1445b0a82a5cadc0c8374250" title="ecryptfs_getattr_link" alt="" coords="1067,208,1207,235"/>
<area shape="rect" id="node17" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="627,251,806,277"/>
<area shape="rect" id="node18" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="856,259,1019,285"/>
<area shape="rect" id="node19" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1077,310,1196,351"/>
<area shape="rect" id="node21" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1080,259,1193,285"/>
<area shape="rect" id="node20" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1255,317,1359,344"/>
<area shape="rect" id="node23" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="395,303,577,329"/>
<area shape="rect" id="node24" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="634,305,799,332"/>
<area shape="rect" id="node25" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="864,317,1011,344"/>
<area shape="rect" id="node26" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1081,376,1193,403"/>
</map>
</div>

</div>
</div>
<a id="aea269faf109dfdfbe811ff5af549c8dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea269faf109dfdfbe811ff5af549c8dc">&#9670;&nbsp;</a></span>ecryptfs_generate_key_packet_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_generate_key_packet_set </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_generate_key_packet_set : Virtual address from which to write the key record set : The cryptographic context from which the authentication tokens will be retrieved : The dentry, used to retrieve the mount crypt stat for the global parameters : The amount written : The maximum amount of data allowed to be written</p>
<p>Generates a key packet set and writes it to the virtual address passed in.</p>
<p>Returns zero on success; non-zero on error. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_aea269faf109dfdfbe811ff5af549c8dc_cgraph.png" border="0" usemap="#keystore_8c_aea269faf109dfdfbe811ff5af549c8dc_cgraph" alt=""/></div>
<map name="keystore_8c_aea269faf109dfdfbe811ff5af549c8dc_cgraph" id="keystore_8c_aea269faf109dfdfbe811ff5af549c8dc_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ab0987a55f9bd100b72e69f9dc54d1e39" title="ecryptfs_superblock\l_to_private" alt="" coords="212,95,351,136"/>
<area shape="rect" id="node3" href="keystore_8c.html#a486092d42d552350a77e9cb58526f000" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="212,160,351,201"/>
<area shape="rect" id="node8" href="keystore_8c.html#ab524d5a4683b8dbfa8762584dc110b78" title="process_find_global\l_auth_tok_for_sig_err" alt="" coords="208,225,355,267"/>
<area shape="rect" id="node10" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="214,418,349,445"/>
<area shape="rect" id="node21" href="keystore_8c.html#aa635b6e3a4e2bc10bc02d2a3d6636fa9" title="write_tag_11_packet" alt="" coords="210,553,353,579"/>
<area shape="rect" id="node22" href="keystore_8c.html#a3526c198eba1a1f96e489796fad16ee8" title="write_tag_1_packet" alt="" coords="214,291,349,318"/>
<area shape="rect" id="node4" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1" title="ecryptfs_verify_auth\l_tok_from_key" alt="" coords="417,56,557,97"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="620,13,827,39"/>
<area shape="rect" id="node7" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="645,63,802,90"/>
<area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#a580da71e4af9cdf7b9c749dd686f0cdf" title="ecryptfs_get_encrypted\l_key_payload_data" alt="" coords="877,5,1036,47"/>
<area shape="rect" id="node9" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="403,165,571,191"/>
<area shape="rect" id="node11" href="ecryptfs_2crypto_8c.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="422,367,553,394"/>
<area shape="rect" id="node12" href="ecryptfs_2crypto_8c.html#ae54bca868720dfaccd8b4817f93fb70a" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="403,571,571,612"/>
<area shape="rect" id="node17" href="ecryptfs_2debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="419,317,555,343"/>
<area shape="rect" id="node18" href="ecryptfs_2crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="426,469,549,495"/>
<area shape="rect" id="node19" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="881,444,1032,485"/>
<area shape="rect" id="node20" href="ecryptfs_2crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="639,317,807,359"/>
<area shape="rect" id="node13" href="ecryptfs_2crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="655,578,792,605"/>
<area shape="rect" id="node14" href="ecryptfs_2crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="632,687,815,714"/>
<area shape="rect" id="node15" href="ecryptfs_2crypto_8c.html#a88557d40f80d1debaac45a30526e9f0e" title="ecryptfs_process_key\l_cipher" alt="" coords="881,680,1032,721"/>
<area shape="rect" id="node16" href="ecryptfs_2crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="1096,680,1237,721"/>
<area shape="rect" id="node23" href="keystore_8c.html#a97cf4aa86d30a50e38ab1f56f014f1bc" title="pki_encrypt_session_key" alt="" coords="403,215,572,242"/>
<area shape="rect" id="node24" href="keystore_8c.html#a98ebf885256c3ac84ee176459d46455c" title="write_tag_66_packet" alt="" coords="652,266,795,293"/>
<area shape="rect" id="node25" href="messaging_8c.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="641,114,805,141"/>
<area shape="rect" id="node31" href="messaging_8c.html#a92e74fb407527dec54a9faba414ea92a" title="ecryptfs_wait_for_response" alt="" coords="632,165,815,191"/>
<area shape="rect" id="node33" href="keystore_8c.html#ae69ad5279272fb61e4b704482e2ba126" title="parse_tag_67_packet" alt="" coords="650,215,797,242"/>
<area shape="rect" id="node26" href="messaging_8c.html#a10730ea01271b89e1dbd74f64cff553f" title="ecryptfs_send_message\l_locked" alt="" coords="875,92,1039,133"/>
<area shape="rect" id="node27" href="messaging_8c.html#a89d78e3d4381d564f3f3384901acd3da" title="ecryptfs_find_daemon\l_by_euid" alt="" coords="1091,60,1242,101"/>
<area shape="rect" id="node28" href="messaging_8c.html#a3cf131d292b1e79c317132d722ad3bb3" title="ecryptfs_acquire_free\l_msg_ctx" alt="" coords="1093,125,1240,167"/>
<area shape="rect" id="node29" href="messaging_8c.html#a4e5308be4f4821f928b20d7469c21267" title="ecryptfs_msg_ctx_free\l_to_alloc" alt="" coords="1089,191,1244,232"/>
<area shape="rect" id="node30" href="miscdev_8c.html#a6daf51b4a7c7274ac0e7e7beeeab775d" title="ecryptfs_send_miscdev" alt="" coords="1087,9,1247,35"/>
<area shape="rect" id="node32" href="messaging_8c.html#afa5f0c6e4ccfb9753a323ff2c5ae993c" title="ecryptfs_msg_ctx_alloc\l_to_free" alt="" coords="877,157,1037,199"/>
<area shape="rect" id="node34" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="879,223,1034,264"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_aea269faf109dfdfbe811ff5af549c8dc_icgraph.png" border="0" usemap="#keystore_8c_aea269faf109dfdfbe811ff5af549c8dc_icgraph" alt=""/></div>
<map name="keystore_8c_aea269faf109dfdfbe811ff5af549c8dc_icgraph" id="keystore_8c_aea269faf109dfdfbe811ff5af549c8dc_icgraph">
<area shape="rect" id="node2" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="208,42,391,69"/>
<area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="439,42,604,69"/>
<area shape="rect" id="node4" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="652,42,799,69"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="847,5,965,47"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="850,71,962,98"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1013,13,1117,39"/>
</map>
</div>

</div>
</div>
<a id="a5192f320ce5afdac99056c1e06ad771f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5192f320ce5afdac99056c1e06ad771f">&#9670;&nbsp;</a></span>ecryptfs_get_auth_tok_sig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_get_auth_tok_sig </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok *&#160;</td>
          <td class="paramname"><em>auth_tok</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a5192f320ce5afdac99056c1e06ad771f_icgraph.png" border="0" usemap="#keystore_8c_a5192f320ce5afdac99056c1e06ad771f_icgraph" alt=""/></div>
<map name="keystore_8c_a5192f320ce5afdac99056c1e06ad771f_icgraph" id="keystore_8c_a5192f320ce5afdac99056c1e06ad771f_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="228,5,381,47"/>
<area shape="rect" id="node3" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="429,42,608,69"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="656,42,835,69"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="883,42,1045,69"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1093,5,1212,47"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1096,71,1209,98"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1260,13,1364,39"/>
</map>
</div>

</div>
</div>
<a id="ab6b148e66717e54b2087a18b51531450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6b148e66717e54b2087a18b51531450">&#9670;&nbsp;</a></span>ecryptfs_keyring_auth_tok_for_sig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_keyring_auth_tok_for_sig </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> **&#160;</td>
          <td class="paramname"><em>auth_tok_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok **&#160;</td>
          <td class="paramname"><em>auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ab6b148e66717e54b2087a18b51531450_cgraph.png" border="0" usemap="#keystore_8c_ab6b148e66717e54b2087a18b51531450_cgraph" alt=""/></div>
<map name="keystore_8c_ab6b148e66717e54b2087a18b51531450_cgraph" id="keystore_8c_ab6b148e66717e54b2087a18b51531450_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#add65e0a3cb09fdffdcc1828b0e331d32" title="ecryptfs_get_encrypted_key" alt="" coords="204,5,391,32"/>
<area shape="rect" id="node3" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="213,56,381,83"/>
<area shape="rect" id="node4" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1" title="ecryptfs_verify_auth\l_tok_from_key" alt="" coords="227,107,367,149"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="439,89,645,116"/>
<area shape="rect" id="node7" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="463,140,621,167"/>
<area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#a580da71e4af9cdf7b9c749dd686f0cdf" title="ecryptfs_get_encrypted\l_key_payload_data" alt="" coords="693,82,852,123"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ab6b148e66717e54b2087a18b51531450_icgraph.png" border="0" usemap="#keystore_8c_ab6b148e66717e54b2087a18b51531450_icgraph" alt=""/></div>
<map name="keystore_8c_ab6b148e66717e54b2087a18b51531450_icgraph" id="keystore_8c_ab6b148e66717e54b2087a18b51531450_icgraph">
<area shape="rect" id="node2" href="ecryptfs_2main_8c.html#aecf26c95d45fdefd573861a1dc6fcb83" title="ecryptfs_init_global\l_auth_toks" alt="" coords="204,5,339,47"/>
<area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="613,71,796,98"/>
<area shape="rect" id="node7" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="207,155,336,196"/>
<area shape="rect" id="node3" href="ecryptfs_2main_8c.html#a8ec3ce5c1be8d64f41497847d4a2191f" title="ecryptfs_parse_options" alt="" coords="397,13,555,39"/>
<area shape="rect" id="node4" href="ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="649,13,761,39"/>
<area shape="rect" id="node5" href="ecryptfs_2main_8c.html#afc526befd9b281d81555e8ee7f643d6e" title="ecryptfs_kill_block\l_super" alt="" coords="860,5,991,47"/>
<area shape="rect" id="node8" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="411,188,541,229"/>
<area shape="rect" id="node13" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="409,123,543,164"/>
<area shape="rect" id="node20" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="387,261,565,287"/>
<area shape="rect" id="node9" href="ecryptfs_2crypto_8c.html#a7c08ddd3f800324ed36c5f9b4544c870" title="ecryptfs_encrypt_filename" alt="" coords="617,195,792,222"/>
<area shape="rect" id="node10" href="ecryptfs__kernel_8h.html#aa0f5463cff0ed1050e3f754759add6d1" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="852,188,999,229"/>
<area shape="rect" id="node11" href="ecryptfs_2inode_8c.html#a12d536a3a1a72ba18dcc8ff49a79e9af" title="ecryptfs_lookup" alt="" coords="1067,231,1182,258"/>
<area shape="rect" id="node12" href="ecryptfs_2inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1064,181,1185,207"/>
<area shape="rect" id="node14" href="ecryptfs__kernel_8h.html#ad92bd4ca5b5dec50558342a288e4da03" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="631,123,778,164"/>
<area shape="rect" id="node15" href="ecryptfs_2file_8c.html#aaee78a54b5aaf1796ee1f1a8afc990ea" title="ecryptfs_filldir" alt="" coords="874,130,977,157"/>
<area shape="rect" id="node17" href="ecryptfs_2inode_8c.html#a07fd8a464f9fc168e4a490421ff61cb7" title="ecryptfs_readlink_lower" alt="" coords="846,79,1005,106"/>
<area shape="rect" id="node16" href="ecryptfs_2file_8c.html#a8997e4f7523880bfe681e8e13a7159cb" title="ecryptfs_readdir" alt="" coords="1067,130,1182,157"/>
<area shape="rect" id="node18" href="ecryptfs_2inode_8c.html#a450e9a3a23567116f4c583f062e5174e" title="ecryptfs_get_link" alt="" coords="1064,29,1185,55"/>
<area shape="rect" id="node19" href="ecryptfs_2inode_8c.html#a6c79d00b1445b0a82a5cadc0c8374250" title="ecryptfs_getattr_link" alt="" coords="1055,79,1195,106"/>
<area shape="rect" id="node21" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="615,274,794,301"/>
<area shape="rect" id="node22" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="844,282,1007,309"/>
<area shape="rect" id="node23" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1065,333,1184,375"/>
<area shape="rect" id="node25" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1068,282,1181,309"/>
<area shape="rect" id="node24" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1243,341,1347,367"/>
</map>
</div>

</div>
</div>
<a id="a927e62aec0955db0c1a411dac02486e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a927e62aec0955db0c1a411dac02486e4">&#9670;&nbsp;</a></span>ecryptfs_parse_packet_length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_parse_packet_length </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>length_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_parse_packet_length : Pointer to memory containing length at offset : This function writes the decoded size to this memory address; zero on error : The number of bytes occupied by the encoded length</p>
<p>Returns zero on success; non-zero on error </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a927e62aec0955db0c1a411dac02486e4_icgraph.png" border="0" usemap="#keystore_8c_a927e62aec0955db0c1a411dac02486e4_icgraph" alt=""/></div>
<map name="keystore_8c_a927e62aec0955db0c1a411dac02486e4_icgraph" id="keystore_8c_a927e62aec0955db0c1a411dac02486e4_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="416,61,599,87"/>
<area shape="rect" id="node3" href="keystore_8c.html#a01fe01b7c058e56d355ac11eca7a3749" title="parse_tag_65_packet" alt="" coords="215,229,361,255"/>
<area shape="rect" id="node11" href="keystore_8c.html#ae69ad5279272fb61e4b704482e2ba126" title="parse_tag_67_packet" alt="" coords="215,10,361,37"/>
<area shape="rect" id="node19" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="221,112,355,153"/>
<area shape="rect" id="node26" href="keystore_8c.html#ac0f59c651d74024aedd73031beadeca5" title="parse_tag_1_packet" alt="" coords="438,178,577,205"/>
<area shape="rect" id="node27" href="keystore_8c.html#a32c87c3d9f5f82f8e86006f94b9130d3" title="parse_tag_3_packet" alt="" coords="438,295,577,322"/>
<area shape="rect" id="node28" href="keystore_8c.html#a30981d0242b86acbe5a11d007022a828" title="parse_tag_11_packet" alt="" coords="215,330,361,357"/>
<area shape="rect" id="node29" href="miscdev_8c.html#a2baa3c3495d888b54c83d2b1c2d91b93" title="ecryptfs_miscdev_write" alt="" coords="208,381,368,407"/>
<area shape="rect" id="node4" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="431,229,584,271"/>
<area shape="rect" id="node5" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="647,237,825,263"/>
<area shape="rect" id="node6" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="873,229,1052,255"/>
<area shape="rect" id="node7" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1110,178,1273,205"/>
<area shape="rect" id="node8" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1739,80,1857,121"/>
<area shape="rect" id="node10" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1357,178,1470,205"/>
<area shape="rect" id="node9" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1905,87,2009,114"/>
<area shape="rect" id="node12" href="keystore_8c.html#a97cf4aa86d30a50e38ab1f56f014f1bc" title="pki_encrypt_session_key" alt="" coords="423,10,592,37"/>
<area shape="rect" id="node13" href="keystore_8c.html#a3526c198eba1a1f96e489796fad16ee8" title="write_tag_1_packet" alt="" coords="669,11,803,38"/>
<area shape="rect" id="node14" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="885,5,1040,47"/>
<area shape="rect" id="node15" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="1100,15,1283,42"/>
<area shape="rect" id="node16" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="1331,17,1496,43"/>
<area shape="rect" id="node17" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="1544,21,1691,47"/>
<area shape="rect" id="node18" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1742,21,1854,47"/>
<area shape="rect" id="node20" href="ecryptfs__kernel_8h.html#ad92bd4ca5b5dec50558342a288e4da03" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="434,112,581,153"/>
<area shape="rect" id="node21" href="ecryptfs_2file_8c.html#aaee78a54b5aaf1796ee1f1a8afc990ea" title="ecryptfs_filldir" alt="" coords="685,73,787,99"/>
<area shape="rect" id="node23" href="ecryptfs_2inode_8c.html#a07fd8a464f9fc168e4a490421ff61cb7" title="ecryptfs_readlink_lower" alt="" coords="657,123,815,150"/>
<area shape="rect" id="node22" href="ecryptfs_2file_8c.html#a8997e4f7523880bfe681e8e13a7159cb" title="ecryptfs_readdir" alt="" coords="905,73,1020,99"/>
<area shape="rect" id="node24" href="ecryptfs_2inode_8c.html#a450e9a3a23567116f4c583f062e5174e" title="ecryptfs_get_link" alt="" coords="902,174,1023,201"/>
<area shape="rect" id="node25" href="ecryptfs_2inode_8c.html#a6c79d00b1445b0a82a5cadc0c8374250" title="ecryptfs_getattr_link" alt="" coords="893,123,1033,150"/>
</map>
</div>

</div>
</div>
<a id="a44ad4f9a58b735c6d9891a06df838671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ad4f9a58b735c6d9891a06df838671">&#9670;&nbsp;</a></span>ecryptfs_parse_packet_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_parse_packet_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>ecryptfs_dentry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_parse_packet_set : The cryptographic context : Virtual address of region of memory containing the packets : The eCryptfs dentry associated with the packet set</p>
<p>Get crypt_stat to have the file's session key if the requisite key is available to decrypt the session key.</p>
<p>Returns Zero if a valid authentication token was retrieved and processed; negative value for file not encrypted or for error conditions. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a44ad4f9a58b735c6d9891a06df838671_cgraph.png" border="0" usemap="#keystore_8c_a44ad4f9a58b735c6d9891a06df838671_cgraph" alt=""/></div>
<map name="keystore_8c_a44ad4f9a58b735c6d9891a06df838671_cgraph" id="keystore_8c_a44ad4f9a58b735c6d9891a06df838671_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a32c87c3d9f5f82f8e86006f94b9130d3" title="parse_tag_3_packet" alt="" coords="249,73,387,100"/>
<area shape="rect" id="node5" href="ecryptfs_2crypto_8c.html#aa6806b87a57ada237cc52b391b0b70dc" title="ecryptfs_init_crypt_ctx" alt="" coords="466,5,621,32"/>
<area shape="rect" id="node7" href="keystore_8c.html#a30981d0242b86acbe5a11d007022a828" title="parse_tag_11_packet" alt="" coords="245,275,391,301"/>
<area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#aeec5ed0402a0ff0e7a39802c16ec45ce" title="ecryptfs_to_hex" alt="" coords="486,107,601,133"/>
<area shape="rect" id="node10" href="keystore_8c.html#ac0f59c651d74024aedd73031beadeca5" title="parse_tag_1_packet" alt="" coords="249,224,387,251"/>
<area shape="rect" id="node11" href="ecryptfs_2debug_8c.html#a77caaec801939ef76ff0cb3c11e529b4" title="ecryptfs_dump_auth_tok" alt="" coords="235,325,401,352"/>
<area shape="rect" id="node13" href="keystore_8c.html#a5192f320ce5afdac99056c1e06ad771f" title="ecryptfs_get_auth_tok_sig" alt="" coords="456,579,631,605"/>
<area shape="rect" id="node14" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="253,707,383,749"/>
<area shape="rect" id="node23" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="241,398,395,439"/>
<area shape="rect" id="node35" href="keystore_8c.html#a9b8a7767d3634e57b9fbe484cc680ad0" title="decrypt_passphrase\l_encrypted_session_key" alt="" coords="235,570,401,611"/>
<area shape="rect" id="node41" href="ecryptfs_2crypto_8c.html#a010c33619300979023e302badcdbd3b5" title="ecryptfs_compute_root_iv" alt="" coords="232,773,404,800"/>
<area shape="rect" id="node44" href="keystore_8c.html#a90a8b7a243cf75059dfee4f58aed97a2" title="wipe_auth_tok_list" alt="" coords="253,824,383,851"/>
<area shape="rect" id="node3" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="699,242,853,283"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a9ec4f1a07858b147d07a4691fccc9741" title="ecryptfs_cipher_code\l_to_string" alt="" coords="470,158,617,199"/>
<area shape="rect" id="node6" href="ecryptfs_2crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="1181,297,1322,338"/>
<area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="711,107,841,133"/>
<area shape="rect" id="node12" href="ecryptfs_2debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="475,325,611,352"/>
<area shape="rect" id="node15" href="keystore_8c.html#a486092d42d552350a77e9cb58526f000" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="474,813,613,854"/>
<area shape="rect" id="node20" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="468,747,619,789"/>
<area shape="rect" id="node16" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1" title="ecryptfs_verify_auth\l_tok_from_key" alt="" coords="706,810,846,851"/>
<area shape="rect" id="node17" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="917,792,1124,819"/>
<area shape="rect" id="node19" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="942,843,1099,869"/>
<area shape="rect" id="node18" href="ecryptfs__kernel_8h.html#a580da71e4af9cdf7b9c749dd686f0cdf" title="ecryptfs_get_encrypted\l_key_payload_data" alt="" coords="1172,785,1331,826"/>
<area shape="rect" id="node21" href="ecryptfs__kernel_8h.html#add65e0a3cb09fdffdcc1828b0e331d32" title="ecryptfs_get_encrypted_key" alt="" coords="683,757,869,784"/>
<area shape="rect" id="node22" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="692,707,860,733"/>
<area shape="rect" id="node24" href="keystore_8c.html#a139436651ca07d4aa32396fbae14d1f9" title="write_tag_64_packet" alt="" coords="472,528,615,555"/>
<area shape="rect" id="node26" href="messaging_8c.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="461,427,625,453"/>
<area shape="rect" id="node32" href="messaging_8c.html#a92e74fb407527dec54a9faba414ea92a" title="ecryptfs_wait_for_response" alt="" coords="452,477,635,504"/>
<area shape="rect" id="node34" href="keystore_8c.html#a01fe01b7c058e56d355ac11eca7a3749" title="parse_tag_65_packet" alt="" coords="470,376,617,403"/>
<area shape="rect" id="node25" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="701,529,851,570"/>
<area shape="rect" id="node27" href="messaging_8c.html#a10730ea01271b89e1dbd74f64cff553f" title="ecryptfs_send_message\l_locked" alt="" coords="694,398,858,439"/>
<area shape="rect" id="node28" href="messaging_8c.html#a89d78e3d4381d564f3f3384901acd3da" title="ecryptfs_find_daemon\l_by_euid" alt="" coords="945,486,1096,527"/>
<area shape="rect" id="node29" href="messaging_8c.html#a3cf131d292b1e79c317132d722ad3bb3" title="ecryptfs_acquire_free\l_msg_ctx" alt="" coords="947,303,1094,345"/>
<area shape="rect" id="node30" href="messaging_8c.html#a4e5308be4f4821f928b20d7469c21267" title="ecryptfs_msg_ctx_free\l_to_alloc" alt="" coords="943,369,1098,410"/>
<area shape="rect" id="node31" href="miscdev_8c.html#a6daf51b4a7c7274ac0e7e7beeeab775d" title="ecryptfs_send_miscdev" alt="" coords="941,435,1101,461"/>
<area shape="rect" id="node33" href="messaging_8c.html#afa5f0c6e4ccfb9753a323ff2c5ae993c" title="ecryptfs_msg_ctx_alloc\l_to_free" alt="" coords="696,463,856,505"/>
<area shape="rect" id="node36" href="ecryptfs_2crypto_8c.html#ae54bca868720dfaccd8b4817f93fb70a" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="459,630,627,671"/>
<area shape="rect" id="node40" href="ecryptfs_2crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="482,696,605,723"/>
<area shape="rect" id="node37" href="ecryptfs_2crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="707,645,845,672"/>
<area shape="rect" id="node38" href="ecryptfs_2crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="685,595,867,621"/>
<area shape="rect" id="node39" href="ecryptfs_2crypto_8c.html#a88557d40f80d1debaac45a30526e9f0e" title="ecryptfs_process_key\l_cipher" alt="" coords="945,570,1096,611"/>
<area shape="rect" id="node42" href="ecryptfs_2crypto_8c.html#afe9ebb3f8af0e14969d856f179bccc8d" title="ecryptfs_calculate_md5" alt="" coords="463,879,623,905"/>
<area shape="rect" id="node43" href="ecryptfs_2crypto_8c.html#a726904aa633b92bfbeed8630f90d532d" title="ecryptfs_hash_digest" alt="" coords="703,879,849,905"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a44ad4f9a58b735c6d9891a06df838671_icgraph.png" border="0" usemap="#keystore_8c_a44ad4f9a58b735c6d9891a06df838671_icgraph" alt=""/></div>
<map name="keystore_8c_a44ad4f9a58b735c6d9891a06df838671_icgraph" id="keystore_8c_a44ad4f9a58b735c6d9891a06df838671_icgraph">
<area shape="rect" id="node2" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="232,42,411,69"/>
<area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="459,42,621,69"/>
<area shape="rect" id="node4" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="669,5,788,47"/>
<area shape="rect" id="node6" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="672,71,785,98"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="836,13,940,39"/>
</map>
</div>

</div>
</div>
<a id="a09ab4784796d57d0e2ab0ff611cc6eee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09ab4784796d57d0e2ab0ff611cc6eee">&#9670;&nbsp;</a></span>ecryptfs_parse_tag_70_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_parse_tag_70_packet </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>filename_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_packet_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>parse_tag_70_packet - Parse and process FNEK-encrypted passphrase packet : This function kmalloc's the memory for the filename : This function sets this to the amount of memory kmalloc'd for the filename : This function sets this to the the number of octets in the packet parsed : The mount-wide cryptographic context : The memory location containing the start of the tag 70 packet : The maximum legal size of the packet to be parsed from </p>
<p>Returns zero on success; non-zero otherwise </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a09ab4784796d57d0e2ab0ff611cc6eee_cgraph.png" border="0" usemap="#keystore_8c_a09ab4784796d57d0e2ab0ff611cc6eee_cgraph" alt=""/></div>
<map name="keystore_8c_a09ab4784796d57d0e2ab0ff611cc6eee_cgraph" id="keystore_8c_a09ab4784796d57d0e2ab0ff611cc6eee_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="193,5,348,47"/>
<area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#aeec5ed0402a0ff0e7a39802c16ec45ce" title="ecryptfs_to_hex" alt="" coords="213,71,328,98"/>
<area shape="rect" id="node5" href="ecryptfs_2crypto_8c.html#a9ec4f1a07858b147d07a4691fccc9741" title="ecryptfs_cipher_code\l_to_string" alt="" coords="197,123,344,164"/>
<area shape="rect" id="node6" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="206,188,335,229"/>
<area shape="rect" id="node15" href="ecryptfs_2crypto_8c.html#ae54bca868720dfaccd8b4817f93fb70a" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="187,253,355,295"/>
<area shape="rect" id="node20" href="ecryptfs_2crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="209,319,332,346"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="429,71,559,98"/>
<area shape="rect" id="node7" href="keystore_8c.html#a486092d42d552350a77e9cb58526f000" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="425,125,563,167"/>
<area shape="rect" id="node12" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="419,191,569,232"/>
<area shape="rect" id="node8" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1" title="ecryptfs_verify_auth\l_tok_from_key" alt="" coords="657,129,797,171"/>
<area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="868,111,1075,138"/>
<area shape="rect" id="node11" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="893,162,1050,189"/>
<area shape="rect" id="node10" href="ecryptfs__kernel_8h.html#a580da71e4af9cdf7b9c749dd686f0cdf" title="ecryptfs_get_encrypted\l_key_payload_data" alt="" coords="1123,104,1281,145"/>
<area shape="rect" id="node13" href="ecryptfs__kernel_8h.html#add65e0a3cb09fdffdcc1828b0e331d32" title="ecryptfs_get_encrypted_key" alt="" coords="633,198,820,225"/>
<area shape="rect" id="node14" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="643,249,811,275"/>
<area shape="rect" id="node16" href="ecryptfs_2crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="425,259,563,286"/>
<area shape="rect" id="node17" href="ecryptfs_2crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="403,310,585,337"/>
<area shape="rect" id="node18" href="ecryptfs_2crypto_8c.html#a88557d40f80d1debaac45a30526e9f0e" title="ecryptfs_process_key\l_cipher" alt="" coords="651,303,802,344"/>
<area shape="rect" id="node19" href="ecryptfs_2crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="901,303,1042,344"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a09ab4784796d57d0e2ab0ff611cc6eee_icgraph.png" border="0" usemap="#keystore_8c_a09ab4784796d57d0e2ab0ff611cc6eee_icgraph" alt=""/></div>
<map name="keystore_8c_a09ab4784796d57d0e2ab0ff611cc6eee_icgraph" id="keystore_8c_a09ab4784796d57d0e2ab0ff611cc6eee_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ad92bd4ca5b5dec50558342a288e4da03" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="205,23,351,65"/>
<area shape="rect" id="node8" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="187,89,369,116"/>
<area shape="rect" id="node3" href="ecryptfs_2file_8c.html#aaee78a54b5aaf1796ee1f1a8afc990ea" title="ecryptfs_filldir" alt="" coords="445,5,548,32"/>
<area shape="rect" id="node5" href="ecryptfs_2inode_8c.html#a07fd8a464f9fc168e4a490421ff61cb7" title="ecryptfs_readlink_lower" alt="" coords="417,56,576,83"/>
<area shape="rect" id="node4" href="ecryptfs_2file_8c.html#a8997e4f7523880bfe681e8e13a7159cb" title="ecryptfs_readdir" alt="" coords="637,5,751,32"/>
<area shape="rect" id="node6" href="ecryptfs_2inode_8c.html#a450e9a3a23567116f4c583f062e5174e" title="ecryptfs_get_link" alt="" coords="633,56,755,83"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a6c79d00b1445b0a82a5cadc0c8374250" title="ecryptfs_getattr_link" alt="" coords="624,107,764,133"/>
</map>
</div>

</div>
</div>
<a id="ad34bd330acbf6c1cfc0347a8e6337fc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34bd330acbf6c1cfc0347a8e6337fc1">&#9670;&nbsp;</a></span>ecryptfs_verify_auth_tok_from_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_verify_auth_tok_from_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> *&#160;</td>
          <td class="paramname"><em>auth_tok_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok **&#160;</td>
          <td class="paramname"><em>auth_tok</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_verify_auth_tok_from_key : key containing the authentication token : authentication token</p>
<p>Returns zero on valid auth tok; -EINVAL if the payload is invalid; or -EKEYREVOKED if the key was revoked before we acquired its semaphore. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ad34bd330acbf6c1cfc0347a8e6337fc1_cgraph.png" border="0" usemap="#keystore_8c_ad34bd330acbf6c1cfc0347a8e6337fc1_cgraph" alt=""/></div>
<map name="keystore_8c_ad34bd330acbf6c1cfc0347a8e6337fc1_cgraph" id="keystore_8c_ad34bd330acbf6c1cfc0347a8e6337fc1_cgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="193,13,400,39"/>
<area shape="rect" id="node4" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="218,63,375,90"/>
<area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#a580da71e4af9cdf7b9c749dd686f0cdf" title="ecryptfs_get_encrypted\l_key_payload_data" alt="" coords="448,5,607,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ad34bd330acbf6c1cfc0347a8e6337fc1_icgraph.png" border="0" usemap="#keystore_8c_ad34bd330acbf6c1cfc0347a8e6337fc1_icgraph" alt=""/></div>
<map name="keystore_8c_ad34bd330acbf6c1cfc0347a8e6337fc1_icgraph" id="keystore_8c_ad34bd330acbf6c1cfc0347a8e6337fc1_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a486092d42d552350a77e9cb58526f000" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="199,191,338,233"/>
<area shape="rect" id="node28" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="193,271,344,313"/>
<area shape="rect" id="node3" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="405,191,534,233"/>
<area shape="rect" id="node23" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="392,97,547,138"/>
<area shape="rect" id="node4" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="621,242,751,283"/>
<area shape="rect" id="node10" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="619,177,753,218"/>
<area shape="rect" id="node17" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="597,124,775,151"/>
<area shape="rect" id="node5" href="ecryptfs_2crypto_8c.html#a7c08ddd3f800324ed36c5f9b4544c870" title="ecryptfs_encrypt_filename" alt="" coords="829,249,1004,276"/>
<area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="825,300,1008,327"/>
<area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#aa0f5463cff0ed1050e3f754759add6d1" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="1064,318,1211,359"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a12d536a3a1a72ba18dcc8ff49a79e9af" title="ecryptfs_lookup" alt="" coords="1279,325,1394,352"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1276,376,1397,403"/>
<area shape="rect" id="node11" href="ecryptfs__kernel_8h.html#ad92bd4ca5b5dec50558342a288e4da03" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="843,177,990,218"/>
<area shape="rect" id="node12" href="ecryptfs_2file_8c.html#aaee78a54b5aaf1796ee1f1a8afc990ea" title="ecryptfs_filldir" alt="" coords="1086,173,1189,200"/>
<area shape="rect" id="node14" href="ecryptfs_2inode_8c.html#a07fd8a464f9fc168e4a490421ff61cb7" title="ecryptfs_readlink_lower" alt="" coords="1058,224,1217,251"/>
<area shape="rect" id="node13" href="ecryptfs_2file_8c.html#a8997e4f7523880bfe681e8e13a7159cb" title="ecryptfs_readdir" alt="" coords="1279,173,1394,200"/>
<area shape="rect" id="node15" href="ecryptfs_2inode_8c.html#a450e9a3a23567116f4c583f062e5174e" title="ecryptfs_get_link" alt="" coords="1276,224,1397,251"/>
<area shape="rect" id="node16" href="ecryptfs_2inode_8c.html#a6c79d00b1445b0a82a5cadc0c8374250" title="ecryptfs_getattr_link" alt="" coords="1267,275,1407,301"/>
<area shape="rect" id="node18" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="827,124,1006,151"/>
<area shape="rect" id="node19" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1056,123,1219,149"/>
<area shape="rect" id="node20" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1277,57,1396,98"/>
<area shape="rect" id="node22" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1280,123,1393,149"/>
<area shape="rect" id="node21" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1455,64,1559,91"/>
<area shape="rect" id="node24" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="595,71,777,97"/>
<area shape="rect" id="node25" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="834,69,999,96"/>
<area shape="rect" id="node26" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="1064,64,1211,91"/>
<area shape="rect" id="node27" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1281,5,1393,32"/>
<area shape="rect" id="node29" href="ecryptfs_2main_8c.html#aecf26c95d45fdefd573861a1dc6fcb83" title="ecryptfs_init_global\l_auth_toks" alt="" coords="402,362,537,403"/>
<area shape="rect" id="node30" href="ecryptfs_2main_8c.html#a8ec3ce5c1be8d64f41497847d4a2191f" title="ecryptfs_parse_options" alt="" coords="607,376,765,403"/>
<area shape="rect" id="node31" href="ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="861,389,973,416"/>
<area shape="rect" id="node32" href="ecryptfs_2main_8c.html#afc526befd9b281d81555e8ee7f643d6e" title="ecryptfs_kill_block\l_super" alt="" coords="1072,383,1203,425"/>
</map>
</div>

</div>
</div>
<a id="a51fbc3dfa25435572fbb4c39efb8b515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51fbc3dfa25435572fbb4c39efb8b515">&#9670;&nbsp;</a></span>ecryptfs_verify_version()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ecryptfs_verify_version </td>
          <td>(</td>
          <td class="paramtype">u16&#160;</td>
          <td class="paramname"><em>version</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ecryptfs_verify_version </p><dl class="section version"><dt>Version</dt><dd>: The version number to confirm</dd></dl>
<p>Returns zero on good version; non-zero otherwise </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a51fbc3dfa25435572fbb4c39efb8b515_icgraph.png" border="0" usemap="#keystore_8c_a51fbc3dfa25435572fbb4c39efb8b515_icgraph" alt=""/></div>
<map name="keystore_8c_a51fbc3dfa25435572fbb4c39efb8b515_icgraph" id="keystore_8c_a51fbc3dfa25435572fbb4c39efb8b515_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1" title="ecryptfs_verify_auth\l_tok_from_key" alt="" coords="211,239,351,281"/>
<area shape="rect" id="node3" href="keystore_8c.html#a486092d42d552350a77e9cb58526f000" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="405,191,543,233"/>
<area shape="rect" id="node29" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="399,271,549,313"/>
<area shape="rect" id="node4" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="610,191,739,233"/>
<area shape="rect" id="node24" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="597,97,752,138"/>
<area shape="rect" id="node5" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="827,242,956,283"/>
<area shape="rect" id="node11" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="825,177,958,218"/>
<area shape="rect" id="node18" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="802,124,981,151"/>
<area shape="rect" id="node6" href="ecryptfs_2crypto_8c.html#a7c08ddd3f800324ed36c5f9b4544c870" title="ecryptfs_encrypt_filename" alt="" coords="1035,249,1209,276"/>
<area shape="rect" id="node10" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="1031,300,1213,327"/>
<area shape="rect" id="node7" href="ecryptfs__kernel_8h.html#aa0f5463cff0ed1050e3f754759add6d1" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="1269,318,1416,359"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#a12d536a3a1a72ba18dcc8ff49a79e9af" title="ecryptfs_lookup" alt="" coords="1485,325,1599,352"/>
<area shape="rect" id="node9" href="ecryptfs_2inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1481,376,1603,403"/>
<area shape="rect" id="node12" href="ecryptfs__kernel_8h.html#ad92bd4ca5b5dec50558342a288e4da03" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="1049,177,1195,218"/>
<area shape="rect" id="node13" href="ecryptfs_2file_8c.html#aaee78a54b5aaf1796ee1f1a8afc990ea" title="ecryptfs_filldir" alt="" coords="1291,173,1394,200"/>
<area shape="rect" id="node15" href="ecryptfs_2inode_8c.html#a07fd8a464f9fc168e4a490421ff61cb7" title="ecryptfs_readlink_lower" alt="" coords="1263,224,1422,251"/>
<area shape="rect" id="node14" href="ecryptfs_2file_8c.html#a8997e4f7523880bfe681e8e13a7159cb" title="ecryptfs_readdir" alt="" coords="1485,173,1599,200"/>
<area shape="rect" id="node16" href="ecryptfs_2inode_8c.html#a450e9a3a23567116f4c583f062e5174e" title="ecryptfs_get_link" alt="" coords="1481,224,1603,251"/>
<area shape="rect" id="node17" href="ecryptfs_2inode_8c.html#a6c79d00b1445b0a82a5cadc0c8374250" title="ecryptfs_getattr_link" alt="" coords="1472,275,1612,301"/>
<area shape="rect" id="node19" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="1033,124,1211,151"/>
<area shape="rect" id="node20" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1261,123,1424,149"/>
<area shape="rect" id="node21" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1483,57,1601,98"/>
<area shape="rect" id="node23" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1485,123,1599,149"/>
<area shape="rect" id="node22" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1660,64,1764,91"/>
<area shape="rect" id="node25" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="800,71,983,97"/>
<area shape="rect" id="node26" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="1039,69,1205,96"/>
<area shape="rect" id="node27" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="1269,64,1416,91"/>
<area shape="rect" id="node28" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1486,5,1598,32"/>
<area shape="rect" id="node30" href="ecryptfs_2main_8c.html#aecf26c95d45fdefd573861a1dc6fcb83" title="ecryptfs_init_global\l_auth_toks" alt="" coords="607,362,742,403"/>
<area shape="rect" id="node31" href="ecryptfs_2main_8c.html#a8ec3ce5c1be8d64f41497847d4a2191f" title="ecryptfs_parse_options" alt="" coords="813,376,970,403"/>
<area shape="rect" id="node32" href="ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="1066,389,1178,416"/>
<area shape="rect" id="node33" href="ecryptfs_2main_8c.html#afc526befd9b281d81555e8ee7f643d6e" title="ecryptfs_kill_block\l_super" alt="" coords="1277,383,1408,425"/>
</map>
</div>

</div>
</div>
<a id="a58141bba8fe1839782991135894cc340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58141bba8fe1839782991135894cc340">&#9670;&nbsp;</a></span>ecryptfs_write_packet_length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_write_packet_length </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_size_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ecryptfs_write_packet_length : The byte array target into which to write the length. Must have at least ECRYPTFS_MAX_PKT_LEN_SIZE bytes allocated. : The length to write. : The number of bytes used to encode the packet length is written to this address.</p>
<p>Returns zero on success; non-zero on error. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a58141bba8fe1839782991135894cc340_icgraph.png" border="0" usemap="#keystore_8c_a58141bba8fe1839782991135894cc340_icgraph" alt=""/></div>
<map name="keystore_8c_a58141bba8fe1839782991135894cc340_icgraph" id="keystore_8c_a58141bba8fe1839782991135894cc340_icgraph">
<area shape="rect" id="node2" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="409,71,592,98"/>
<area shape="rect" id="node3" href="keystore_8c.html#a139436651ca07d4aa32396fbae14d1f9" title="write_tag_64_packet" alt="" coords="211,13,354,39"/>
<area shape="rect" id="node11" href="keystore_8c.html#a98ebf885256c3ac84ee176459d46455c" title="write_tag_66_packet" alt="" coords="211,282,354,309"/>
<area shape="rect" id="node13" href="keystore_8c.html#a3526c198eba1a1f96e489796fad16ee8" title="write_tag_1_packet" alt="" coords="662,231,797,258"/>
<area shape="rect" id="node19" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="218,115,347,156"/>
<area shape="rect" id="node24" href="keystore_8c.html#aa635b6e3a4e2bc10bc02d2a3d6636fa9" title="write_tag_11_packet" alt="" coords="658,181,801,207"/>
<area shape="rect" id="node25" href="keystore_8c.html#a93f9c9afc806ac6cee810aa85b04f7d6" title="write_tag_3_packet" alt="" coords="433,333,568,359"/>
<area shape="rect" id="node26" href="miscdev_8c.html#aaacfe8b20f05523915edd49d2487349e" title="ecryptfs_miscdev_read" alt="" coords="204,383,361,410"/>
<area shape="rect" id="node4" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="424,5,577,47"/>
<area shape="rect" id="node5" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="640,38,819,65"/>
<area shape="rect" id="node6" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="867,65,1045,91"/>
<area shape="rect" id="node7" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1103,67,1266,94"/>
<area shape="rect" id="node8" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1732,115,1851,156"/>
<area shape="rect" id="node10" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1350,67,1463,94"/>
<area shape="rect" id="node9" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1899,122,2003,149"/>
<area shape="rect" id="node12" href="keystore_8c.html#a97cf4aa86d30a50e38ab1f56f014f1bc" title="pki_encrypt_session_key" alt="" coords="416,282,585,309"/>
<area shape="rect" id="node14" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="879,220,1033,261"/>
<area shape="rect" id="node15" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="1093,202,1276,229"/>
<area shape="rect" id="node16" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="1324,190,1489,217"/>
<area shape="rect" id="node17" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="1537,183,1684,210"/>
<area shape="rect" id="node18" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1735,183,1847,210"/>
<area shape="rect" id="node20" href="ecryptfs_2crypto_8c.html#a7c08ddd3f800324ed36c5f9b4544c870" title="ecryptfs_encrypt_filename" alt="" coords="413,122,588,149"/>
<area shape="rect" id="node21" href="ecryptfs__kernel_8h.html#aa0f5463cff0ed1050e3f754759add6d1" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="656,115,803,156"/>
<area shape="rect" id="node22" href="ecryptfs_2inode_8c.html#a12d536a3a1a72ba18dcc8ff49a79e9af" title="ecryptfs_lookup" alt="" coords="899,117,1013,143"/>
<area shape="rect" id="node23" href="ecryptfs_2inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="895,167,1017,194"/>
</map>
</div>

</div>
</div>
<a id="a954c6998fe1c4a445153fda4ff4c1b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a954c6998fe1c4a445153fda4ff4c1b8e">&#9670;&nbsp;</a></span>ecryptfs_write_tag_70_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecryptfs_write_tag_70_packet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>remaining_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__mount__crypt__stat.html">ecryptfs_mount_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>mount_crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>filename_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>write_tag_70_packet - Write encrypted filename (EFN) packet against FNEK : NULL-terminated filename string</p>
<p>This is the simplest mechanism for achieving filename encryption in eCryptfs. It encrypts the given filename with the mount-wide filename encryption key (FNEK) and stores it in a packet to , which the callee will encode and write directly into the dentry name. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a954c6998fe1c4a445153fda4ff4c1b8e_cgraph.png" border="0" usemap="#keystore_8c_a954c6998fe1c4a445153fda4ff4c1b8e_cgraph" alt=""/></div>
<map name="keystore_8c_a954c6998fe1c4a445153fda4ff4c1b8e_cgraph" id="keystore_8c_a954c6998fe1c4a445153fda4ff4c1b8e_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="202,89,331,131"/>
<area shape="rect" id="node11" href="ecryptfs_2crypto_8c.html#ae54bca868720dfaccd8b4817f93fb70a" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="183,155,351,196"/>
<area shape="rect" id="node16" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="191,220,342,261"/>
<area shape="rect" id="node17" href="ecryptfs_2crypto_8c.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="201,286,332,313"/>
<area shape="rect" id="node18" href="ecryptfs_2crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="183,337,351,379"/>
<area shape="rect" id="node19" href="ecryptfs_2crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="205,403,328,430"/>
<area shape="rect" id="node3" href="keystore_8c.html#a486092d42d552350a77e9cb58526f000" title="ecryptfs_find_global\l_auth_tok_for_sig" alt="" coords="421,28,559,69"/>
<area shape="rect" id="node8" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="415,93,565,135"/>
<area shape="rect" id="node4" href="keystore_8c.html#ad34bd330acbf6c1cfc0347a8e6337fc1" title="ecryptfs_verify_auth\l_tok_from_key" alt="" coords="653,31,793,72"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a17cb5e0da33b0a3da45e14fb4085ad6a" title="ecryptfs_get_key_payload_data" alt="" coords="864,13,1071,39"/>
<area shape="rect" id="node7" href="keystore_8c.html#a51fbc3dfa25435572fbb4c39efb8b515" title="ecryptfs_verify_version" alt="" coords="889,63,1046,90"/>
<area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#a580da71e4af9cdf7b9c749dd686f0cdf" title="ecryptfs_get_encrypted\l_key_payload_data" alt="" coords="1119,5,1277,47"/>
<area shape="rect" id="node9" href="ecryptfs__kernel_8h.html#add65e0a3cb09fdffdcc1828b0e331d32" title="ecryptfs_get_encrypted_key" alt="" coords="629,98,816,125"/>
<area shape="rect" id="node10" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="639,149,807,175"/>
<area shape="rect" id="node12" href="ecryptfs_2crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="421,159,559,186"/>
<area shape="rect" id="node13" href="ecryptfs_2crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="399,210,581,237"/>
<area shape="rect" id="node14" href="ecryptfs_2crypto_8c.html#a88557d40f80d1debaac45a30526e9f0e" title="ecryptfs_process_key\l_cipher" alt="" coords="647,203,798,244"/>
<area shape="rect" id="node15" href="ecryptfs_2crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="897,203,1038,244"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a954c6998fe1c4a445153fda4ff4c1b8e_icgraph.png" border="0" usemap="#keystore_8c_a954c6998fe1c4a445153fda4ff4c1b8e_icgraph" alt=""/></div>
<map name="keystore_8c_a954c6998fe1c4a445153fda4ff4c1b8e_icgraph" id="keystore_8c_a954c6998fe1c4a445153fda4ff4c1b8e_icgraph">
<area shape="rect" id="node2" href="ecryptfs_2crypto_8c.html#a7c08ddd3f800324ed36c5f9b4544c870" title="ecryptfs_encrypt_filename" alt="" coords="187,31,361,57"/>
<area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="183,81,365,108"/>
<area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#aa0f5463cff0ed1050e3f754759add6d1" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="413,23,560,65"/>
<area shape="rect" id="node4" href="ecryptfs_2inode_8c.html#a12d536a3a1a72ba18dcc8ff49a79e9af" title="ecryptfs_lookup" alt="" coords="611,5,726,32"/>
<area shape="rect" id="node5" href="ecryptfs_2inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="608,56,729,83"/>
</map>
</div>

</div>
</div>
<a id="a30981d0242b86acbe5a11d007022a828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30981d0242b86acbe5a11d007022a828">&#9670;&nbsp;</a></span>parse_tag_11_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parse_tag_11_packet </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>contents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_contents_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>tag_11_contents_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_packet_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>parse_tag_11_packet : The raw bytes of the packet : This function writes the data contents of the literal packet into this memory location : The maximum number of bytes that this function is allowed to write into contents : This function writes the size of the parsed contents into this memory location; zero on error : This function writes the size of the parsed packet into this memory location; zero on error : maximum number of bytes to parse</p>
<p>Returns zero on success; non-zero on error. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a30981d0242b86acbe5a11d007022a828_cgraph.png" border="0" usemap="#keystore_8c_a30981d0242b86acbe5a11d007022a828_cgraph" alt=""/></div>
<map name="keystore_8c_a30981d0242b86acbe5a11d007022a828_cgraph" id="keystore_8c_a30981d0242b86acbe5a11d007022a828_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="200,5,355,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a30981d0242b86acbe5a11d007022a828_icgraph.png" border="0" usemap="#keystore_8c_a30981d0242b86acbe5a11d007022a828_icgraph" alt=""/></div>
<map name="keystore_8c_a30981d0242b86acbe5a11d007022a828_icgraph" id="keystore_8c_a30981d0242b86acbe5a11d007022a828_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="200,42,379,69"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="427,42,605,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="653,42,816,69"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="864,5,983,47"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="867,71,980,98"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1031,13,1135,39"/>
</map>
</div>

</div>
</div>
<a id="ac0f59c651d74024aedd73031beadeca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0f59c651d74024aedd73031beadeca5">&#9670;&nbsp;</a></span>parse_tag_1_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parse_tag_1_packet </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct list_head *&#160;</td>
          <td class="paramname"><em>auth_tok_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok **&#160;</td>
          <td class="paramname"><em>new_auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_packet_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>parse_tag_1_packet : The cryptographic context to modify based on packet contents : The raw bytes of the packet. : eCryptfs parses packets into authentication tokens; a new authentication token will be placed at the end of this list for this packet. : Pointer to a pointer to memory that this function allocates; sets the memory address of the pointer to NULL on error. This object is added to the auth_tok_list. : This function writes the size of the parsed packet into this memory location; zero on error. : The maximum allowable packet size</p>
<p>Returns zero on success; non-zero on error. </p>
<p>This format is inspired by OpenPGP; see RFC 2440 packet tag 1</p>
<p>Tag 1 identifier (1 byte) Max Tag 1 packet size (max 3 bytes) Version (1 byte) Key identifier (8 bytes; ECRYPTFS_SIG_SIZE) Cipher identifier (1 byte) Encrypted key size (arbitrary)</p>
<p>12 bytes minimum packet size</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ac0f59c651d74024aedd73031beadeca5_cgraph.png" border="0" usemap="#keystore_8c_ac0f59c651d74024aedd73031beadeca5_cgraph" alt=""/></div>
<map name="keystore_8c_ac0f59c651d74024aedd73031beadeca5_cgraph" id="keystore_8c_ac0f59c651d74024aedd73031beadeca5_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="192,5,347,47"/>
<area shape="rect" id="node3" href="ecryptfs__kernel_8h.html#aeec5ed0402a0ff0e7a39802c16ec45ce" title="ecryptfs_to_hex" alt="" coords="212,71,327,98"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="395,71,525,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ac0f59c651d74024aedd73031beadeca5_icgraph.png" border="0" usemap="#keystore_8c_ac0f59c651d74024aedd73031beadeca5_icgraph" alt=""/></div>
<map name="keystore_8c_ac0f59c651d74024aedd73031beadeca5_icgraph" id="keystore_8c_ac0f59c651d74024aedd73031beadeca5_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="192,42,371,69"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="419,42,597,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="645,42,808,69"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="856,5,975,47"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="859,71,972,98"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1023,13,1127,39"/>
</map>
</div>

</div>
</div>
<a id="a32c87c3d9f5f82f8e86006f94b9130d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32c87c3d9f5f82f8e86006f94b9130d3">&#9670;&nbsp;</a></span>parse_tag_3_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parse_tag_3_packet </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct list_head *&#160;</td>
          <td class="paramname"><em>auth_tok_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok **&#160;</td>
          <td class="paramname"><em>new_auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_packet_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>parse_tag_3_packet : The cryptographic context to modify based on packet contents. : The raw bytes of the packet. : eCryptfs parses packets into authentication tokens; a new authentication token will be placed at the end of this list for this packet. : Pointer to a pointer to memory that this function allocates; sets the memory address of the pointer to NULL on error. This object is added to the auth_tok_list. : This function writes the size of the parsed packet into this memory location; zero on error. : maximum number of bytes to parse</p>
<p>Returns zero on success; non-zero on error. </p>
<p>This format is inspired by OpenPGP; see RFC 2440 packet tag 3</p>
<p>Tag 3 identifier (1 byte) Max Tag 3 packet size (max 3 bytes) Version (1 byte) Cipher code (1 byte) S2K specifier (1 byte) Hash identifier (1 byte) Salt (ECRYPTFS_SALT_SIZE) Hash iterations (1 byte) Encrypted key (arbitrary)</p>
<p>(ECRYPTFS_SALT_SIZE + 7) minimum packet size</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a32c87c3d9f5f82f8e86006f94b9130d3_cgraph.png" border="0" usemap="#keystore_8c_a32c87c3d9f5f82f8e86006f94b9130d3_cgraph" alt=""/></div>
<map name="keystore_8c_a32c87c3d9f5f82f8e86006f94b9130d3_cgraph" id="keystore_8c_a32c87c3d9f5f82f8e86006f94b9130d3_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="192,5,347,47"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a9ec4f1a07858b147d07a4691fccc9741" title="ecryptfs_cipher_code\l_to_string" alt="" coords="196,71,343,112"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#aa6806b87a57ada237cc52b391b0b70dc" title="ecryptfs_init_crypt_ctx" alt="" coords="192,137,347,163"/>
<area shape="rect" id="node5" href="ecryptfs_2crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="395,129,536,171"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a32c87c3d9f5f82f8e86006f94b9130d3_icgraph.png" border="0" usemap="#keystore_8c_a32c87c3d9f5f82f8e86006f94b9130d3_icgraph" alt=""/></div>
<map name="keystore_8c_a32c87c3d9f5f82f8e86006f94b9130d3_icgraph" id="keystore_8c_a32c87c3d9f5f82f8e86006f94b9130d3_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="192,42,371,69"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="419,42,597,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="645,42,808,69"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="856,5,975,47"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="859,71,972,98"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1023,13,1127,39"/>
</map>
</div>

</div>
</div>
<a id="a01fe01b7c058e56d355ac11eca7a3749"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01fe01b7c058e56d355ac11eca7a3749">&#9670;&nbsp;</a></span>parse_tag_65_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parse_tag_65_packet </td>
          <td>(</td>
          <td class="paramtype">struct ecryptfs_session_key *&#160;</td>
          <td class="paramname"><em>session_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>cipher_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__message.html">ecryptfs_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a01fe01b7c058e56d355ac11eca7a3749_cgraph.png" border="0" usemap="#keystore_8c_a01fe01b7c058e56d355ac11eca7a3749_cgraph" alt=""/></div>
<map name="keystore_8c_a01fe01b7c058e56d355ac11eca7a3749_cgraph" id="keystore_8c_a01fe01b7c058e56d355ac11eca7a3749_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="200,5,355,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a01fe01b7c058e56d355ac11eca7a3749_icgraph.png" border="0" usemap="#keystore_8c_a01fe01b7c058e56d355ac11eca7a3749_icgraph" alt=""/></div>
<map name="keystore_8c_a01fe01b7c058e56d355ac11eca7a3749_icgraph" id="keystore_8c_a01fe01b7c058e56d355ac11eca7a3749_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="200,35,353,76"/>
<area shape="rect" id="node3" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="401,42,580,69"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="628,42,807,69"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="855,42,1017,69"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1065,5,1184,47"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1068,71,1181,98"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1232,13,1336,39"/>
</map>
</div>

</div>
</div>
<a id="ae69ad5279272fb61e4b704482e2ba126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae69ad5279272fb61e4b704482e2ba126">&#9670;&nbsp;</a></span>parse_tag_67_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parse_tag_67_packet </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__key__record.html">ecryptfs_key_record</a> *&#160;</td>
          <td class="paramname"><em>key_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__message.html">ecryptfs_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ae69ad5279272fb61e4b704482e2ba126_cgraph.png" border="0" usemap="#keystore_8c_ae69ad5279272fb61e4b704482e2ba126_cgraph" alt=""/></div>
<map name="keystore_8c_ae69ad5279272fb61e4b704482e2ba126_cgraph" id="keystore_8c_ae69ad5279272fb61e4b704482e2ba126_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="200,5,355,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ae69ad5279272fb61e4b704482e2ba126_icgraph.png" border="0" usemap="#keystore_8c_ae69ad5279272fb61e4b704482e2ba126_icgraph" alt=""/></div>
<map name="keystore_8c_ae69ad5279272fb61e4b704482e2ba126_icgraph" id="keystore_8c_ae69ad5279272fb61e4b704482e2ba126_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a97cf4aa86d30a50e38ab1f56f014f1bc" title="pki_encrypt_session_key" alt="" coords="200,42,369,69"/>
<area shape="rect" id="node3" href="keystore_8c.html#a3526c198eba1a1f96e489796fad16ee8" title="write_tag_1_packet" alt="" coords="417,42,552,69"/>
<area shape="rect" id="node4" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="600,35,755,76"/>
<area shape="rect" id="node5" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="803,42,985,69"/>
<area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="1033,42,1199,69"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="1247,42,1393,69"/>
<area shape="rect" id="node8" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1441,5,1560,47"/>
<area shape="rect" id="node10" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1445,71,1557,98"/>
<area shape="rect" id="node9" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1608,13,1712,39"/>
</map>
</div>

</div>
</div>
<a id="a97cf4aa86d30a50e38ab1f56f014f1bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97cf4aa86d30a50e38ab1f56f014f1bc">&#9670;&nbsp;</a></span>pki_encrypt_session_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pki_encrypt_session_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> *&#160;</td>
          <td class="paramname"><em>auth_tok_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok *&#160;</td>
          <td class="paramname"><em>auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__key__record.html">ecryptfs_key_record</a> *&#160;</td>
          <td class="paramname"><em>key_rec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a97cf4aa86d30a50e38ab1f56f014f1bc_cgraph.png" border="0" usemap="#keystore_8c_a97cf4aa86d30a50e38ab1f56f014f1bc_cgraph" alt=""/></div>
<map name="keystore_8c_a97cf4aa86d30a50e38ab1f56f014f1bc_cgraph" id="keystore_8c_a97cf4aa86d30a50e38ab1f56f014f1bc_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a98ebf885256c3ac84ee176459d46455c" title="write_tag_66_packet" alt="" coords="243,13,385,39"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="230,64,398,105"/>
<area shape="rect" id="node5" href="messaging_8c.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="232,130,396,157"/>
<area shape="rect" id="node11" href="messaging_8c.html#a92e74fb407527dec54a9faba414ea92a" title="ecryptfs_wait_for_response" alt="" coords="223,181,405,207"/>
<area shape="rect" id="node13" href="keystore_8c.html#ae69ad5279272fb61e4b704482e2ba126" title="parse_tag_67_packet" alt="" coords="241,238,387,265"/>
<area shape="rect" id="node3" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="460,5,611,47"/>
<area shape="rect" id="node6" href="messaging_8c.html#a10730ea01271b89e1dbd74f64cff553f" title="ecryptfs_send_message\l_locked" alt="" coords="453,108,617,149"/>
<area shape="rect" id="node7" href="messaging_8c.html#a89d78e3d4381d564f3f3384901acd3da" title="ecryptfs_find_daemon\l_by_euid" alt="" coords="670,9,821,51"/>
<area shape="rect" id="node8" href="messaging_8c.html#a3cf131d292b1e79c317132d722ad3bb3" title="ecryptfs_acquire_free\l_msg_ctx" alt="" coords="672,75,819,116"/>
<area shape="rect" id="node9" href="messaging_8c.html#a4e5308be4f4821f928b20d7469c21267" title="ecryptfs_msg_ctx_free\l_to_alloc" alt="" coords="668,140,823,181"/>
<area shape="rect" id="node10" href="miscdev_8c.html#a6daf51b4a7c7274ac0e7e7beeeab775d" title="ecryptfs_send_miscdev" alt="" coords="665,206,825,233"/>
<area shape="rect" id="node12" href="messaging_8c.html#afa5f0c6e4ccfb9753a323ff2c5ae993c" title="ecryptfs_msg_ctx_alloc\l_to_free" alt="" coords="455,173,615,215"/>
<area shape="rect" id="node14" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="458,239,613,280"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a97cf4aa86d30a50e38ab1f56f014f1bc_icgraph.png" border="0" usemap="#keystore_8c_a97cf4aa86d30a50e38ab1f56f014f1bc_icgraph" alt=""/></div>
<map name="keystore_8c_a97cf4aa86d30a50e38ab1f56f014f1bc_icgraph" id="keystore_8c_a97cf4aa86d30a50e38ab1f56f014f1bc_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a3526c198eba1a1f96e489796fad16ee8" title="write_tag_1_packet" alt="" coords="223,42,357,69"/>
<area shape="rect" id="node3" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="405,35,560,76"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="608,42,791,69"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="839,42,1004,69"/>
<area shape="rect" id="node6" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="1052,42,1199,69"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1247,5,1365,47"/>
<area shape="rect" id="node9" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1250,71,1362,98"/>
<area shape="rect" id="node8" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1413,13,1517,39"/>
</map>
</div>

</div>
</div>
<a id="ab524d5a4683b8dbfa8762584dc110b78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab524d5a4683b8dbfa8762584dc110b78">&#9670;&nbsp;</a></span>process_find_global_auth_tok_for_sig_err()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int process_find_global_auth_tok_for_sig_err </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>err_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ab524d5a4683b8dbfa8762584dc110b78_cgraph.png" border="0" usemap="#keystore_8c_ab524d5a4683b8dbfa8762584dc110b78_cgraph" alt=""/></div>
<map name="keystore_8c_ab524d5a4683b8dbfa8762584dc110b78_cgraph" id="keystore_8c_ab524d5a4683b8dbfa8762584dc110b78_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a8e375031494d4e18494b23647b117360" title="process_request_key_err" alt="" coords="200,13,368,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_ab524d5a4683b8dbfa8762584dc110b78_icgraph.png" border="0" usemap="#keystore_8c_ab524d5a4683b8dbfa8762584dc110b78_icgraph" alt=""/></div>
<map name="keystore_8c_ab524d5a4683b8dbfa8762584dc110b78_icgraph" id="keystore_8c_ab524d5a4683b8dbfa8762584dc110b78_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="200,35,355,76"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="403,42,585,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="633,42,799,69"/>
<area shape="rect" id="node5" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="847,42,993,69"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1041,5,1160,47"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1045,71,1157,98"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1208,13,1312,39"/>
</map>
</div>

</div>
</div>
<a id="a8e375031494d4e18494b23647b117360"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e375031494d4e18494b23647b117360">&#9670;&nbsp;</a></span>process_request_key_err()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int process_request_key_err </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>err_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>eCryptfs: Linux filesystem encryption layer In-kernel key management code. Includes functions to parse and write authentication token-related packets with the underlying file.</p>
<p>Copyright (C) 2004-2006 International Business Machines Corp. Author(s): Michael A. Halcrow <a href="#" onclick="location.href='mai'+'lto:'+'mha'+'lc'+'row'+'@u'+'s.i'+'bm'+'.co'+'m'; return false;">mhalc<span style="display: none;">.nosp@m.</span>row@<span style="display: none;">.nosp@m.</span>us.ib<span style="display: none;">.nosp@m.</span>m.co<span style="display: none;">.nosp@m.</span>m</a> Michael C. Thompson <a href="#" onclick="location.href='mai'+'lto:'+'mct'+'ho'+'mps'+'@u'+'s.i'+'bm'+'.co'+'m'; return false;">mctho<span style="display: none;">.nosp@m.</span>mps@<span style="display: none;">.nosp@m.</span>us.ib<span style="display: none;">.nosp@m.</span>m.co<span style="display: none;">.nosp@m.</span>m</a> Trevor S. Highland <a href="#" onclick="location.href='mai'+'lto:'+'tre'+'vo'+'r.h'+'ig'+'hla'+'nd'+'@gm'+'ai'+'l.c'+'om'; return false;">trevo<span style="display: none;">.nosp@m.</span>r.hi<span style="display: none;">.nosp@m.</span>ghlan<span style="display: none;">.nosp@m.</span>d@gm<span style="display: none;">.nosp@m.</span>ail.c<span style="display: none;">.nosp@m.</span>om</a></p>
<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA. request_key returned an error instead of a valid key address; determine the type of error, make appropriate log entries, and return an error code. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a8e375031494d4e18494b23647b117360_icgraph.png" border="0" usemap="#keystore_8c_a8e375031494d4e18494b23647b117360_icgraph" alt=""/></div>
<map name="keystore_8c_a8e375031494d4e18494b23647b117360_icgraph" id="keystore_8c_a8e375031494d4e18494b23647b117360_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#ab524d5a4683b8dbfa8762584dc110b78" title="process_find_global\l_auth_tok_for_sig_err" alt="" coords="223,87,370,129"/>
<area shape="rect" id="node10" href="keystore_8c.html#ab6b148e66717e54b2087a18b51531450" title="ecryptfs_keyring_auth\l_tok_for_sig" alt="" coords="221,166,372,207"/>
<area shape="rect" id="node3" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="420,53,575,94"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="623,39,805,65"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="862,39,1027,65"/>
<area shape="rect" id="node6" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="1092,39,1239,65"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1305,57,1424,98"/>
<area shape="rect" id="node9" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1309,5,1421,32"/>
<area shape="rect" id="node8" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1483,64,1587,91"/>
<area shape="rect" id="node11" href="ecryptfs_2main_8c.html#aecf26c95d45fdefd573861a1dc6fcb83" title="ecryptfs_init_global\l_auth_toks" alt="" coords="430,286,565,327"/>
<area shape="rect" id="node15" href="ecryptfs__kernel_8h.html#ac96ef599ae7878dc4c2459b1f2f3de4b" title="ecryptfs_wait_for_response" alt="" coords="853,169,1036,196"/>
<area shape="rect" id="node16" href="keystore_8c.html#ad400c5f10bbfd94c8fadd91a2cc3f908" title="ecryptfs_find_auth\l_tok_for_sig" alt="" coords="433,191,562,233"/>
<area shape="rect" id="node12" href="ecryptfs_2main_8c.html#a8ec3ce5c1be8d64f41497847d4a2191f" title="ecryptfs_parse_options" alt="" coords="635,323,793,349"/>
<area shape="rect" id="node13" href="ecryptfs_2main_8c.html#aa971f29739b630fd4439bee2feb73003" title="ecryptfs_mount" alt="" coords="889,220,1001,247"/>
<area shape="rect" id="node14" href="ecryptfs_2main_8c.html#afc526befd9b281d81555e8ee7f643d6e" title="ecryptfs_kill_block\l_super" alt="" coords="1100,181,1231,222"/>
<area shape="rect" id="node17" href="keystore_8c.html#a954c6998fe1c4a445153fda4ff4c1b8e" title="ecryptfs_write_tag\l_70_packet" alt="" coords="649,257,779,298"/>
<area shape="rect" id="node22" href="keystore_8c.html#a09ab4784796d57d0e2ab0ff611cc6eee" title="ecryptfs_parse_tag\l_70_packet" alt="" coords="647,191,781,233"/>
<area shape="rect" id="node29" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="625,89,803,116"/>
<area shape="rect" id="node18" href="ecryptfs_2crypto_8c.html#a7c08ddd3f800324ed36c5f9b4544c870" title="ecryptfs_encrypt_filename" alt="" coords="857,349,1032,376"/>
<area shape="rect" id="node19" href="ecryptfs__kernel_8h.html#aa0f5463cff0ed1050e3f754759add6d1" title="ecryptfs_encrypt_and\l_encode_filename" alt="" coords="1092,367,1239,409"/>
<area shape="rect" id="node20" href="ecryptfs_2inode_8c.html#a12d536a3a1a72ba18dcc8ff49a79e9af" title="ecryptfs_lookup" alt="" coords="1307,375,1422,401"/>
<area shape="rect" id="node21" href="ecryptfs_2inode_8c.html#ae9629ba2454c02f4efeba467903fb345" title="ecryptfs_symlink" alt="" coords="1304,425,1425,452"/>
<area shape="rect" id="node23" href="ecryptfs__kernel_8h.html#ad92bd4ca5b5dec50558342a288e4da03" title="ecryptfs_decode_and\l_decrypt_filename" alt="" coords="871,271,1018,313"/>
<area shape="rect" id="node24" href="ecryptfs_2file_8c.html#aaee78a54b5aaf1796ee1f1a8afc990ea" title="ecryptfs_filldir" alt="" coords="1114,247,1217,273"/>
<area shape="rect" id="node26" href="ecryptfs_2inode_8c.html#a07fd8a464f9fc168e4a490421ff61cb7" title="ecryptfs_readlink_lower" alt="" coords="1086,297,1245,324"/>
<area shape="rect" id="node25" href="ecryptfs_2file_8c.html#a8997e4f7523880bfe681e8e13a7159cb" title="ecryptfs_readdir" alt="" coords="1307,223,1422,249"/>
<area shape="rect" id="node27" href="ecryptfs_2inode_8c.html#a450e9a3a23567116f4c583f062e5174e" title="ecryptfs_get_link" alt="" coords="1304,273,1425,300"/>
<area shape="rect" id="node28" href="ecryptfs_2inode_8c.html#a6c79d00b1445b0a82a5cadc0c8374250" title="ecryptfs_getattr_link" alt="" coords="1295,324,1435,351"/>
<area shape="rect" id="node30" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="855,89,1034,116"/>
<area shape="rect" id="node31" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="1084,89,1247,116"/>
<area shape="rect" id="node32" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1308,123,1421,149"/>
</map>
</div>

</div>
</div>
<a id="a90a8b7a243cf75059dfee4f58aed97a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90a8b7a243cf75059dfee4f58aed97a2">&#9670;&nbsp;</a></span>wipe_auth_tok_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void wipe_auth_tok_list </td>
          <td>(</td>
          <td class="paramtype">struct list_head *&#160;</td>
          <td class="paramname"><em>auth_tok_list_head</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a90a8b7a243cf75059dfee4f58aed97a2_icgraph.png" border="0" usemap="#keystore_8c_a90a8b7a243cf75059dfee4f58aed97a2_icgraph" alt=""/></div>
<map name="keystore_8c_a90a8b7a243cf75059dfee4f58aed97a2_icgraph" id="keystore_8c_a90a8b7a243cf75059dfee4f58aed97a2_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="184,42,363,69"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="411,42,589,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="637,42,800,69"/>
<area shape="rect" id="node5" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="848,5,967,47"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="851,71,964,98"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1015,13,1119,39"/>
</map>
</div>

</div>
</div>
<a id="aa635b6e3a4e2bc10bc02d2a3d6636fa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa635b6e3a4e2bc10bc02d2a3d6636fa9">&#9670;&nbsp;</a></span>write_tag_11_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_tag_11_packet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>remaining_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>contents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>contents_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>write_tag_11_packet : Target into which Tag 11 packet is to be written : Maximum packet length : Byte array of contents to copy in : Number of bytes in contents : Length of the Tag 11 packet written; zero on error</p>
<p>Returns zero on success; non-zero on error. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_aa635b6e3a4e2bc10bc02d2a3d6636fa9_cgraph.png" border="0" usemap="#keystore_8c_aa635b6e3a4e2bc10bc02d2a3d6636fa9_cgraph" alt=""/></div>
<map name="keystore_8c_aa635b6e3a4e2bc10bc02d2a3d6636fa9_cgraph" id="keystore_8c_aa635b6e3a4e2bc10bc02d2a3d6636fa9_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="196,5,347,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_aa635b6e3a4e2bc10bc02d2a3d6636fa9_icgraph.png" border="0" usemap="#keystore_8c_aa635b6e3a4e2bc10bc02d2a3d6636fa9_icgraph" alt=""/></div>
<map name="keystore_8c_aa635b6e3a4e2bc10bc02d2a3d6636fa9_icgraph" id="keystore_8c_aa635b6e3a4e2bc10bc02d2a3d6636fa9_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="196,35,351,76"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="399,42,581,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="629,42,795,69"/>
<area shape="rect" id="node5" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="843,42,989,69"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1037,5,1156,47"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1041,71,1153,98"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1204,13,1308,39"/>
</map>
</div>

</div>
</div>
<a id="a3526c198eba1a1f96e489796fad16ee8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3526c198eba1a1f96e489796fad16ee8">&#9670;&nbsp;</a></span>write_tag_1_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_tag_1_packet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>remaining_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="cifspdu_8h.html#a63d44da4c2019b7ae1dd3c4e15b887aa">key</a> *&#160;</td>
          <td class="paramname"><em>auth_tok_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok *&#160;</td>
          <td class="paramname"><em>auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__key__record.html">ecryptfs_key_record</a> *&#160;</td>
          <td class="paramname"><em>key_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>write_tag_1_packet - Write an RFC2440-compatible tag 1 (public key) packet : Buffer into which to write the packet : Maximum number of bytes that can be writtn : The authentication token key to unlock and put when done with  : The authentication token used for generating the tag 1 packet : The cryptographic context : The key record struct for the tag 1 packet : This function will write the number of bytes that end up constituting the packet; set to zero on error</p>
<p>Returns zero on success; non-zero on error. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a3526c198eba1a1f96e489796fad16ee8_cgraph.png" border="0" usemap="#keystore_8c_a3526c198eba1a1f96e489796fad16ee8_cgraph" alt=""/></div>
<map name="keystore_8c_a3526c198eba1a1f96e489796fad16ee8_cgraph" id="keystore_8c_a3526c198eba1a1f96e489796fad16ee8_cgraph">
<area shape="rect" id="node2" href="ecryptfs_2crypto_8c.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="207,5,338,32"/>
<area shape="rect" id="node3" href="keystore_8c.html#a97cf4aa86d30a50e38ab1f56f014f1bc" title="pki_encrypt_session_key" alt="" coords="188,165,357,192"/>
<area shape="rect" id="node5" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="643,74,793,115"/>
<area shape="rect" id="node17" href="ecryptfs_2debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="205,216,341,243"/>
<area shape="rect" id="node4" href="keystore_8c.html#a98ebf885256c3ac84ee176459d46455c" title="write_tag_66_packet" alt="" coords="425,107,568,133"/>
<area shape="rect" id="node6" href="ecryptfs_2crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="413,158,581,199"/>
<area shape="rect" id="node7" href="messaging_8c.html#a4991d4be187f4947e178b45b1a759d68" title="ecryptfs_send_message" alt="" coords="415,224,579,251"/>
<area shape="rect" id="node13" href="messaging_8c.html#a92e74fb407527dec54a9faba414ea92a" title="ecryptfs_wait_for_response" alt="" coords="405,275,588,301"/>
<area shape="rect" id="node15" href="keystore_8c.html#ae69ad5279272fb61e4b704482e2ba126" title="parse_tag_67_packet" alt="" coords="423,332,570,359"/>
<area shape="rect" id="node8" href="messaging_8c.html#a10730ea01271b89e1dbd74f64cff553f" title="ecryptfs_send_message\l_locked" alt="" coords="636,202,800,243"/>
<area shape="rect" id="node9" href="messaging_8c.html#a89d78e3d4381d564f3f3384901acd3da" title="ecryptfs_find_daemon\l_by_euid" alt="" coords="853,103,1003,145"/>
<area shape="rect" id="node10" href="messaging_8c.html#a3cf131d292b1e79c317132d722ad3bb3" title="ecryptfs_acquire_free\l_msg_ctx" alt="" coords="855,169,1001,210"/>
<area shape="rect" id="node11" href="messaging_8c.html#a4e5308be4f4821f928b20d7469c21267" title="ecryptfs_msg_ctx_free\l_to_alloc" alt="" coords="851,234,1005,275"/>
<area shape="rect" id="node12" href="miscdev_8c.html#a6daf51b4a7c7274ac0e7e7beeeab775d" title="ecryptfs_send_miscdev" alt="" coords="848,300,1008,327"/>
<area shape="rect" id="node14" href="messaging_8c.html#afa5f0c6e4ccfb9753a323ff2c5ae993c" title="ecryptfs_msg_ctx_alloc\l_to_free" alt="" coords="638,267,798,309"/>
<area shape="rect" id="node16" href="keystore_8c.html#a927e62aec0955db0c1a411dac02486e4" title="ecryptfs_parse_packet\l_length" alt="" coords="641,333,795,374"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a3526c198eba1a1f96e489796fad16ee8_icgraph.png" border="0" usemap="#keystore_8c_a3526c198eba1a1f96e489796fad16ee8_icgraph" alt=""/></div>
<map name="keystore_8c_a3526c198eba1a1f96e489796fad16ee8_icgraph" id="keystore_8c_a3526c198eba1a1f96e489796fad16ee8_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="188,35,343,76"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="391,42,573,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="621,42,787,69"/>
<area shape="rect" id="node5" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="835,42,981,69"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1029,5,1148,47"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1033,71,1145,98"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1196,13,1300,39"/>
</map>
</div>

</div>
</div>
<a id="a93f9c9afc806ac6cee810aa85b04f7d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93f9c9afc806ac6cee810aa85b04f7d6">&#9670;&nbsp;</a></span>write_tag_3_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_tag_3_packet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>remaining_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_auth_tok *&#160;</td>
          <td class="paramname"><em>auth_tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__key__record.html">ecryptfs_key_record</a> *&#160;</td>
          <td class="paramname"><em>key_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>write_tag_3_packet : Buffer into which to write the packet : Maximum number of bytes that can be written : Authentication token : The cryptographic context : encrypted key : This function will write the number of bytes that end up constituting the packet; set to zero on error</p>
<p>Returns zero on success; non-zero on error. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a93f9c9afc806ac6cee810aa85b04f7d6_cgraph.png" border="0" usemap="#keystore_8c_a93f9c9afc806ac6cee810aa85b04f7d6_cgraph" alt=""/></div>
<map name="keystore_8c_a93f9c9afc806ac6cee810aa85b04f7d6_cgraph" id="keystore_8c_a93f9c9afc806ac6cee810aa85b04f7d6_cgraph">
<area shape="rect" id="node2" href="ecryptfs_2crypto_8c.html#a53b9fe052c3394cc747e08e884df0926" title="ecryptfs_from_hex" alt="" coords="207,5,337,32"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#ae54bca868720dfaccd8b4817f93fb70a" title="ecryptfs_get_tfm_and\l_mutex_for_cipher_name" alt="" coords="188,57,356,98"/>
<area shape="rect" id="node8" href="ecryptfs_2debug_8c.html#a045879c3d789610d64a216956beeaf09" title="ecryptfs_dump_hex" alt="" coords="204,123,340,149"/>
<area shape="rect" id="node9" href="ecryptfs_2crypto_8c.html#a192ec172108f38b6c893f631d0ed6cc4" title="virt_to_scatterlist" alt="" coords="211,173,333,200"/>
<area shape="rect" id="node10" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="197,225,347,266"/>
<area shape="rect" id="node11" href="ecryptfs_2crypto_8c.html#abac276c0609493e5a5bf8c1c78223877" title="ecryptfs_code_for_cipher\l_string" alt="" coords="188,290,356,331"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a546635bf3080054059b6f8cef79ca4c1" title="ecryptfs_tfm_exists" alt="" coords="427,39,564,65"/>
<area shape="rect" id="node5" href="ecryptfs_2crypto_8c.html#a41519bf356d367a394b8efb980ee6e51" title="ecryptfs_add_new_key_tfm" alt="" coords="404,89,587,116"/>
<area shape="rect" id="node6" href="ecryptfs_2crypto_8c.html#a88557d40f80d1debaac45a30526e9f0e" title="ecryptfs_process_key\l_cipher" alt="" coords="635,82,785,123"/>
<area shape="rect" id="node7" href="ecryptfs_2crypto_8c.html#a5901e51bc8f4d9b71eb0c0692e483b6f" title="ecryptfs_crypto_api\l_algify_cipher_name" alt="" coords="833,82,975,123"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a93f9c9afc806ac6cee810aa85b04f7d6_icgraph.png" border="0" usemap="#keystore_8c_a93f9c9afc806ac6cee810aa85b04f7d6_icgraph" alt=""/></div>
<map name="keystore_8c_a93f9c9afc806ac6cee810aa85b04f7d6_icgraph" id="keystore_8c_a93f9c9afc806ac6cee810aa85b04f7d6_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="188,35,343,76"/>
<area shape="rect" id="node3" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="391,42,573,69"/>
<area shape="rect" id="node4" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="621,42,787,69"/>
<area shape="rect" id="node5" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="835,42,981,69"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1029,5,1148,47"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1033,71,1145,98"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1196,13,1300,39"/>
</map>
</div>

</div>
</div>
<a id="a139436651ca07d4aa32396fbae14d1f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a139436651ca07d4aa32396fbae14d1f9">&#9670;&nbsp;</a></span>write_tag_64_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_tag_64_packet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ecryptfs_session_key *&#160;</td>
          <td class="paramname"><em>session_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a139436651ca07d4aa32396fbae14d1f9_cgraph.png" border="0" usemap="#keystore_8c_a139436651ca07d4aa32396fbae14d1f9_cgraph" alt=""/></div>
<map name="keystore_8c_a139436651ca07d4aa32396fbae14d1f9_cgraph" id="keystore_8c_a139436651ca07d4aa32396fbae14d1f9_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="196,5,347,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a139436651ca07d4aa32396fbae14d1f9_icgraph.png" border="0" usemap="#keystore_8c_a139436651ca07d4aa32396fbae14d1f9_icgraph" alt=""/></div>
<map name="keystore_8c_a139436651ca07d4aa32396fbae14d1f9_icgraph" id="keystore_8c_a139436651ca07d4aa32396fbae14d1f9_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a5cd91ea24b792d9718c66c4f930ef730" title="decrypt_pki_encrypted\l_session_key" alt="" coords="196,35,349,76"/>
<area shape="rect" id="node3" href="keystore_8c.html#a44ad4f9a58b735c6d9891a06df838671" title="ecryptfs_parse_packet_set" alt="" coords="397,42,576,69"/>
<area shape="rect" id="node4" href="ecryptfs_2crypto_8c.html#a1971b0423a0e1cbe741f78712d319b20" title="ecryptfs_read_headers_virt" alt="" coords="624,42,803,69"/>
<area shape="rect" id="node5" href="ecryptfs__kernel_8h.html#a0f476d4db45796bb804042157fbd93fa" title="ecryptfs_read_metadata" alt="" coords="851,42,1013,69"/>
<area shape="rect" id="node6" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1061,5,1180,47"/>
<area shape="rect" id="node8" href="ecryptfs_2inode_8c.html#a34946e5592d6ec37a0d9cedef341291d" title="ecryptfs_setattr" alt="" coords="1064,71,1177,98"/>
<area shape="rect" id="node7" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1228,13,1332,39"/>
</map>
</div>

</div>
</div>
<a id="a98ebf885256c3ac84ee176459d46455c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98ebf885256c3ac84ee176459d46455c">&#9670;&nbsp;</a></span>write_tag_66_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_tag_66_packet </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>cipher_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structecryptfs__crypt__stat.html">ecryptfs_crypt_stat</a> *&#160;</td>
          <td class="paramname"><em>crypt_stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>packet_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a98ebf885256c3ac84ee176459d46455c_cgraph.png" border="0" usemap="#keystore_8c_a98ebf885256c3ac84ee176459d46455c_cgraph" alt=""/></div>
<map name="keystore_8c_a98ebf885256c3ac84ee176459d46455c_cgraph" id="keystore_8c_a98ebf885256c3ac84ee176459d46455c_cgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a58141bba8fe1839782991135894cc340" title="ecryptfs_write_packet\l_length" alt="" coords="196,5,347,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keystore_8c_a98ebf885256c3ac84ee176459d46455c_icgraph.png" border="0" usemap="#keystore_8c_a98ebf885256c3ac84ee176459d46455c_icgraph" alt=""/></div>
<map name="keystore_8c_a98ebf885256c3ac84ee176459d46455c_icgraph" id="keystore_8c_a98ebf885256c3ac84ee176459d46455c_icgraph">
<area shape="rect" id="node2" href="keystore_8c.html#a97cf4aa86d30a50e38ab1f56f014f1bc" title="pki_encrypt_session_key" alt="" coords="196,42,365,69"/>
<area shape="rect" id="node3" href="keystore_8c.html#a3526c198eba1a1f96e489796fad16ee8" title="write_tag_1_packet" alt="" coords="413,42,548,69"/>
<area shape="rect" id="node4" href="keystore_8c.html#aea269faf109dfdfbe811ff5af549c8dc" title="ecryptfs_generate_key\l_packet_set" alt="" coords="596,35,751,76"/>
<area shape="rect" id="node5" href="ecryptfs_2crypto_8c.html#a726219be3d26c0f5d0cd3764aaf1dc10" title="ecryptfs_write_headers_virt" alt="" coords="799,42,981,69"/>
<area shape="rect" id="node6" href="ecryptfs__kernel_8h.html#a42762f9a11a4a605720623e066b37aac" title="ecryptfs_write_metadata" alt="" coords="1029,42,1195,69"/>
<area shape="rect" id="node7" href="ecryptfs_2inode_8c.html#a6bc52bfbdbdae09b52647394d90fdc70" title="ecryptfs_initialize_file" alt="" coords="1243,42,1389,69"/>
<area shape="rect" id="node8" href="ecryptfs_2file_8c.html#a0248e328b772bb8a72ff8db7c316ccc5" title="read_or_initialize\l_metadata" alt="" coords="1437,5,1556,47"/>
<area shape="rect" id="node10" href="ecryptfs_2inode_8c.html#a315185662a49f6919a74605196579f2f" title="ecryptfs_create" alt="" coords="1441,71,1553,98"/>
<area shape="rect" id="node9" href="ecryptfs_2file_8c.html#ab77b53c00f24de64a0fcbb182f043f23" title="ecryptfs_open" alt="" coords="1604,13,1708,39"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7e11b9687c1ed0cc0c32701bb0a93a0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e11b9687c1ed0cc0c32701bb0a93a0e">&#9670;&nbsp;</a></span>ecryptfs_auth_tok_list_item_cache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* ecryptfs_auth_tok_list_item_cache</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a18399523ae392d824f1d15e5cfec19c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18399523ae392d824f1d15e5cfec19c2">&#9670;&nbsp;</a></span>ecryptfs_global_auth_tok_cache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* ecryptfs_global_auth_tok_cache</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3cfeae3a03bede73d490821e4071eb31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cfeae3a03bede73d490821e4071eb31">&#9670;&nbsp;</a></span>ecryptfs_key_record_cache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* ecryptfs_key_record_cache</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acb072438521d5788c4dd4e7832a6bfc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb072438521d5788c4dd4e7832a6bfc6">&#9670;&nbsp;</a></span>ecryptfs_key_sig_cache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kmem_cache* ecryptfs_key_sig_cache</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_583ccf86ea8dcf3a3fea5fb2a2c1dc2f.html">ecryptfs</a></li><li class="navelem"><a class="el" href="keystore_8c.html">keystore.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
