<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linux/fs: cachefiles/internal.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linux/fs
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('cachefiles_2internal_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">internal.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cachefiles_2internal_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* General netfs cache on cache files internal defs</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (C) 2007 Red Hat, Inc. All Rights Reserved.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Written by David Howells (dhowells@redhat.com)</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * modify it under the terms of the GNU General Public Licence</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * as published by the Free Software Foundation; either version</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * 2 of the Licence, or (at your option) any later version.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#ifdef pr_fmt</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#undef pr_fmt</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a1f8c165bf4196327bc3abff648276d92">   16</a></span>&#160;<span class="preprocessor">#define pr_fmt(fmt) &quot;CacheFiles: &quot; fmt</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;linux/fscache-cache.h&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;linux/timer.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;linux/wait_bit.h&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;linux/cred.h&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;linux/workqueue.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;linux/security.h&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">struct </span><a class="code" href="structcachefiles__cache.html">cachefiles_cache</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">struct </span><a class="code" href="structcachefiles__object.html">cachefiles_object</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <a class="code" href="cachefiles_2internal_8h.html#adbc55b27e3b71a72dd8f47bcf6a0d069">cachefiles_debug</a>;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a9b1a1e8990c75f4d39dc6df4ed9ed5c4">   30</a></span>&#160;<span class="preprocessor">#define CACHEFILES_DEBUG_KENTER 1</span></div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#aed3acbc57577863144abd63d18ee5421">   31</a></span>&#160;<span class="preprocessor">#define CACHEFILES_DEBUG_KLEAVE 2</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#aa04554dd3fce529edc53996ff0c0759b">   32</a></span>&#160;<span class="preprocessor">#define CACHEFILES_DEBUG_KDEBUG 4</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a91cfc0836d5c5d859a1ad25beee5b142">   34</a></span>&#160;<span class="preprocessor">#define cachefiles_gfp (__GFP_RECLAIM | __GFP_NORETRY | __GFP_NOMEMALLOC)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * node records</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structcachefiles__object.html">   39</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcachefiles__object.html">cachefiles_object</a> {</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#a2f1d6c52da6a0de8c641c90ad416346a">   40</a></span>&#160;    <span class="keyword">struct </span>fscache_object       <a class="code" href="structcachefiles__object.html#a2f1d6c52da6a0de8c641c90ad416346a">fscache</a>;    <span class="comment">/* fscache handle */</span></div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#a38bef5b6714fdf7c965029b3339f0ff3">   41</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcachefiles__lookup__data.html">cachefiles_lookup_data</a>   *<a class="code" href="structcachefiles__object.html#a38bef5b6714fdf7c965029b3339f0ff3">lookup_data</a>;   <span class="comment">/* cached lookup data */</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">   42</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a>           *<a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a>;    <span class="comment">/* the file/dir representing this object */</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#a9bdb16d242466d647f9cc5bf06f9f364">   43</a></span>&#160;    <span class="keyword">struct </span>dentry           *<a class="code" href="structcachefiles__object.html#a9bdb16d242466d647f9cc5bf06f9f364">backer</a>;    <span class="comment">/* backing file */</span></div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#a1e3a9aa1fbda01d14b9d1f744bb6a6be">   44</a></span>&#160;    loff_t              <a class="code" href="structcachefiles__object.html#a1e3a9aa1fbda01d14b9d1f744bb6a6be">i_size</a>;     <span class="comment">/* object size */</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#a16503bb450546ad63fa05e9435f58346">   45</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           <a class="code" href="structcachefiles__object.html#a16503bb450546ad63fa05e9435f58346">flags</a>;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a611a418e467390935ce3bc241c9b7872">   46</a></span>&#160;<span class="preprocessor">#define CACHEFILES_OBJECT_ACTIVE    0       </span><span class="comment">/* T if marked active */</span><span class="preprocessor"></span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#a43ea45924150e89237303b460d3dd0aa">   47</a></span>&#160;    atomic_t            <a class="code" href="structcachefiles__object.html#a43ea45924150e89237303b460d3dd0aa">usage</a>;      <span class="comment">/* object usage count */</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#ab0b340e51b1438f4e0c129ef4d287946">   48</a></span>&#160;    uint8_t             <a class="code" href="structcachefiles__object.html#ab0b340e51b1438f4e0c129ef4d287946">type</a>;       <span class="comment">/* object type */</span></div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#adbbd45bf7928e49bdaba64e5447548a9">   49</a></span>&#160;    uint8_t             <span class="keyword">new</span>;        <span class="comment">/* T if object new */</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#a880450ce7aaa8efc09a6995d70629847">   50</a></span>&#160;    spinlock_t          <a class="code" href="structcachefiles__object.html#a880450ce7aaa8efc09a6995d70629847">work_lock</a>;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structcachefiles__object.html#a8110c2616fb4281cf7a4c8f65432b535">   51</a></span>&#160;    <span class="keyword">struct </span>rb_node          <a class="code" href="structcachefiles__object.html#a8110c2616fb4281cf7a4c8f65432b535">active_node</a>;    <span class="comment">/* link in active tree (dentry is key) */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;};</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">extern</span> <span class="keyword">struct </span>kmem_cache *<a class="code" href="cachefiles_2internal_8h.html#adb2ccf5548bc2a1e7c7e2dcf7d661ffc">cachefiles_object_jar</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> * Cache files cache definition</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html">   59</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> {</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#aa125e44073a7b8c6917b9b240e58ccb4">   60</a></span>&#160;    <span class="keyword">struct </span>fscache_cache        cache;      <span class="comment">/* FS-Cache record */</span></div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#aeb47301b2537b44facbf55836d98466b">   61</a></span>&#160;    <span class="keyword">struct </span>vfsmount         *<a class="code" href="structcachefiles__cache.html#aeb47301b2537b44facbf55836d98466b">mnt</a>;       <span class="comment">/* mountpoint holding the cache */</span></div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a9d2cd1ae6e189ea0b83ac59ea504f959">   62</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a>           *<a class="code" href="structcachefiles__cache.html#a9d2cd1ae6e189ea0b83ac59ea504f959">graveyard</a>; <span class="comment">/* directory into which dead objects go */</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a51039272f1fadb28ce1aceb5303711da">   63</a></span>&#160;    <span class="keyword">struct </span>file         *<a class="code" href="structcachefiles__cache.html#a51039272f1fadb28ce1aceb5303711da">cachefilesd</a>;   <span class="comment">/* manager daemon handle */</span></div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a37a032c7e3e69165840d4aacbaa4abd3">   64</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span>cred       *<a class="code" href="structcachefiles__cache.html#a37a032c7e3e69165840d4aacbaa4abd3">cache_cred</a>;    <span class="comment">/* security override for accessing cache */</span></div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a02e1d1e7eb613dc402b8b37ad4e7336f">   65</a></span>&#160;    <span class="keyword">struct </span>mutex            daemon_mutex;   <span class="comment">/* command serialisation mutex */</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ac1b4db87d9960c77d5b45535ad9b9993">   66</a></span>&#160;    wait_queue_head_t       <a class="code" href="structcachefiles__cache.html#ac1b4db87d9960c77d5b45535ad9b9993">daemon_pollwq</a>;  <span class="comment">/* poll waitqueue for daemon */</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ad367ab1af922b1ae76c088900b10e6f4">   67</a></span>&#160;    <span class="keyword">struct </span>rb_root          active_nodes;   <span class="comment">/* active nodes (can&#39;t be culled) */</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#aa47a45d045bb3c603d6809d8daaf9fa5">   68</a></span>&#160;    rwlock_t            <a class="code" href="structcachefiles__cache.html#aa47a45d045bb3c603d6809d8daaf9fa5">active_lock</a>;    <span class="comment">/* lock for active_nodes */</span></div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a67ecea89713f8bf01de3e39972654d47">   69</a></span>&#160;    atomic_t            <a class="code" href="structcachefiles__cache.html#a67ecea89713f8bf01de3e39972654d47">gravecounter</a>;   <span class="comment">/* graveyard uniquifier */</span></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a9a86e9d164fcffd23992468447546458">   70</a></span>&#160;    atomic_t            <a class="code" href="structcachefiles__cache.html#a9a86e9d164fcffd23992468447546458">f_released</a>; <span class="comment">/* number of objects released lately */</span></div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ac88a846f70b341537c19f3bf84becd58">   71</a></span>&#160;    atomic_long_t           <a class="code" href="structcachefiles__cache.html#ac88a846f70b341537c19f3bf84becd58">b_released</a>; <span class="comment">/* number of blocks released lately */</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ac6241bd44678d6934c705aa561a4d1c3">   72</a></span>&#160;    <span class="keywordtype">unsigned</span>            <a class="code" href="structcachefiles__cache.html#ac6241bd44678d6934c705aa561a4d1c3">frun_percent</a>;   <span class="comment">/* when to stop culling (% files) */</span></div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a49386329d09c8f03d1517c6192d6e248">   73</a></span>&#160;    <span class="keywordtype">unsigned</span>            <a class="code" href="structcachefiles__cache.html#a49386329d09c8f03d1517c6192d6e248">fcull_percent</a>;  <span class="comment">/* when to start culling (% files) */</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ad6e8f9d2b9fb04170467a6db9e2d4a3a">   74</a></span>&#160;    <span class="keywordtype">unsigned</span>            <a class="code" href="structcachefiles__cache.html#ad6e8f9d2b9fb04170467a6db9e2d4a3a">fstop_percent</a>;  <span class="comment">/* when to stop allocating (% files) */</span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ad365f36a42978d9c8955d9cffe965309">   75</a></span>&#160;    <span class="keywordtype">unsigned</span>            <a class="code" href="structcachefiles__cache.html#ad365f36a42978d9c8955d9cffe965309">brun_percent</a>;   <span class="comment">/* when to stop culling (% blocks) */</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a0ca9f1d131b3c1b13e7145fb28b42cd2">   76</a></span>&#160;    <span class="keywordtype">unsigned</span>            <a class="code" href="structcachefiles__cache.html#a0ca9f1d131b3c1b13e7145fb28b42cd2">bcull_percent</a>;  <span class="comment">/* when to start culling (% blocks) */</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a508c5bff76e7f937600fc711395d42c6">   77</a></span>&#160;    <span class="keywordtype">unsigned</span>            <a class="code" href="structcachefiles__cache.html#a508c5bff76e7f937600fc711395d42c6">bstop_percent</a>;  <span class="comment">/* when to stop allocating (% blocks) */</span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a484e830971c4ae9f4677d07a9dc6c5b0">   78</a></span>&#160;    <span class="keywordtype">unsigned</span>            <a class="code" href="structcachefiles__cache.html#a484e830971c4ae9f4677d07a9dc6c5b0">bsize</a>;      <span class="comment">/* cache&#39;s block size */</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a53f8c1ada28ca44a5001657c317e1480">   79</a></span>&#160;    <span class="keywordtype">unsigned</span>            <a class="code" href="structcachefiles__cache.html#a53f8c1ada28ca44a5001657c317e1480">bshift</a>;     <span class="comment">/* min(ilog2(PAGE_SIZE / bsize), 0) */</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a64f77f9319d793d6f9181d58c8e65b29">   80</a></span>&#160;    uint64_t            <a class="code" href="structcachefiles__cache.html#a64f77f9319d793d6f9181d58c8e65b29">frun</a>;       <span class="comment">/* when to stop culling */</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ac57a23278d66b89063f3818a43c5566a">   81</a></span>&#160;    uint64_t            <a class="code" href="structcachefiles__cache.html#ac57a23278d66b89063f3818a43c5566a">fcull</a>;      <span class="comment">/* when to start culling */</span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#acdd4e6bdae775848b73816372b7e51ac">   82</a></span>&#160;    uint64_t            <a class="code" href="structcachefiles__cache.html#acdd4e6bdae775848b73816372b7e51ac">fstop</a>;      <span class="comment">/* when to stop allocating */</span></div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a0ef3b7d7ef0b5e3f8ee119ac5b34445c">   83</a></span>&#160;    sector_t            <a class="code" href="structcachefiles__cache.html#a0ef3b7d7ef0b5e3f8ee119ac5b34445c">brun</a>;       <span class="comment">/* when to stop culling */</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a11cf736cc604c7b6d44c9d730d46befb">   84</a></span>&#160;    sector_t            <a class="code" href="structcachefiles__cache.html#a11cf736cc604c7b6d44c9d730d46befb">bcull</a>;      <span class="comment">/* when to start culling */</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a80f450f057190291eb5e380146891ea3">   85</a></span>&#160;    sector_t            <a class="code" href="structcachefiles__cache.html#a80f450f057190291eb5e380146891ea3">bstop</a>;      <span class="comment">/* when to stop allocating */</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ad74d9d59adc693b666d28274f7dafc63">   86</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           <a class="code" href="structcachefiles__cache.html#ad74d9d59adc693b666d28274f7dafc63">flags</a>;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#affc0ffeebed2879c02a90ec0d9abbdab">   87</a></span>&#160;<span class="preprocessor">#define CACHEFILES_READY        0   </span><span class="comment">/* T if cache prepared */</span><span class="preprocessor"></span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#ab976207001ad16668a9e619ef99730ed">   88</a></span>&#160;<span class="preprocessor">#define CACHEFILES_DEAD         1   </span><span class="comment">/* T if cache dead */</span><span class="preprocessor"></span></div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a5f5a79d77adff9cc75220d9894acacea">   89</a></span>&#160;<span class="preprocessor">#define CACHEFILES_CULLING      2   </span><span class="comment">/* T if cull engaged */</span><span class="preprocessor"></span></div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a68e70b8d89187c8e4e0a32dc5d7cb1d5">   90</a></span>&#160;<span class="preprocessor">#define CACHEFILES_STATE_CHANGED    3   </span><span class="comment">/* T if state changed (poll trigger) */</span><span class="preprocessor"></span></div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#a5314073481e578d57fac5665a6cb7a8a">   91</a></span>&#160;    <span class="keywordtype">char</span>                *<a class="code" href="structcachefiles__cache.html#a5314073481e578d57fac5665a6cb7a8a">rootdirname</a>;   <span class="comment">/* name of cache root directory */</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#ab5c2da282eaae0b5ae7526bbcf1b6507">   92</a></span>&#160;    <span class="keywordtype">char</span>                *<a class="code" href="structcachefiles__cache.html#ab5c2da282eaae0b5ae7526bbcf1b6507">secctx</a>;    <span class="comment">/* LSM security context */</span></div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structcachefiles__cache.html#adc6a0a7a264761c2e40b85421f085ef8">   93</a></span>&#160;    <span class="keywordtype">char</span>                *<a class="code" href="structcachefiles__cache.html#adc6a0a7a264761c2e40b85421f085ef8">tag</a>;       <span class="comment">/* cache binding tag */</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;};</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> * backing file read tracking</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structcachefiles__one__read.html">   99</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcachefiles__one__read.html">cachefiles_one_read</a> {</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structcachefiles__one__read.html#a11031077d1238346710ee20698672a96">  100</a></span>&#160;    wait_queue_entry_t          <a class="code" href="structcachefiles__one__read.html#a11031077d1238346710ee20698672a96">monitor</a>;    <span class="comment">/* link into monitored waitqueue */</span></div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structcachefiles__one__read.html#aadb9610be2886a02dff551fad39a8c31">  101</a></span>&#160;    <span class="keyword">struct </span>page         *<a class="code" href="structcachefiles__one__read.html#aadb9610be2886a02dff551fad39a8c31">back_page</a>; <span class="comment">/* backing file page we&#39;re waiting for */</span></div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="structcachefiles__one__read.html#a5104de406f43bf43960001a3663ad43a">  102</a></span>&#160;    <span class="keyword">struct </span>page         *<a class="code" href="structcachefiles__one__read.html#a5104de406f43bf43960001a3663ad43a">netfs_page</a>;    <span class="comment">/* netfs page we&#39;re going to fill */</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structcachefiles__one__read.html#a46660eda743caa66f54bc337b4eb2c4d">  103</a></span>&#160;    <span class="keyword">struct </span>fscache_retrieval    *<a class="code" href="structcachefiles__one__read.html#a46660eda743caa66f54bc337b4eb2c4d">op</a>;        <span class="comment">/* retrieval op covering this */</span></div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structcachefiles__one__read.html#a42a9cb76f9b7c38ededb210968521906">  104</a></span>&#160;    <span class="keyword">struct </span>list_head        op_link;    <span class="comment">/* link in op&#39;s todo list */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;};</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> * backing file write tracking</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structcachefiles__one__write.html">  110</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcachefiles__one__write.html">cachefiles_one_write</a> {</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structcachefiles__one__write.html#af1f07fee1a35e98559c94acc224f0e0e">  111</a></span>&#160;    <span class="keyword">struct </span>page         *<a class="code" href="structcachefiles__one__write.html#af1f07fee1a35e98559c94acc224f0e0e">netfs_page</a>;    <span class="comment">/* netfs page to copy */</span></div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structcachefiles__one__write.html#a32aeb4426bead549ffb3c6a48eeedc29">  112</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcachefiles__object.html">cachefiles_object</a>    *<a class="code" href="structcachefiles__one__write.html#a32aeb4426bead549ffb3c6a48eeedc29">object</a>;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structcachefiles__one__write.html#ab5b5a44d1e893ff48596a974d91aaead">  113</a></span>&#160;    <span class="keyword">struct </span>list_head        obj_link;   <span class="comment">/* link in object&#39;s lists */</span></div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structcachefiles__one__write.html#a166aadf7e835597baa4f155f8de4c38b">  114</a></span>&#160;    fscache_rw_complete_t       <a class="code" href="structcachefiles__one__write.html#a166aadf7e835597baa4f155f8de4c38b">end_io_func</a>;</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structcachefiles__one__write.html#a3ec05da03d615beca2121fb0ec9b4227">  115</a></span>&#160;    <span class="keywordtype">void</span>                *<a class="code" href="structcachefiles__one__write.html#a3ec05da03d615beca2121fb0ec9b4227">context</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;};</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> * auxiliary data xattr buffer</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="structcachefiles__xattr.html">  121</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcachefiles__xattr.html">cachefiles_xattr</a> {</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structcachefiles__xattr.html#a6ee4e0b0e7ea01784cd83243917c032e">  122</a></span>&#160;    uint16_t            <a class="code" href="structcachefiles__xattr.html#a6ee4e0b0e7ea01784cd83243917c032e">len</a>;</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structcachefiles__xattr.html#ac6660feac8ec1da47bcb02afa398416c">  123</a></span>&#160;    uint8_t             <a class="code" href="structcachefiles__xattr.html#ac6660feac8ec1da47bcb02afa398416c">type</a>;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structcachefiles__xattr.html#abdb263b53851987bc8e097e5f7dc016d">  124</a></span>&#160;    uint8_t             <a class="code" href="cifspdu_8h.html#aaa61af584164f982573a6890174ef943">data</a>[];</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;};</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#include &lt;trace/events/cachefiles.h&gt;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> * note change of state for daemon</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a0752ef602fe821eb83ee8fd1218f39c9">  132</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cachefiles_2internal_8h.html#a0752ef602fe821eb83ee8fd1218f39c9">cachefiles_state_changed</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    set_bit(<a class="code" href="cachefiles_2internal_8h.html#a68e70b8d89187c8e4e0a32dc5d7cb1d5">CACHEFILES_STATE_CHANGED</a>, &amp;cache-&gt;<a class="code" href="structcachefiles__cache.html#ad74d9d59adc693b666d28274f7dafc63">flags</a>);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    wake_up_all(&amp;cache-&gt;<a class="code" href="structcachefiles__cache.html#ac1b4db87d9960c77d5b45535ad9b9993">daemon_pollwq</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> * bind.c</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#ad855c7d800f5e88a84f826170bc3baf6">cachefiles_daemon_bind</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache, <span class="keywordtype">char</span> *args);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="cachefiles_2internal_8h.html#a76e751cd300bbc33258d1f7af2c3f2d1">cachefiles_daemon_unbind</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> * daemon.c</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span>file_operations <a class="code" href="cachefiles_2internal_8h.html#aa058a3a3188d63990599795fe78dfad8">cachefiles_daemon_fops</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a824376f681102f3ba28b537486e5b4b9">cachefiles_has_space</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="keywordtype">unsigned</span> fnr, <span class="keywordtype">unsigned</span> bnr);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> * interface.c</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span>fscache_cache_ops <a class="code" href="cachefiles_2internal_8h.html#a83db9fe15971802d59054f7a6eefc38e">cachefiles_cache_ops</a>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> * key.c</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="cachefiles_2internal_8h.html#a58d33fa2b9b7d73c007da08b45c32412">cachefiles_cook_key</a>(<span class="keyword">const</span> u8 *raw, <span class="keywordtype">int</span> keylen, uint8_t <a class="code" href="structcachefiles__object.html#ab0b340e51b1438f4e0c129ef4d287946">type</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> * namei.c</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="cachefiles_2internal_8h.html#acf3ab3e53fc0c9258697087347b8f906">cachefiles_mark_object_inactive</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                        <span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *<span class="keywordtype">object</span>,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        blkcnt_t i_blocks);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a5f0f418a446b15f42ac869ba23e867b7">cachefiles_delete_object</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *<span class="keywordtype">object</span>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a7e43126fd60d2e219e5a4f736579ed2e">cachefiles_walk_to_object</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *parent,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                     <span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *<span class="keywordtype">object</span>,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ctree_8h.html#aa668e7809c8e0ee68dd5049ead875006">key</a>,</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                     <span class="keyword">struct</span> <a class="code" href="structcachefiles__xattr.html">cachefiles_xattr</a> *auxdata);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a> *<a class="code" href="cachefiles_2internal_8h.html#acaeee48a67e31e4c2be1ff395a0582a9">cachefiles_get_directory</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                           <span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a> *dir,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cifspdu_8h.html#a4a06ef9aaffd2c58a6d395fd433cde26">name</a>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#ae1a459e7a4c8345093482132a17bae64">cachefiles_cull</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache, <span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a> *dir,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;               <span class="keywordtype">char</span> *filename);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a8e13b52427e6eb465858de13b46e48f3">cachefiles_check_in_use</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                   <span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a> *dir, <span class="keywordtype">char</span> *filename);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> * proc.c</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#ifdef CONFIG_CACHEFILES_HISTOGRAM</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keyword">extern</span> atomic_t <a class="code" href="cachefiles_2proc_8c.html#a8204573dabe6a78f4e6ecdf44e4e54a2">cachefiles_lookup_histogram</a>[HZ];</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keyword">extern</span> atomic_t <a class="code" href="cachefiles_2proc_8c.html#affc7f4caeede8c5d479bd8aab269bb26">cachefiles_mkdir_histogram</a>[HZ];</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keyword">extern</span> atomic_t <a class="code" href="cachefiles_2proc_8c.html#a406f0a754d0a9985adb45f313fe583b0">cachefiles_create_histogram</a>[HZ];</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> __init <a class="code" href="cachefiles_2internal_8h.html#a79cf06434dee215cd21c463d02007013">cachefiles_proc_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="cachefiles_2internal_8h.html#a0367f7859089f0ef1cc2d1ba5c522d47">cachefiles_proc_cleanup</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">void</span> <a class="code" href="cachefiles_2internal_8h.html#ad4961987b63019ddf388b195946345cd">cachefiles_hist</a>(atomic_t histogram[], <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> start_jif)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jif = jiffies - start_jif;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (jif &gt;= HZ)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        jif = HZ - 1;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    atomic_inc(&amp;histogram[jif]);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a79cf06434dee215cd21c463d02007013">  204</a></span>&#160;<span class="preprocessor">#define cachefiles_proc_init()      (0)</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a0367f7859089f0ef1cc2d1ba5c522d47">  205</a></span>&#160;<span class="preprocessor">#define cachefiles_proc_cleanup()   do {} while (0)</span></div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#ad4961987b63019ddf388b195946345cd">  206</a></span>&#160;<span class="preprocessor">#define cachefiles_hist(hist, start_jif) do {} while (0)</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * rdwr.c</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a3980898429c8f49aaadd059334da4d17">cachefiles_read_or_alloc_page</a>(<span class="keyword">struct</span> fscache_retrieval *,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                     <span class="keyword">struct</span> page *, gfp_t);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a0db804a519f98f7cff21777cb772624b">cachefiles_read_or_alloc_pages</a>(<span class="keyword">struct</span> fscache_retrieval *,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                      <span class="keyword">struct</span> list_head *, <span class="keywordtype">unsigned</span> *,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                      gfp_t);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#ae73c3bfca6a26fae836a4dfa91fac35d">cachefiles_allocate_page</a>(<span class="keyword">struct</span> fscache_retrieval *, <span class="keyword">struct</span> page *,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    gfp_t);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a3a64ef738bf9c69b0d41b206cf4d4539">cachefiles_allocate_pages</a>(<span class="keyword">struct</span> fscache_retrieval *,</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                     <span class="keyword">struct</span> list_head *, <span class="keywordtype">unsigned</span> *, gfp_t);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a9419cb3bd725ec2b5988af1cb27af65d">cachefiles_write_page</a>(<span class="keyword">struct</span> fscache_storage *, <span class="keyword">struct</span> page *);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="cachefiles_2internal_8h.html#aed48b8108858c76305c9ec45d6e08204">cachefiles_uncache_page</a>(<span class="keyword">struct</span> fscache_object *, <span class="keyword">struct</span> page *);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> * security.c</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#adcf3ddd409e3d98864071a9ac0ef00c3">cachefiles_get_security_ID</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a84b639d224854f96ab106da06ac6b4a7">cachefiles_determine_cache_security</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                           <span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a> *<a class="code" href="ctree_8h.html#a3cfd2c1908c7a280340fc7ee887a88a8">root</a>,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                           <span class="keyword">const</span> <span class="keyword">struct</span> cred **_saved_cred);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#af782ed4df8059692e441d92302e58bf0">  232</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cachefiles_2internal_8h.html#af782ed4df8059692e441d92302e58bf0">cachefiles_begin_secure</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                       <span class="keyword">const</span> <span class="keyword">struct</span> cred **_saved_cred)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;{</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    *_saved_cred = override_creds(cache-&gt;<a class="code" href="structcachefiles__cache.html#a37a032c7e3e69165840d4aacbaa4abd3">cache_cred</a>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a8deb0c32f3918f943383fb1481a7524e">  238</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cachefiles_2internal_8h.html#a8deb0c32f3918f943383fb1481a7524e">cachefiles_end_secure</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                     <span class="keyword">const</span> <span class="keyword">struct</span> cred *saved_cred)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;{</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    revert_creds(saved_cred);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"> * xattr.c</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a11d40486ca08a4854bf101e6fc020694">cachefiles_check_object_type</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *<span class="keywordtype">object</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a5ce9d761b7a61df4a2c95e643b9a31ce">cachefiles_set_object_xattr</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *<span class="keywordtype">object</span>,</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                       <span class="keyword">struct</span> <a class="code" href="structcachefiles__xattr.html">cachefiles_xattr</a> *auxdata);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a1af392b6d985e4abb3310281ebf93476">cachefiles_update_object_xattr</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *<span class="keywordtype">object</span>,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                      <span class="keyword">struct</span> <a class="code" href="structcachefiles__xattr.html">cachefiles_xattr</a> *auxdata);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#af6a044d2b4c01d7edca4621cbd8c8b93">cachefiles_check_auxdata</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *<span class="keywordtype">object</span>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a512e064d12ae2cb5cd1d7a065c7ad2de">cachefiles_check_object_xattr</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html">cachefiles_object</a> *<span class="keywordtype">object</span>,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                     <span class="keyword">struct</span> <a class="code" href="structcachefiles__xattr.html">cachefiles_xattr</a> *auxdata);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cachefiles_2internal_8h.html#a2eada56bc78b2ff3b90c90012c003297">cachefiles_remove_object_xattr</a>(<span class="keyword">struct</span> <a class="code" href="structcachefiles__cache.html">cachefiles_cache</a> *cache,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                      <span class="keyword">struct</span> <a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a> *<a class="code" href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">dentry</a>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> * error handling</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#ad71db6f1349f2c09f7085335da805d9c">  263</a></span>&#160;<span class="preprocessor">#define cachefiles_io_error(___cache, FMT, ...)     \</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">do {                            \</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">    pr_err(&quot;I/O Error: &quot; FMT&quot;\n&quot;, ##__VA_ARGS__);   \</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">    fscache_io_error(&amp;(___cache)-&gt;cache);       \</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">    set_bit(CACHEFILES_DEAD, &amp;(___cache)-&gt;flags);   \</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#acb6ba339812dac07affdc299f8f4e9b2">  270</a></span>&#160;<span class="preprocessor">#define cachefiles_io_error_obj(object, FMT, ...)           \</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">do {                                    \</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">    struct cachefiles_cache *___cache;              \</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">                                    \</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor">    ___cache = container_of((object)-&gt;fscache.cache,        \</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">                struct cachefiles_cache, cache);    \</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">    cachefiles_io_error(___cache, FMT, ##__VA_ARGS__);      \</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"> * debug tracing</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#ad392638b9e2a27895d0a362ca7744fda">  283</a></span>&#160;<span class="preprocessor">#define dbgprintk(FMT, ...) \</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">    printk(KERN_DEBUG &quot;[%-6.6s] &quot;FMT&quot;\n&quot;, current-&gt;comm, ##__VA_ARGS__)</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a70d9776e0d53d3259872eb7de79e2e41">  286</a></span>&#160;<span class="preprocessor">#define kenter(FMT, ...) dbgprintk(&quot;==&gt; %s(&quot;FMT&quot;)&quot;, __func__, ##__VA_ARGS__)</span></div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a9beeaf028917167b0aa79e51e9faaeba">  287</a></span>&#160;<span class="preprocessor">#define kleave(FMT, ...) dbgprintk(&quot;&lt;== %s()&quot;FMT&quot;&quot;, __func__, ##__VA_ARGS__)</span></div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a571a1949a30d9b64d4684bf44b077903">  288</a></span>&#160;<span class="preprocessor">#define kdebug(FMT, ...) dbgprintk(FMT, ##__VA_ARGS__)</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">#if defined(__KDEBUG)</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">#define _enter(FMT, ...) kenter(FMT, ##__VA_ARGS__)</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">#define _leave(FMT, ...) kleave(FMT, ##__VA_ARGS__)</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">#define _debug(FMT, ...) kdebug(FMT, ##__VA_ARGS__)</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">#elif defined(CONFIG_CACHEFILES_DEBUG)</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#define _enter(FMT, ...)                \</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">do {                            \</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">    if (cachefiles_debug &amp; CACHEFILES_DEBUG_KENTER) \</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">        kenter(FMT, ##__VA_ARGS__);     \</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#define _leave(FMT, ...)                \</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor">do {                            \</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">    if (cachefiles_debug &amp; CACHEFILES_DEBUG_KLEAVE) \</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">        kleave(FMT, ##__VA_ARGS__);     \</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#define _debug(FMT, ...)                \</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="preprocessor">do {                            \</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">    if (cachefiles_debug &amp; CACHEFILES_DEBUG_KDEBUG) \</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">        kdebug(FMT, ##__VA_ARGS__);     \</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a922399752b87f5e3eaaf020fcb924cda">  316</a></span>&#160;<span class="preprocessor">#define _enter(FMT, ...) no_printk(&quot;==&gt; %s(&quot;FMT&quot;)&quot;, __func__, ##__VA_ARGS__)</span></div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#aa1875f823a8f4b7dcca0d472854bccae">  317</a></span>&#160;<span class="preprocessor">#define _leave(FMT, ...) no_printk(&quot;&lt;== %s()&quot;FMT&quot;&quot;, __func__, ##__VA_ARGS__)</span></div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#ae51392f73e9c164547c624ef5b9767f2">  318</a></span>&#160;<span class="preprocessor">#define _debug(FMT, ...) no_printk(FMT, ##__VA_ARGS__)</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">#if 1 </span><span class="comment">/* defined(__KDEBUGALL) */</span><span class="preprocessor"></span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#ad014a2a071494bbabc34b48eeebadbf3">  323</a></span>&#160;<span class="preprocessor">#define ASSERT(X)                           \</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor">do {                                    \</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">    if (unlikely(!(X))) {                       \</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">        pr_err(&quot;\n&quot;);                       \</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">        pr_err(&quot;Assertion failed\n&quot;);       \</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">        BUG();                          \</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">    }                               \</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a106c18335d526708d0d0cd42c2a00471">  332</a></span>&#160;<span class="preprocessor">#define ASSERTCMP(X, OP, Y)                     \</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">do {                                    \</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">    if (unlikely(!((X) OP (Y)))) {                  \</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">        pr_err(&quot;\n&quot;);                       \</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="preprocessor">        pr_err(&quot;Assertion failed\n&quot;);       \</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="preprocessor">        pr_err(&quot;%lx &quot; #OP &quot; %lx is false\n&quot;,            \</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">               (unsigned long)(X), (unsigned long)(Y));     \</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">        BUG();                          \</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">    }                               \</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#ab30e15040afbfc2d0d16082ec3d6a49d">  343</a></span>&#160;<span class="preprocessor">#define ASSERTIF(C, X)                          \</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">do {                                    \</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">    if (unlikely((C) &amp;&amp; !(X))) {                    \</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">        pr_err(&quot;\n&quot;);                       \</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">        pr_err(&quot;Assertion failed\n&quot;);       \</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">        BUG();                          \</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">    }                               \</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="cachefiles_2internal_8h.html#a71d1c19456ca037c8149e0ebb21193e2">  352</a></span>&#160;<span class="preprocessor">#define ASSERTIFCMP(C, X, OP, Y)                    \</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">do {                                    \</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="preprocessor">    if (unlikely((C) &amp;&amp; !((X) OP (Y)))) {               \</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">        pr_err(&quot;\n&quot;);                       \</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">        pr_err(&quot;Assertion failed\n&quot;);       \</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">        pr_err(&quot;%lx &quot; #OP &quot; %lx is false\n&quot;,            \</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor">               (unsigned long)(X), (unsigned long)(Y));     \</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">        BUG();                          \</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">    }                               \</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">} while (0)</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">#define ASSERT(X)           do {} while (0)</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">#define ASSERTCMP(X, OP, Y)     do {} while (0)</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">#define ASSERTIF(C, X)          do {} while (0)</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#define ASSERTIFCMP(C, X, OP, Y)    do {} while (0)</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="cachefiles_2internal_8h_html_acaeee48a67e31e4c2be1ff395a0582a9"><div class="ttname"><a href="cachefiles_2internal_8h.html#acaeee48a67e31e4c2be1ff395a0582a9">cachefiles_get_directory</a></div><div class="ttdeci">struct dentry * cachefiles_get_directory(struct cachefiles_cache *cache, struct dentry *dir, const char *name)</div><div class="ttdef"><b>Definition:</b> namei.c:758</div></div>
<div class="ttc" id="structcachefiles__cache_html_a5314073481e578d57fac5665a6cb7a8a"><div class="ttname"><a href="structcachefiles__cache.html#a5314073481e578d57fac5665a6cb7a8a">cachefiles_cache::rootdirname</a></div><div class="ttdeci">char * rootdirname</div><div class="ttdef"><b>Definition:</b> internal.h:91</div></div>
<div class="ttc" id="structcachefiles__cache_html_a51039272f1fadb28ce1aceb5303711da"><div class="ttname"><a href="structcachefiles__cache.html#a51039272f1fadb28ce1aceb5303711da">cachefiles_cache::cachefilesd</a></div><div class="ttdeci">struct file * cachefilesd</div><div class="ttdef"><b>Definition:</b> internal.h:63</div></div>
<div class="ttc" id="structcachefiles__one__write_html_a166aadf7e835597baa4f155f8de4c38b"><div class="ttname"><a href="structcachefiles__one__write.html#a166aadf7e835597baa4f155f8de4c38b">cachefiles_one_write::end_io_func</a></div><div class="ttdeci">fscache_rw_complete_t end_io_func</div><div class="ttdef"><b>Definition:</b> internal.h:114</div></div>
<div class="ttc" id="structcachefiles__one__read_html_a11031077d1238346710ee20698672a96"><div class="ttname"><a href="structcachefiles__one__read.html#a11031077d1238346710ee20698672a96">cachefiles_one_read::monitor</a></div><div class="ttdeci">wait_queue_entry_t monitor</div><div class="ttdef"><b>Definition:</b> internal.h:100</div></div>
<div class="ttc" id="structcachefiles__cache_html_a9d2cd1ae6e189ea0b83ac59ea504f959"><div class="ttname"><a href="structcachefiles__cache.html#a9d2cd1ae6e189ea0b83ac59ea504f959">cachefiles_cache::graveyard</a></div><div class="ttdeci">struct dentry * graveyard</div><div class="ttdef"><b>Definition:</b> internal.h:62</div></div>
<div class="ttc" id="structcachefiles__cache_html_ad365f36a42978d9c8955d9cffe965309"><div class="ttname"><a href="structcachefiles__cache.html#ad365f36a42978d9c8955d9cffe965309">cachefiles_cache::brun_percent</a></div><div class="ttdeci">unsigned brun_percent</div><div class="ttdef"><b>Definition:</b> internal.h:75</div></div>
<div class="ttc" id="structcachefiles__object_html_a9bdb16d242466d647f9cc5bf06f9f364"><div class="ttname"><a href="structcachefiles__object.html#a9bdb16d242466d647f9cc5bf06f9f364">cachefiles_object::backer</a></div><div class="ttdeci">struct dentry * backer</div><div class="ttdef"><b>Definition:</b> internal.h:43</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a76e751cd300bbc33258d1f7af2c3f2d1"><div class="ttname"><a href="cachefiles_2internal_8h.html#a76e751cd300bbc33258d1f7af2c3f2d1">cachefiles_daemon_unbind</a></div><div class="ttdeci">void cachefiles_daemon_unbind(struct cachefiles_cache *cache)</div><div class="ttdef"><b>Definition:</b> bind.c:258</div></div>
<div class="ttc" id="structcachefiles__cache_html_a49386329d09c8f03d1517c6192d6e248"><div class="ttname"><a href="structcachefiles__cache.html#a49386329d09c8f03d1517c6192d6e248">cachefiles_cache::fcull_percent</a></div><div class="ttdeci">unsigned fcull_percent</div><div class="ttdef"><b>Definition:</b> internal.h:73</div></div>
<div class="ttc" id="structcachefiles__xattr_html_a6ee4e0b0e7ea01784cd83243917c032e"><div class="ttname"><a href="structcachefiles__xattr.html#a6ee4e0b0e7ea01784cd83243917c032e">cachefiles_xattr::len</a></div><div class="ttdeci">uint16_t len</div><div class="ttdef"><b>Definition:</b> internal.h:122</div></div>
<div class="ttc" id="structcachefiles__cache_html_a80f450f057190291eb5e380146891ea3"><div class="ttname"><a href="structcachefiles__cache.html#a80f450f057190291eb5e380146891ea3">cachefiles_cache::bstop</a></div><div class="ttdeci">sector_t bstop</div><div class="ttdef"><b>Definition:</b> internal.h:85</div></div>
<div class="ttc" id="structcachefiles__lookup__data_html"><div class="ttname"><a href="structcachefiles__lookup__data.html">cachefiles_lookup_data</a></div><div class="ttdef"><b>Definition:</b> interface.c:16</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a3a64ef738bf9c69b0d41b206cf4d4539"><div class="ttname"><a href="cachefiles_2internal_8h.html#a3a64ef738bf9c69b0d41b206cf4d4539">cachefiles_allocate_pages</a></div><div class="ttdeci">int cachefiles_allocate_pages(struct fscache_retrieval *, struct list_head *, unsigned *, gfp_t)</div><div class="ttdef"><b>Definition:</b> rdwr.c:825</div></div>
<div class="ttc" id="structcachefiles__cache_html_ad74d9d59adc693b666d28274f7dafc63"><div class="ttname"><a href="structcachefiles__cache.html#ad74d9d59adc693b666d28274f7dafc63">cachefiles_cache::flags</a></div><div class="ttdeci">unsigned long flags</div><div class="ttdef"><b>Definition:</b> internal.h:86</div></div>
<div class="ttc" id="ctree_8h_html_a3cfd2c1908c7a280340fc7ee887a88a8"><div class="ttname"><a href="ctree_8h.html#a3cfd2c1908c7a280340fc7ee887a88a8">root</a></div><div class="ttdeci">__le64 root</div><div class="ttdef"><b>Definition:</b> ctree.h:114</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_ad4961987b63019ddf388b195946345cd"><div class="ttname"><a href="cachefiles_2internal_8h.html#ad4961987b63019ddf388b195946345cd">cachefiles_hist</a></div><div class="ttdeci">#define cachefiles_hist(hist, start_jif)</div><div class="ttdef"><b>Definition:</b> internal.h:206</div></div>
<div class="ttc" id="structcachefiles__one__read_html_aadb9610be2886a02dff551fad39a8c31"><div class="ttname"><a href="structcachefiles__one__read.html#aadb9610be2886a02dff551fad39a8c31">cachefiles_one_read::back_page</a></div><div class="ttdeci">struct page * back_page</div><div class="ttdef"><b>Definition:</b> internal.h:101</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a5ce9d761b7a61df4a2c95e643b9a31ce"><div class="ttname"><a href="cachefiles_2internal_8h.html#a5ce9d761b7a61df4a2c95e643b9a31ce">cachefiles_set_object_xattr</a></div><div class="ttdeci">int cachefiles_set_object_xattr(struct cachefiles_object *object, struct cachefiles_xattr *auxdata)</div><div class="ttdef"><b>Definition:</b> xattr.c:103</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_adb2ccf5548bc2a1e7c7e2dcf7d661ffc"><div class="ttname"><a href="cachefiles_2internal_8h.html#adb2ccf5548bc2a1e7c7e2dcf7d661ffc">cachefiles_object_jar</a></div><div class="ttdeci">struct kmem_cache * cachefiles_object_jar</div><div class="ttdef"><b>Definition:</b> main.c:36</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a83db9fe15971802d59054f7a6eefc38e"><div class="ttname"><a href="cachefiles_2internal_8h.html#a83db9fe15971802d59054f7a6eefc38e">cachefiles_cache_ops</a></div><div class="ttdeci">const struct fscache_cache_ops cachefiles_cache_ops</div><div class="ttdef"><b>Definition:</b> interface.c:555</div></div>
<div class="ttc" id="cachefiles_2proc_8c_html_a8204573dabe6a78f4e6ecdf44e4e54a2"><div class="ttname"><a href="cachefiles_2proc_8c.html#a8204573dabe6a78f4e6ecdf44e4e54a2">cachefiles_lookup_histogram</a></div><div class="ttdeci">atomic_t cachefiles_lookup_histogram[HZ]</div><div class="ttdef"><b>Definition:</b> proc.c:17</div></div>
<div class="ttc" id="structcachefiles__one__read_html_a46660eda743caa66f54bc337b4eb2c4d"><div class="ttname"><a href="structcachefiles__one__read.html#a46660eda743caa66f54bc337b4eb2c4d">cachefiles_one_read::op</a></div><div class="ttdeci">struct fscache_retrieval * op</div><div class="ttdef"><b>Definition:</b> internal.h:103</div></div>
<div class="ttc" id="structcachefiles__cache_html_ac1b4db87d9960c77d5b45535ad9b9993"><div class="ttname"><a href="structcachefiles__cache.html#ac1b4db87d9960c77d5b45535ad9b9993">cachefiles_cache::daemon_pollwq</a></div><div class="ttdeci">wait_queue_head_t daemon_pollwq</div><div class="ttdef"><b>Definition:</b> internal.h:66</div></div>
<div class="ttc" id="structcachefiles__object_html_ab0b340e51b1438f4e0c129ef4d287946"><div class="ttname"><a href="structcachefiles__object.html#ab0b340e51b1438f4e0c129ef4d287946">cachefiles_object::type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition:</b> internal.h:48</div></div>
<div class="ttc" id="structcachefiles__object_html_adfeb19e26cdc3d7d243cd00a2492480f"><div class="ttname"><a href="structcachefiles__object.html#adfeb19e26cdc3d7d243cd00a2492480f">cachefiles_object::dentry</a></div><div class="ttdeci">struct dentry * dentry</div><div class="ttdef"><b>Definition:</b> internal.h:42</div></div>
<div class="ttc" id="structcachefiles__one__write_html"><div class="ttname"><a href="structcachefiles__one__write.html">cachefiles_one_write</a></div><div class="ttdef"><b>Definition:</b> internal.h:110</div></div>
<div class="ttc" id="structcachefiles__one__read_html_a5104de406f43bf43960001a3663ad43a"><div class="ttname"><a href="structcachefiles__one__read.html#a5104de406f43bf43960001a3663ad43a">cachefiles_one_read::netfs_page</a></div><div class="ttdeci">struct page * netfs_page</div><div class="ttdef"><b>Definition:</b> internal.h:102</div></div>
<div class="ttc" id="structcachefiles__cache_html_ac88a846f70b341537c19f3bf84becd58"><div class="ttname"><a href="structcachefiles__cache.html#ac88a846f70b341537c19f3bf84becd58">cachefiles_cache::b_released</a></div><div class="ttdeci">atomic_long_t b_released</div><div class="ttdef"><b>Definition:</b> internal.h:71</div></div>
<div class="ttc" id="structcachefiles__object_html_a43ea45924150e89237303b460d3dd0aa"><div class="ttname"><a href="structcachefiles__object.html#a43ea45924150e89237303b460d3dd0aa">cachefiles_object::usage</a></div><div class="ttdeci">atomic_t usage</div><div class="ttdef"><b>Definition:</b> internal.h:47</div></div>
<div class="ttc" id="structcachefiles__cache_html"><div class="ttname"><a href="structcachefiles__cache.html">cachefiles_cache</a></div><div class="ttdef"><b>Definition:</b> internal.h:59</div></div>
<div class="ttc" id="structcachefiles__cache_html_a67ecea89713f8bf01de3e39972654d47"><div class="ttname"><a href="structcachefiles__cache.html#a67ecea89713f8bf01de3e39972654d47">cachefiles_cache::gravecounter</a></div><div class="ttdeci">atomic_t gravecounter</div><div class="ttdef"><b>Definition:</b> internal.h:69</div></div>
<div class="ttc" id="structcachefiles__object_html"><div class="ttname"><a href="structcachefiles__object.html">cachefiles_object</a></div><div class="ttdef"><b>Definition:</b> internal.h:39</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a8deb0c32f3918f943383fb1481a7524e"><div class="ttname"><a href="cachefiles_2internal_8h.html#a8deb0c32f3918f943383fb1481a7524e">cachefiles_end_secure</a></div><div class="ttdeci">static void cachefiles_end_secure(struct cachefiles_cache *cache, const struct cred *saved_cred)</div><div class="ttdef"><b>Definition:</b> internal.h:238</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a0db804a519f98f7cff21777cb772624b"><div class="ttname"><a href="cachefiles_2internal_8h.html#a0db804a519f98f7cff21777cb772624b">cachefiles_read_or_alloc_pages</a></div><div class="ttdeci">int cachefiles_read_or_alloc_pages(struct fscache_retrieval *, struct list_head *, unsigned *, gfp_t)</div><div class="ttdef"><b>Definition:</b> rdwr.c:673</div></div>
<div class="ttc" id="structcachefiles__cache_html_a508c5bff76e7f937600fc711395d42c6"><div class="ttname"><a href="structcachefiles__cache.html#a508c5bff76e7f937600fc711395d42c6">cachefiles_cache::bstop_percent</a></div><div class="ttdeci">unsigned bstop_percent</div><div class="ttdef"><b>Definition:</b> internal.h:77</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a1af392b6d985e4abb3310281ebf93476"><div class="ttname"><a href="cachefiles_2internal_8h.html#a1af392b6d985e4abb3310281ebf93476">cachefiles_update_object_xattr</a></div><div class="ttdeci">int cachefiles_update_object_xattr(struct cachefiles_object *object, struct cachefiles_xattr *auxdata)</div><div class="ttdef"><b>Definition:</b> xattr.c:132</div></div>
<div class="ttc" id="structcachefiles__one__write_html_a32aeb4426bead549ffb3c6a48eeedc29"><div class="ttname"><a href="structcachefiles__one__write.html#a32aeb4426bead549ffb3c6a48eeedc29">cachefiles_one_write::object</a></div><div class="ttdeci">struct cachefiles_object * object</div><div class="ttdef"><b>Definition:</b> internal.h:112</div></div>
<div class="ttc" id="structcachefiles__cache_html_ac57a23278d66b89063f3818a43c5566a"><div class="ttname"><a href="structcachefiles__cache.html#ac57a23278d66b89063f3818a43c5566a">cachefiles_cache::fcull</a></div><div class="ttdeci">uint64_t fcull</div><div class="ttdef"><b>Definition:</b> internal.h:81</div></div>
<div class="ttc" id="structcachefiles__cache_html_acdd4e6bdae775848b73816372b7e51ac"><div class="ttname"><a href="structcachefiles__cache.html#acdd4e6bdae775848b73816372b7e51ac">cachefiles_cache::fstop</a></div><div class="ttdeci">uint64_t fstop</div><div class="ttdef"><b>Definition:</b> internal.h:82</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a2eada56bc78b2ff3b90c90012c003297"><div class="ttname"><a href="cachefiles_2internal_8h.html#a2eada56bc78b2ff3b90c90012c003297">cachefiles_remove_object_xattr</a></div><div class="ttdeci">int cachefiles_remove_object_xattr(struct cachefiles_cache *cache, struct dentry *dentry)</div><div class="ttdef"><b>Definition:</b> xattr.c:310</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a79cf06434dee215cd21c463d02007013"><div class="ttname"><a href="cachefiles_2internal_8h.html#a79cf06434dee215cd21c463d02007013">cachefiles_proc_init</a></div><div class="ttdeci">#define cachefiles_proc_init()</div><div class="ttdef"><b>Definition:</b> internal.h:204</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a68e70b8d89187c8e4e0a32dc5d7cb1d5"><div class="ttname"><a href="cachefiles_2internal_8h.html#a68e70b8d89187c8e4e0a32dc5d7cb1d5">CACHEFILES_STATE_CHANGED</a></div><div class="ttdeci">#define CACHEFILES_STATE_CHANGED</div><div class="ttdef"><b>Definition:</b> internal.h:90</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a7e43126fd60d2e219e5a4f736579ed2e"><div class="ttname"><a href="cachefiles_2internal_8h.html#a7e43126fd60d2e219e5a4f736579ed2e">cachefiles_walk_to_object</a></div><div class="ttdeci">int cachefiles_walk_to_object(struct cachefiles_object *parent, struct cachefiles_object *object, const char *key, struct cachefiles_xattr *auxdata)</div><div class="ttdef"><b>Definition:</b> namei.c:486</div></div>
<div class="ttc" id="structcachefiles__cache_html_ac6241bd44678d6934c705aa561a4d1c3"><div class="ttname"><a href="structcachefiles__cache.html#ac6241bd44678d6934c705aa561a4d1c3">cachefiles_cache::frun_percent</a></div><div class="ttdeci">unsigned frun_percent</div><div class="ttdef"><b>Definition:</b> internal.h:72</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a0367f7859089f0ef1cc2d1ba5c522d47"><div class="ttname"><a href="cachefiles_2internal_8h.html#a0367f7859089f0ef1cc2d1ba5c522d47">cachefiles_proc_cleanup</a></div><div class="ttdeci">#define cachefiles_proc_cleanup()</div><div class="ttdef"><b>Definition:</b> internal.h:205</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a9419cb3bd725ec2b5988af1cb27af65d"><div class="ttname"><a href="cachefiles_2internal_8h.html#a9419cb3bd725ec2b5988af1cb27af65d">cachefiles_write_page</a></div><div class="ttdeci">int cachefiles_write_page(struct fscache_storage *, struct page *)</div><div class="ttdef"><b>Definition:</b> rdwr.c:871</div></div>
<div class="ttc" id="structcachefiles__cache_html_aeb47301b2537b44facbf55836d98466b"><div class="ttname"><a href="structcachefiles__cache.html#aeb47301b2537b44facbf55836d98466b">cachefiles_cache::mnt</a></div><div class="ttdeci">struct vfsmount * mnt</div><div class="ttdef"><b>Definition:</b> internal.h:61</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a58d33fa2b9b7d73c007da08b45c32412"><div class="ttname"><a href="cachefiles_2internal_8h.html#a58d33fa2b9b7d73c007da08b45c32412">cachefiles_cook_key</a></div><div class="ttdeci">char * cachefiles_cook_key(const u8 *raw, int keylen, uint8_t type)</div><div class="ttdef"><b>Definition:</b> key.c:37</div></div>
<div class="ttc" id="structcachefiles__one__write_html_a3ec05da03d615beca2121fb0ec9b4227"><div class="ttname"><a href="structcachefiles__one__write.html#a3ec05da03d615beca2121fb0ec9b4227">cachefiles_one_write::context</a></div><div class="ttdeci">void * context</div><div class="ttdef"><b>Definition:</b> internal.h:115</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a8e13b52427e6eb465858de13b46e48f3"><div class="ttname"><a href="cachefiles_2internal_8h.html#a8e13b52427e6eb465858de13b46e48f3">cachefiles_check_in_use</a></div><div class="ttdeci">int cachefiles_check_in_use(struct cachefiles_cache *cache, struct dentry *dir, char *filename)</div><div class="ttdef"><b>Definition:</b> namei.c:1014</div></div>
<div class="ttc" id="structcachefiles__one__write_html_af1f07fee1a35e98559c94acc224f0e0e"><div class="ttname"><a href="structcachefiles__one__write.html#af1f07fee1a35e98559c94acc224f0e0e">cachefiles_one_write::netfs_page</a></div><div class="ttdeci">struct page * netfs_page</div><div class="ttdef"><b>Definition:</b> internal.h:111</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_ad855c7d800f5e88a84f826170bc3baf6"><div class="ttname"><a href="cachefiles_2internal_8h.html#ad855c7d800f5e88a84f826170bc3baf6">cachefiles_daemon_bind</a></div><div class="ttdeci">int cachefiles_daemon_bind(struct cachefiles_cache *cache, char *args)</div><div class="ttdef"><b>Definition:</b> bind.c:31</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_af6a044d2b4c01d7edca4621cbd8c8b93"><div class="ttname"><a href="cachefiles_2internal_8h.html#af6a044d2b4c01d7edca4621cbd8c8b93">cachefiles_check_auxdata</a></div><div class="ttdeci">int cachefiles_check_auxdata(struct cachefiles_object *object)</div><div class="ttdef"><b>Definition:</b> xattr.c:161</div></div>
<div class="ttc" id="ctree_8h_html_aa668e7809c8e0ee68dd5049ead875006"><div class="ttname"><a href="ctree_8h.html#aa668e7809c8e0ee68dd5049ead875006">key</a></div><div class="ttdeci">struct btrfs_disk_key key</div><div class="ttdef"><b>Definition:</b> ctree.h:105</div></div>
<div class="ttc" id="structcachefiles__object_html_a2f1d6c52da6a0de8c641c90ad416346a"><div class="ttname"><a href="structcachefiles__object.html#a2f1d6c52da6a0de8c641c90ad416346a">cachefiles_object::fscache</a></div><div class="ttdeci">struct fscache_object fscache</div><div class="ttdef"><b>Definition:</b> internal.h:40</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_adcf3ddd409e3d98864071a9ac0ef00c3"><div class="ttname"><a href="cachefiles_2internal_8h.html#adcf3ddd409e3d98864071a9ac0ef00c3">cachefiles_get_security_ID</a></div><div class="ttdeci">int cachefiles_get_security_ID(struct cachefiles_cache *cache)</div><div class="ttdef"><b>Definition:</b> security.c:20</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a5f0f418a446b15f42ac869ba23e867b7"><div class="ttname"><a href="cachefiles_2internal_8h.html#a5f0f418a446b15f42ac869ba23e867b7">cachefiles_delete_object</a></div><div class="ttdeci">int cachefiles_delete_object(struct cachefiles_cache *cache, struct cachefiles_object *object)</div><div class="ttdef"><b>Definition:</b> namei.c:439</div></div>
<div class="ttc" id="structcachefiles__xattr_html"><div class="ttname"><a href="structcachefiles__xattr.html">cachefiles_xattr</a></div><div class="ttdef"><b>Definition:</b> internal.h:121</div></div>
<div class="ttc" id="structcachefiles__cache_html_aa47a45d045bb3c603d6809d8daaf9fa5"><div class="ttname"><a href="structcachefiles__cache.html#aa47a45d045bb3c603d6809d8daaf9fa5">cachefiles_cache::active_lock</a></div><div class="ttdeci">rwlock_t active_lock</div><div class="ttdef"><b>Definition:</b> internal.h:68</div></div>
<div class="ttc" id="structcachefiles__object_html_a38bef5b6714fdf7c965029b3339f0ff3"><div class="ttname"><a href="structcachefiles__object.html#a38bef5b6714fdf7c965029b3339f0ff3">cachefiles_object::lookup_data</a></div><div class="ttdeci">struct cachefiles_lookup_data * lookup_data</div><div class="ttdef"><b>Definition:</b> internal.h:41</div></div>
<div class="ttc" id="structcachefiles__cache_html_a11cf736cc604c7b6d44c9d730d46befb"><div class="ttname"><a href="structcachefiles__cache.html#a11cf736cc604c7b6d44c9d730d46befb">cachefiles_cache::bcull</a></div><div class="ttdeci">sector_t bcull</div><div class="ttdef"><b>Definition:</b> internal.h:84</div></div>
<div class="ttc" id="structcachefiles__cache_html_adc6a0a7a264761c2e40b85421f085ef8"><div class="ttname"><a href="structcachefiles__cache.html#adc6a0a7a264761c2e40b85421f085ef8">cachefiles_cache::tag</a></div><div class="ttdeci">char * tag</div><div class="ttdef"><b>Definition:</b> internal.h:93</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_acf3ab3e53fc0c9258697087347b8f906"><div class="ttname"><a href="cachefiles_2internal_8h.html#acf3ab3e53fc0c9258697087347b8f906">cachefiles_mark_object_inactive</a></div><div class="ttdeci">void cachefiles_mark_object_inactive(struct cachefiles_cache *cache, struct cachefiles_object *object, blkcnt_t i_blocks)</div><div class="ttdef"><b>Definition:</b> namei.c:260</div></div>
<div class="ttc" id="cifspdu_8h_html_aaa61af584164f982573a6890174ef943"><div class="ttname"><a href="cifspdu_8h.html#aaa61af584164f982573a6890174ef943">data</a></div><div class="ttdeci">__u8 * data</div><div class="ttdef"><b>Definition:</b> cifspdu.h:457</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a84b639d224854f96ab106da06ac6b4a7"><div class="ttname"><a href="cachefiles_2internal_8h.html#a84b639d224854f96ab106da06ac6b4a7">cachefiles_determine_cache_security</a></div><div class="ttdeci">int cachefiles_determine_cache_security(struct cachefiles_cache *cache, struct dentry *root, const struct cred **_saved_cred)</div><div class="ttdef"><b>Definition:</b> security.c:79</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a512e064d12ae2cb5cd1d7a065c7ad2de"><div class="ttname"><a href="cachefiles_2internal_8h.html#a512e064d12ae2cb5cd1d7a065c7ad2de">cachefiles_check_object_xattr</a></div><div class="ttdeci">int cachefiles_check_object_xattr(struct cachefiles_object *object, struct cachefiles_xattr *auxdata)</div><div class="ttdef"><b>Definition:</b> xattr.c:200</div></div>
<div class="ttc" id="structcachefiles__object_html_a880450ce7aaa8efc09a6995d70629847"><div class="ttname"><a href="structcachefiles__object.html#a880450ce7aaa8efc09a6995d70629847">cachefiles_object::work_lock</a></div><div class="ttdeci">spinlock_t work_lock</div><div class="ttdef"><b>Definition:</b> internal.h:50</div></div>
<div class="ttc" id="structcachefiles__cache_html_a484e830971c4ae9f4677d07a9dc6c5b0"><div class="ttname"><a href="structcachefiles__cache.html#a484e830971c4ae9f4677d07a9dc6c5b0">cachefiles_cache::bsize</a></div><div class="ttdeci">unsigned bsize</div><div class="ttdef"><b>Definition:</b> internal.h:78</div></div>
<div class="ttc" id="structcachefiles__cache_html_ad6e8f9d2b9fb04170467a6db9e2d4a3a"><div class="ttname"><a href="structcachefiles__cache.html#ad6e8f9d2b9fb04170467a6db9e2d4a3a">cachefiles_cache::fstop_percent</a></div><div class="ttdeci">unsigned fstop_percent</div><div class="ttdef"><b>Definition:</b> internal.h:74</div></div>
<div class="ttc" id="structcachefiles__object_html_a8110c2616fb4281cf7a4c8f65432b535"><div class="ttname"><a href="structcachefiles__object.html#a8110c2616fb4281cf7a4c8f65432b535">cachefiles_object::active_node</a></div><div class="ttdeci">struct rb_node active_node</div><div class="ttdef"><b>Definition:</b> internal.h:51</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_adbc55b27e3b71a72dd8f47bcf6a0d069"><div class="ttname"><a href="cachefiles_2internal_8h.html#adbc55b27e3b71a72dd8f47bcf6a0d069">cachefiles_debug</a></div><div class="ttdeci">unsigned cachefiles_debug</div><div class="ttdef"><b>Definition:</b> main.c:28</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_aa058a3a3188d63990599795fe78dfad8"><div class="ttname"><a href="cachefiles_2internal_8h.html#aa058a3a3188d63990599795fe78dfad8">cachefiles_daemon_fops</a></div><div class="ttdeci">const struct file_operations cachefiles_daemon_fops</div><div class="ttdef"><b>Definition:</b> daemon.c:51</div></div>
<div class="ttc" id="structcachefiles__cache_html_a64f77f9319d793d6f9181d58c8e65b29"><div class="ttname"><a href="structcachefiles__cache.html#a64f77f9319d793d6f9181d58c8e65b29">cachefiles_cache::frun</a></div><div class="ttdeci">uint64_t frun</div><div class="ttdef"><b>Definition:</b> internal.h:80</div></div>
<div class="ttc" id="structcachefiles__xattr_html_ac6660feac8ec1da47bcb02afa398416c"><div class="ttname"><a href="structcachefiles__xattr.html#ac6660feac8ec1da47bcb02afa398416c">cachefiles_xattr::type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition:</b> internal.h:123</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_af782ed4df8059692e441d92302e58bf0"><div class="ttname"><a href="cachefiles_2internal_8h.html#af782ed4df8059692e441d92302e58bf0">cachefiles_begin_secure</a></div><div class="ttdeci">static void cachefiles_begin_secure(struct cachefiles_cache *cache, const struct cred **_saved_cred)</div><div class="ttdef"><b>Definition:</b> internal.h:232</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a824376f681102f3ba28b537486e5b4b9"><div class="ttname"><a href="cachefiles_2internal_8h.html#a824376f681102f3ba28b537486e5b4b9">cachefiles_has_space</a></div><div class="ttdeci">int cachefiles_has_space(struct cachefiles_cache *cache, unsigned fnr, unsigned bnr)</div><div class="ttdef"><b>Definition:</b> daemon.c:675</div></div>
<div class="ttc" id="structcachefiles__cache_html_ab5c2da282eaae0b5ae7526bbcf1b6507"><div class="ttname"><a href="structcachefiles__cache.html#ab5c2da282eaae0b5ae7526bbcf1b6507">cachefiles_cache::secctx</a></div><div class="ttdeci">char * secctx</div><div class="ttdef"><b>Definition:</b> internal.h:92</div></div>
<div class="ttc" id="structcachefiles__object_html_a16503bb450546ad63fa05e9435f58346"><div class="ttname"><a href="structcachefiles__object.html#a16503bb450546ad63fa05e9435f58346">cachefiles_object::flags</a></div><div class="ttdeci">unsigned long flags</div><div class="ttdef"><b>Definition:</b> internal.h:45</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a0752ef602fe821eb83ee8fd1218f39c9"><div class="ttname"><a href="cachefiles_2internal_8h.html#a0752ef602fe821eb83ee8fd1218f39c9">cachefiles_state_changed</a></div><div class="ttdeci">static void cachefiles_state_changed(struct cachefiles_cache *cache)</div><div class="ttdef"><b>Definition:</b> internal.h:132</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a3980898429c8f49aaadd059334da4d17"><div class="ttname"><a href="cachefiles_2internal_8h.html#a3980898429c8f49aaadd059334da4d17">cachefiles_read_or_alloc_page</a></div><div class="ttdeci">int cachefiles_read_or_alloc_page(struct fscache_retrieval *, struct page *, gfp_t)</div><div class="ttdef"><b>Definition:</b> rdwr.c:389</div></div>
<div class="ttc" id="structcachefiles__cache_html_a0ef3b7d7ef0b5e3f8ee119ac5b34445c"><div class="ttname"><a href="structcachefiles__cache.html#a0ef3b7d7ef0b5e3f8ee119ac5b34445c">cachefiles_cache::brun</a></div><div class="ttdeci">sector_t brun</div><div class="ttdef"><b>Definition:</b> internal.h:83</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_ae1a459e7a4c8345093482132a17bae64"><div class="ttname"><a href="cachefiles_2internal_8h.html#ae1a459e7a4c8345093482132a17bae64">cachefiles_cull</a></div><div class="ttdeci">int cachefiles_cull(struct cachefiles_cache *cache, struct dentry *dir, char *filename)</div><div class="ttdef"><b>Definition:</b> namei.c:954</div></div>
<div class="ttc" id="structcachefiles__one__read_html"><div class="ttname"><a href="structcachefiles__one__read.html">cachefiles_one_read</a></div><div class="ttdef"><b>Definition:</b> internal.h:99</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_aed48b8108858c76305c9ec45d6e08204"><div class="ttname"><a href="cachefiles_2internal_8h.html#aed48b8108858c76305c9ec45d6e08204">cachefiles_uncache_page</a></div><div class="ttdeci">void cachefiles_uncache_page(struct fscache_object *, struct page *)</div></div>
<div class="ttc" id="structcachefiles__object_html_a1e3a9aa1fbda01d14b9d1f744bb6a6be"><div class="ttname"><a href="structcachefiles__object.html#a1e3a9aa1fbda01d14b9d1f744bb6a6be">cachefiles_object::i_size</a></div><div class="ttdeci">loff_t i_size</div><div class="ttdef"><b>Definition:</b> internal.h:44</div></div>
<div class="ttc" id="structcachefiles__cache_html_a0ca9f1d131b3c1b13e7145fb28b42cd2"><div class="ttname"><a href="structcachefiles__cache.html#a0ca9f1d131b3c1b13e7145fb28b42cd2">cachefiles_cache::bcull_percent</a></div><div class="ttdeci">unsigned bcull_percent</div><div class="ttdef"><b>Definition:</b> internal.h:76</div></div>
<div class="ttc" id="structcachefiles__cache_html_a53f8c1ada28ca44a5001657c317e1480"><div class="ttname"><a href="structcachefiles__cache.html#a53f8c1ada28ca44a5001657c317e1480">cachefiles_cache::bshift</a></div><div class="ttdeci">unsigned bshift</div><div class="ttdef"><b>Definition:</b> internal.h:79</div></div>
<div class="ttc" id="cachefiles_2proc_8c_html_a406f0a754d0a9985adb45f313fe583b0"><div class="ttname"><a href="cachefiles_2proc_8c.html#a406f0a754d0a9985adb45f313fe583b0">cachefiles_create_histogram</a></div><div class="ttdeci">atomic_t cachefiles_create_histogram[HZ]</div><div class="ttdef"><b>Definition:</b> proc.c:19</div></div>
<div class="ttc" id="structcachefiles__cache_html_a37a032c7e3e69165840d4aacbaa4abd3"><div class="ttname"><a href="structcachefiles__cache.html#a37a032c7e3e69165840d4aacbaa4abd3">cachefiles_cache::cache_cred</a></div><div class="ttdeci">const struct cred * cache_cred</div><div class="ttdef"><b>Definition:</b> internal.h:64</div></div>
<div class="ttc" id="structcachefiles__cache_html_a9a86e9d164fcffd23992468447546458"><div class="ttname"><a href="structcachefiles__cache.html#a9a86e9d164fcffd23992468447546458">cachefiles_cache::f_released</a></div><div class="ttdeci">atomic_t f_released</div><div class="ttdef"><b>Definition:</b> internal.h:70</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_a11d40486ca08a4854bf101e6fc020694"><div class="ttname"><a href="cachefiles_2internal_8h.html#a11d40486ca08a4854bf101e6fc020694">cachefiles_check_object_type</a></div><div class="ttdeci">int cachefiles_check_object_type(struct cachefiles_object *object)</div><div class="ttdef"><b>Definition:</b> xattr.c:29</div></div>
<div class="ttc" id="cachefiles_2internal_8h_html_ae73c3bfca6a26fae836a4dfa91fac35d"><div class="ttname"><a href="cachefiles_2internal_8h.html#ae73c3bfca6a26fae836a4dfa91fac35d">cachefiles_allocate_page</a></div><div class="ttdeci">int cachefiles_allocate_page(struct fscache_retrieval *, struct page *, gfp_t)</div><div class="ttdef"><b>Definition:</b> rdwr.c:788</div></div>
<div class="ttc" id="cifspdu_8h_html_a4a06ef9aaffd2c58a6d395fd433cde26"><div class="ttname"><a href="cifspdu_8h.html#a4a06ef9aaffd2c58a6d395fd433cde26">name</a></div><div class="ttdeci">char name[16]</div><div class="ttdef"><b>Definition:</b> cifspdu.h:457</div></div>
<div class="ttc" id="cachefiles_2proc_8c_html_affc7f4caeede8c5d479bd8aab269bb26"><div class="ttname"><a href="cachefiles_2proc_8c.html#affc7f4caeede8c5d479bd8aab269bb26">cachefiles_mkdir_histogram</a></div><div class="ttdeci">atomic_t cachefiles_mkdir_histogram[HZ]</div><div class="ttdef"><b>Definition:</b> proc.c:18</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_761ceebc9c5b1f27698e43f9db3b8cbf.html">cachefiles</a></li><li class="navelem"><a class="el" href="cachefiles_2internal_8h.html">internal.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
