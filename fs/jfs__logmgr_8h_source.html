<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linux/fs: jfs/jfs_logmgr.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linux/fs
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('jfs__logmgr_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">jfs_logmgr.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="jfs__logmgr_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *   Copyright (C) International Business Machines Corp., 2000-2004</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *   Portions Copyright (C) Christoph Hellwig, 2001-2002</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *   This program is free software;  you can redistribute it and/or modify</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *   the Free Software Foundation; either version 2 of the License, or</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   (at your option) any later version.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   but WITHOUT ANY WARRANTY;  without even the implied warranty of</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *   the GNU General Public License for more details.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *   along with this program;  if not, write to the Free Software</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#ifndef _H_JFS_LOGMGR</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#define _H_JFS_LOGMGR</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="jfs__filsys_8h.html">jfs_filsys.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="jfs__lock_8h.html">jfs_lock.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *  log manager configuration parameters</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* log page size */</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a7f4eb7d6e1f681c2bb441132bc68d3eb">   30</a></span>&#160;<span class="preprocessor">#define LOGPSIZE    4096</span></div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a2befb0b76651877d59f5c2af890ba718">   31</a></span>&#160;<span class="preprocessor">#define L2LOGPSIZE  12</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a54a43813c067d007bcb0a7fd98d089ef">   33</a></span>&#160;<span class="preprocessor">#define LOGPAGES    16  </span><span class="comment">/* Log pages per mounted file system */</span><span class="preprocessor"></span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> *  log logical volume</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * a log is used to make the commit operation on journalled</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * files within the same logical volume group atomic.</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * a log is implemented with a logical volume.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * there is one log per logical volume group.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> * block 0 of the log logical volume is not used (ipl etc).</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * block 1 contains a log &quot;superblock&quot; and is used by logFormat(),</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * lmLogInit(), lmLogShutdown(), and logRedo() to record status</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> * of the log but is not otherwise used during normal processing.</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * blocks 2 - (N-1) are used to contain log records.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * when a volume group is varied-on-line, logRedo() must have</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> * been executed before the file systems (logical volumes) in</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * the volume group can be mounted.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> *  log superblock (block 1 of logical volume)</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#abb7a3ac85bb109bd17c9661139a1f2c3">   56</a></span>&#160;<span class="preprocessor">#define LOGSUPER_B  1</span></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a6f046ba18cd22da7d12d89e7458f5d7f">   57</a></span>&#160;<span class="preprocessor">#define LOGSTART_B  2</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a461fa3ca6dee4b501f8ba3fc887de9fc">   59</a></span>&#160;<span class="preprocessor">#define LOGMAGIC    0x87654321</span></div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#acb8c72f0c562ca6815eec226761f5746">   60</a></span>&#160;<span class="preprocessor">#define LOGVERSION  1</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a3326e3c63b90eef3a41e0c25e886c3e2">   62</a></span>&#160;<span class="preprocessor">#define MAX_ACTIVE  128 </span><span class="comment">/* Max active file systems sharing log */</span><span class="preprocessor"></span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structlogsuper.html">   64</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlogsuper.html">logsuper</a> {</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structlogsuper.html#ae7987bfba88103aac7c4297fcee3e6eb">   65</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#ae7987bfba88103aac7c4297fcee3e6eb">magic</a>;       <span class="comment">/* 4: log lv identifier */</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structlogsuper.html#acd1e5b5943222d930b2f0e6631de06df">   66</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#acd1e5b5943222d930b2f0e6631de06df">version</a>;     <span class="comment">/* 4: version number */</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structlogsuper.html#a42e2346a689127982cc36c2f9d996c69">   67</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#a42e2346a689127982cc36c2f9d996c69">serial</a>;      <span class="comment">/* 4: log open/mount counter */</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structlogsuper.html#a4e1172999b84c471b767e7a385491e69">   68</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#a4e1172999b84c471b767e7a385491e69">size</a>;        <span class="comment">/* 4: size in number of LOGPSIZE blocks */</span></div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structlogsuper.html#a95fbf442099e9d466cf1b001e910ffed">   69</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#a95fbf442099e9d466cf1b001e910ffed">bsize</a>;       <span class="comment">/* 4: logical block size in byte */</span></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structlogsuper.html#a36b240fbab2d20ee831e64bcfb2d482d">   70</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#a36b240fbab2d20ee831e64bcfb2d482d">l2bsize</a>;     <span class="comment">/* 4: log2 of bsize */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structlogsuper.html#ab2a37d89ba722e25dd7e82ae5e8a866c">   72</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#ab2a37d89ba722e25dd7e82ae5e8a866c">flag</a>;        <span class="comment">/* 4: option */</span></div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structlogsuper.html#acedb929e0da078a28f6a4b612767f6f1">   73</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#acedb929e0da078a28f6a4b612767f6f1">state</a>;       <span class="comment">/* 4: state - see below */</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structlogsuper.html#a1d63bfc11ff3e3e7fad8ba650af5ae99">   75</a></span>&#160;    __le32 <a class="code" href="structlogsuper.html#a1d63bfc11ff3e3e7fad8ba650af5ae99">end</a>;     <span class="comment">/* 4: addr of last log record set by logredo */</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structlogsuper.html#a1c23b97ba27fc36e1e628872d3c2e41f">   76</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structlogsuper.html#a1c23b97ba27fc36e1e628872d3c2e41f">uuid</a>[16];      <span class="comment">/* 16: 128-bit journal uuid */</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structlogsuper.html#a1dabbf9393eaaa736875005a3ea3b87d">   77</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structlogsuper.html#a1dabbf9393eaaa736875005a3ea3b87d">label</a>[16];     <span class="comment">/* 16: journal label */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">struct </span>{</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">char</span> uuid[16];</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    } <a class="code" href="structlogsuper.html#a8081fb5d91eae8feea6eb989193b57d4">active</a>[<a class="code" href="jfs__logmgr_8h.html#a3326e3c63b90eef3a41e0c25e886c3e2">MAX_ACTIVE</a>];   <span class="comment">/* 2048: active file systems list */</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;};</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a52a299e957a56d91fd6ee0cace7fcd0e">   83</a></span>&#160;<span class="preprocessor">#define NULL_UUID &quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/* log flag: commit option (see jfs_filsys.h) */</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/* log state */</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a31a596a246b6d00a2c27c7de78b4afc9">   88</a></span>&#160;<span class="preprocessor">#define LOGMOUNT    0   </span><span class="comment">/* log mounted by lmLogInit() */</span><span class="preprocessor"></span></div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a596ba1b8c84fd93916d787093a68e85e">   89</a></span>&#160;<span class="preprocessor">#define LOGREDONE   1   </span><span class="comment">/* log shutdown by lmLogShutdown().</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">                 * log redo completed by logredo().</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">                 */</span><span class="preprocessor"></span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a600e33c9c395d310790c47756e38022f">   92</a></span>&#160;<span class="preprocessor">#define LOGWRAP     2   </span><span class="comment">/* log wrapped */</span><span class="preprocessor"></span></div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a7c395c0215dc0b72d76aed57f18e0b52">   93</a></span>&#160;<span class="preprocessor">#define LOGREADERR  3   </span><span class="comment">/* log read error detected in logredo() */</span><span class="preprocessor"></span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> *  log logical page</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> * (this comment should be rewritten !)</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> * the header and trailer structures (h,t) will normally have</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> * the same page and eor value.</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * An exception to this occurs when a complete page write is not</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> * accomplished on a power failure. Since the hardware may &quot;split write&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> * sectors in the page, any out of order sequence may occur during powerfail</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> * and needs to be recognized during log replay.  The xor value is</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> * an &quot;exclusive or&quot; of all log words in the page up to eor.  This</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> * 32 bit eor is stored with the top 16 bits in the header and the</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> * bottom 16 bits in the trailer.  logredo can easily recognize pages</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> * that were not completed by reconstructing this eor and checking</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> * the log page.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> * Previous versions of the operating system did not allow split</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> * writes and detected partially written records in logredo by</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> * ordering the updates to the header, trailer, and the move of data</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> * into the logdata area.  The order: (1) data is moved (2) header</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> * is updated (3) trailer is updated.  In logredo, when the header</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> * differed from the trailer, the header and trailer were reconciled</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> * as follows: if h.page != t.page they were set to the smaller of</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> * the two and h.eor and t.eor set to 8 (i.e. empty page). if (only)</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> * h.eor != t.eor they were set to the smaller of their two values.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structlogpage.html">  122</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlogpage.html">logpage</a> {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">struct </span>{        <span class="comment">/* header */</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structlogpage.html#a182e3b842ebd0883383619927aef06f2">  124</a></span>&#160;        __le32 <a class="code" href="structlogpage.html#a182e3b842ebd0883383619927aef06f2">page</a>;    <span class="comment">/* 4: log sequence page number */</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structlogpage.html#a69094c460c73efef80867cae793c2112">  125</a></span>&#160;        __le16 <a class="code" href="structlogpage.html#a69094c460c73efef80867cae793c2112">rsrvd</a>;   <span class="comment">/* 2: */</span></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structlogpage.html#a15505ac4a5d802a22d15e02ba5b6dfd8">  126</a></span>&#160;        __le16 <a class="code" href="structlogpage.html#a15505ac4a5d802a22d15e02ba5b6dfd8">eor</a>; <span class="comment">/* 2: end-of-log offset of lasrt record write */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    } h;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structlogpage.html#afb325c40459b2c08e5256e6231e93ec6">  129</a></span>&#160;    __le32 <a class="code" href="cifspdu_8h.html#aaa61af584164f982573a6890174ef943">data</a>[<a class="code" href="jfs__logmgr_8h.html#a7f4eb7d6e1f681c2bb441132bc68d3eb">LOGPSIZE</a> / 4 - 4];  <span class="comment">/* log record area */</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">struct </span>{        <span class="comment">/* trailer */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        __le32 page;    <span class="comment">/* 4: normally the same as h.page */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        __le16 rsrvd;   <span class="comment">/* 2: */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        __le16 eor; <span class="comment">/* 2: normally the same as h.eor */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    } t;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;};</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a65ca5883a8f18681f727d318a1745bb8">  138</a></span>&#160;<span class="preprocessor">#define LOGPHDRSIZE 8   </span><span class="comment">/* log page header size */</span><span class="preprocessor"></span></div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#ad0701ab9d1a7a2331c41c3e8b5d186fe">  139</a></span>&#160;<span class="preprocessor">#define LOGPTLRSIZE 8   </span><span class="comment">/* log page trailer size */</span><span class="preprocessor"></span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> *  log record</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> * (this comment should be rewritten !)</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> * jfs uses only &quot;after&quot; log records (only a single writer is allowed</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> * in a page, pages are written to temporary paging space if</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> * if they must be written to disk before commit, and i/o is</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> * scheduled for modified pages to their home location after</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> * the log records containing the after values and the commit</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> * record is written to the log on disk, undo discards the copy</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> * in main-memory.)</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> * a log record consists of a data area of variable length followed by</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> * a descriptor of fixed size LOGRDSIZE bytes.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> * the data area is rounded up to an integral number of 4-bytes and</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> * must be no longer than LOGPSIZE.</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> * the descriptor is of size of multiple of 4-bytes and aligned on a</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> * 4-byte boundary.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> * records are packed one after the other in the data area of log pages.</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> * (sometimes a DUMMY record is inserted so that at least one record ends</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> * on every page or the longest record is placed on at most two pages).</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> * the field eor in page header/trailer points to the byte following</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> * the last record on a page.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">/* log record types */</span></div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a950efd2e72b5f2185689c44e0afc03f3">  168</a></span>&#160;<span class="preprocessor">#define LOG_COMMIT      0x8000</span></div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aa926d842fd3776d3fe7d5407d92a0ac3">  169</a></span>&#160;<span class="preprocessor">#define LOG_SYNCPT      0x4000</span></div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a2624f1bc25604a9b29101cc7c4521e90">  170</a></span>&#160;<span class="preprocessor">#define LOG_MOUNT       0x2000</span></div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a942cf081e33988c00430ec6baede3bfd">  171</a></span>&#160;<span class="preprocessor">#define LOG_REDOPAGE        0x0800</span></div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a12171f5a10d595f2da939348e3136d27">  172</a></span>&#160;<span class="preprocessor">#define LOG_NOREDOPAGE      0x0080</span></div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#afc4b9b141a41ae283bf4c2157ef8255a">  173</a></span>&#160;<span class="preprocessor">#define LOG_NOREDOINOEXT    0x0040</span></div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a12724151f34414d42fbd9b44dc79f645">  174</a></span>&#160;<span class="preprocessor">#define LOG_UPDATEMAP       0x0008</span></div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#adacb42049cc9af8dddfcc07d65cd4add">  175</a></span>&#160;<span class="preprocessor">#define LOG_NOREDOFILE      0x0001</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">/* REDOPAGE/NOREDOPAGE log record data type */</span></div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aed4a1c7b37691aa01d0fd768391538aa">  178</a></span>&#160;<span class="preprocessor">#define LOG_INODE       0x0001</span></div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a06cdd8acef18fddf939ecf7075c0e284">  179</a></span>&#160;<span class="preprocessor">#define LOG_XTREE       0x0002</span></div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#ac3ef7864ba01302db2e1322c33da2e99">  180</a></span>&#160;<span class="preprocessor">#define LOG_DTREE       0x0004</span></div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aa1d799f1524c2c0d0ebb137e0249b88d">  181</a></span>&#160;<span class="preprocessor">#define LOG_BTROOT      0x0010</span></div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#adc5ccef79ebab85e001d17504d0a3c78">  182</a></span>&#160;<span class="preprocessor">#define LOG_EA          0x0020</span></div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a114bd5b067905c0d01f8352e732026ec">  183</a></span>&#160;<span class="preprocessor">#define LOG_ACL         0x0040</span></div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#abddb73013289001e15f37f751900d3b2">  184</a></span>&#160;<span class="preprocessor">#define LOG_DATA        0x0080</span></div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a24f36b03b15763f4dac0c9a8400cbfa5">  185</a></span>&#160;<span class="preprocessor">#define LOG_NEW         0x0100</span></div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a1f3908f892103da61ff3b3210f99e1d7">  186</a></span>&#160;<span class="preprocessor">#define LOG_EXTEND      0x0200</span></div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a08433786835cfb9da103c857e86721b9">  187</a></span>&#160;<span class="preprocessor">#define LOG_RELOCATE        0x0400</span></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a26c466eca32bada7463562bff42bfebe">  188</a></span>&#160;<span class="preprocessor">#define LOG_DIR_XTREE       0x0800  </span><span class="comment">/* Xtree is in directory inode */</span><span class="preprocessor"></span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/* UPDATEMAP log record descriptor type */</span></div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a20eb5bbd1a3854cd49a91b55091d4c5c">  191</a></span>&#160;<span class="preprocessor">#define LOG_ALLOCXADLIST    0x0080</span></div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a41d794eb0411aaf66bd76c88e24e3e35">  192</a></span>&#160;<span class="preprocessor">#define LOG_ALLOCPXDLIST    0x0040</span></div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a3f2a556b2b823d56707f3a4ee20240b5">  193</a></span>&#160;<span class="preprocessor">#define LOG_ALLOCXAD        0x0020</span></div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a04f26a686f8e35613f35dc77b4dd135c">  194</a></span>&#160;<span class="preprocessor">#define LOG_ALLOCPXD        0x0010</span></div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a604338364eec9f2b64d8d7b5bc70f2e1">  195</a></span>&#160;<span class="preprocessor">#define LOG_FREEXADLIST     0x0008</span></div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a59645eb6cc93f1a934c8ce05b93d0325">  196</a></span>&#160;<span class="preprocessor">#define LOG_FREEPXDLIST     0x0004</span></div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a23d5eaf91ad51f3bc16dd477b9678fc8">  197</a></span>&#160;<span class="preprocessor">#define LOG_FREEXAD     0x0002</span></div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aa7260551de1b509a4b7b559fd92bdd76">  198</a></span>&#160;<span class="preprocessor">#define LOG_FREEPXD     0x0001</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="structlrd.html">  201</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlrd.html">lrd</a> {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">     * type independent area</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="structlrd.html#a3fed9dfb5db5803488ddfcb3c9db76fc">  205</a></span>&#160;    __le32 <a class="code" href="structlrd.html#a3fed9dfb5db5803488ddfcb3c9db76fc">logtid</a>;      <span class="comment">/* 4: log transaction identifier */</span></div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="structlrd.html#a6eab4a1db37b1402ec56cfc4bf417de7">  206</a></span>&#160;    __le32 <a class="code" href="structlrd.html#a6eab4a1db37b1402ec56cfc4bf417de7">backchain</a>;   <span class="comment">/* 4: ptr to prev record of same transaction */</span></div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="structlrd.html#a8bc8ef778f5697e4eefa2cbd79b3179a">  207</a></span>&#160;    __le16 <a class="code" href="structlrd.html#a8bc8ef778f5697e4eefa2cbd79b3179a">type</a>;        <span class="comment">/* 2: record type */</span></div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="structlrd.html#ac8dafa635309faf05c2dd3e9c0e07d56">  208</a></span>&#160;    __le16 <a class="code" href="structlrd.html#ac8dafa635309faf05c2dd3e9c0e07d56">length</a>;      <span class="comment">/* 2: length of data in record (in byte) */</span></div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="structlrd.html#a888496055b9fc5136178666dd1ad38e9">  209</a></span>&#160;    __le32 <a class="code" href="structlrd.html#a888496055b9fc5136178666dd1ad38e9">aggregate</a>;   <span class="comment">/* 4: file system lv/aggregate */</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">/* (16) */</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">     * type dependent area (20)</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">union </span>{</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">         *  COMMIT: commit</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">         * transaction commit: no type-dependent information;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">         *  REDOPAGE: after-image</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">         * apply after-image;</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">         * N.B. REDOPAGE, NOREDOPAGE, and UPDATEMAP must be same format;</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keyword">struct </span>{</div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="structlrd.html#a1ad4f2425cea3b3451bad4a622dd6e1e">  231</a></span>&#160;            __le32 <a class="code" href="structlrd.html#a1ad4f2425cea3b3451bad4a622dd6e1e">fileset</a>; <span class="comment">/* 4: fileset number */</span></div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="structlrd.html#a6f498aadee9bdecb388290ab2d2aef34">  232</a></span>&#160;            __le32 <a class="code" href="structlrd.html#a6f498aadee9bdecb388290ab2d2aef34">inode</a>;   <span class="comment">/* 4: inode number */</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            __le16 <a class="code" href="cifsacl_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;    <span class="comment">/* 2: REDOPAGE record type */</span></div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="structlrd.html#a59d4fed4a76eaca757d4ef1211b7673a">  234</a></span>&#160;            __le16 <a class="code" href="structlrd.html#a59d4fed4a76eaca757d4ef1211b7673a">l2linesize</a>;  <span class="comment">/* 2: log2 of line size */</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="structlrd.html#a1a29e5888db47a01c09f2705349aed47">  235</a></span>&#160;            <a class="code" href="structpxd__t.html">pxd_t</a> <a class="code" href="structlrd.html#a1a29e5888db47a01c09f2705349aed47">pxd</a>;  <span class="comment">/* 8: on-disk page pxd */</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        } redopage; <span class="comment">/* (20) */</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">         *  NOREDOPAGE: the page is freed</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">         * do not apply after-image records which precede this record</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">         * in the log with the same page block number to this page.</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">         * N.B. REDOPAGE, NOREDOPAGE, and UPDATEMAP must be same format;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keyword">struct </span>{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            __le32 fileset; <span class="comment">/* 4: fileset number */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            __le32 <a class="code" href="summary_8h.html#a63c41f9614ee9a4e1beb75eabad72f22">inode</a>;   <span class="comment">/* 4: inode number */</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            __le16 <a class="code" href="cifsacl_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;    <span class="comment">/* 2: NOREDOPAGE record type */</span></div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structlrd.html#a9c99d35ba39d6282a85f150662f981fa">  250</a></span>&#160;            __le16 <a class="code" href="structlrd.html#a9c99d35ba39d6282a85f150662f981fa">rsrvd</a>;   <span class="comment">/* 2: reserved */</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <a class="code" href="structpxd__t.html">pxd_t</a> pxd;  <span class="comment">/* 8: on-disk page pxd */</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        } noredopage;   <span class="comment">/* (20) */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">         *  UPDATEMAP: update block allocation map</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">         * either in-line PXD,</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">         * or     out-of-line  XADLIST;</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">         * N.B. REDOPAGE, NOREDOPAGE, and UPDATEMAP must be same format;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keyword">struct </span>{</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            __le32 fileset; <span class="comment">/* 4: fileset number */</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            __le32 <a class="code" href="summary_8h.html#a63c41f9614ee9a4e1beb75eabad72f22">inode</a>;   <span class="comment">/* 4: inode number */</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            __le16 <a class="code" href="cifsacl_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;    <span class="comment">/* 2: UPDATEMAP record type */</span></div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="structlrd.html#a17572705c7ffc5f39afbbbd824f24f83">  266</a></span>&#160;            __le16 <a class="code" href="structlrd.html#a17572705c7ffc5f39afbbbd824f24f83">nxd</a>; <span class="comment">/* 2: number of extents */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <a class="code" href="structpxd__t.html">pxd_t</a> pxd;  <span class="comment">/* 8: pxd */</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        } updatemap;    <span class="comment">/* (20) */</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">         *  NOREDOINOEXT: the inode extent is freed</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">         * do not apply after-image records which precede this</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">         * record in the log with the any of the 4 page block</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">         * numbers in this inode extent.</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">         * NOTE: The fileset and pxd fields MUST remain in</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">         *       the same fields in the REDOPAGE record format.</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keyword">struct </span>{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            __le32 fileset; <span class="comment">/* 4: fileset number */</span></div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="structlrd.html#a29fcf857809650d9a6b17581be3a419a">  283</a></span>&#160;            __le32 <a class="code" href="structlrd.html#a29fcf857809650d9a6b17581be3a419a">iagnum</a>;  <span class="comment">/* 4: IAG number     */</span></div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="structlrd.html#a8a601b1971aa00c29ccd2bf2b1ff4490">  284</a></span>&#160;            __le32 <a class="code" href="structlrd.html#a8a601b1971aa00c29ccd2bf2b1ff4490">inoext_idx</a>;  <span class="comment">/* 4: inode extent index */</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <a class="code" href="structpxd__t.html">pxd_t</a> pxd;  <span class="comment">/* 8: on-disk page pxd */</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        } noredoinoext; <span class="comment">/* (20) */</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">         *  SYNCPT: log sync point</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">         * replay log up to syncpt address specified;</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keyword">struct </span>{</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="structlrd.html#a28dcd41272e4d2d9b00deaf382063c68">  294</a></span>&#160;            __le32 <a class="code" href="structlrd.html#a28dcd41272e4d2d9b00deaf382063c68">sync</a>;    <span class="comment">/* 4: syncpt address (0 = here) */</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        } syncpt;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">         *  MOUNT: file system mount</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">         * file system mount: no type-dependent information;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">         *  ? FREEXTENT: free specified extent(s)</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">         * free specified extent(s) from block allocation map</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">         * N.B.: nextents should be length of data/sizeof(xad_t)</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">struct </span>{</div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="structlrd.html#ac6e04aed99a1fadb0759bc59aa68b14e">  310</a></span>&#160;            __le32 <a class="code" href="structlrd.html#ac6e04aed99a1fadb0759bc59aa68b14e">type</a>;    <span class="comment">/* 4: FREEXTENT record type */</span></div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="structlrd.html#a700d4dfc504008c48b6cba07d3b80d9b">  311</a></span>&#160;            __le32 <a class="code" href="structlrd.html#a700d4dfc504008c48b6cba07d3b80d9b">nextent</a>; <span class="comment">/* 4: number of extents */</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="comment">/* data: PXD or XAD list */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        } freextent;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">         *  ? NOREDOFILE: this file is freed</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">         * do not apply records which precede this record in the log</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">         * with the same inode number.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">         * NOREDOFILE must be the first to be written at commit</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">         * (last to be read in logredo()) - it prevents</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">         * replay of preceding updates of all preceding generations</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">         * of the inumber esp. the on-disk inode itself.</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">struct </span>{</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            __le32 fileset; <span class="comment">/* 4: fileset number */</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            __le32 <a class="code" href="summary_8h.html#a63c41f9614ee9a4e1beb75eabad72f22">inode</a>;   <span class="comment">/* 4: inode number */</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        } noredofile;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">         *  ? NEWPAGE:</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">         * metadata type dependent</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keyword">struct </span>{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            __le32 fileset; <span class="comment">/* 4: fileset number */</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            __le32 <a class="code" href="summary_8h.html#a63c41f9614ee9a4e1beb75eabad72f22">inode</a>;   <span class="comment">/* 4: inode number */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            __le32 <a class="code" href="cifsacl_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;    <span class="comment">/* 4: NEWPAGE record type */</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <a class="code" href="structpxd__t.html">pxd_t</a> pxd;  <span class="comment">/* 8: on-disk page pxd */</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        } newpage;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">         *  ? DUMMY: filler</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">         * no type-dependent information</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    } log;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;};                  <span class="comment">/* (36) */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a468e1233aefae7956d89cf1f03eab191">  352</a></span>&#160;<span class="preprocessor">#define LOGRDSIZE   (sizeof(struct lrd))</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"> *  line vector descriptor</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="structlvd.html">  357</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlvd.html">lvd</a> {</div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="structlvd.html#a1b69d7017cd2c61decc80833d398f1bc">  358</a></span>&#160;    __le16 <a class="code" href="structlvd.html#a1b69d7017cd2c61decc80833d398f1bc">offset</a>;</div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="structlvd.html#a407b2cca01587f18c8e14b1b5f6ba013">  359</a></span>&#160;    __le16 <a class="code" href="structlvd.html#a407b2cca01587f18c8e14b1b5f6ba013">length</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;};</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"> *  log logical volume</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="structjfs__log.html">  366</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structjfs__log.html">jfs_log</a> {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="structjfs__log.html#a78bf7128e7eb0d340dd0d78e10594433">  368</a></span>&#160;    <span class="keyword">struct </span>list_head sb_list;<span class="comment">/*  This is used to sync metadata</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">                 *    before writing syncpt.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="structjfs__log.html#aacd4f0e754aa5a915a4808c14d98103d">  371</a></span>&#160;    <span class="keyword">struct </span>list_head journal_list; <span class="comment">/* Global list */</span></div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="structjfs__log.html#acb95df7d76bb856226ba6949769acc8b">  372</a></span>&#160;    <span class="keyword">struct </span>block_device *<a class="code" href="structjfs__log.html#acb95df7d76bb856226ba6949769acc8b">bdev</a>; <span class="comment">/* 4: log lv pointer */</span></div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="structjfs__log.html#a32505e181daaec6af230873399ff4a69">  373</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a32505e181daaec6af230873399ff4a69">serial</a>;     <span class="comment">/* 4: log mount serial number */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="structjfs__log.html#ab25394812380a0c889344819dc321c16">  375</a></span>&#160;    s64 <a class="code" href="structjfs__log.html#ab25394812380a0c889344819dc321c16">base</a>;       <span class="comment">/* @8: log extent address (inline log ) */</span></div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="structjfs__log.html#a76e17828e73acd8c0b34b98bad314ee3">  376</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a76e17828e73acd8c0b34b98bad314ee3">size</a>;       <span class="comment">/* 4: log size in log page (in page) */</span></div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="structjfs__log.html#aa420c99480b8f10386c2ce9343495581">  377</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#aa420c99480b8f10386c2ce9343495581">l2bsize</a>;        <span class="comment">/* 4: log2 of bsize */</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="structjfs__log.html#a9b6294ce161d9c59e2cb3ffed63a4e6f">  379</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structjfs__log.html#a9b6294ce161d9c59e2cb3ffed63a4e6f">flag</a>; <span class="comment">/* 4: flag */</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="structjfs__log.html#a0218ce0666b89054e5ebf1b14ec19ae4">  381</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structlbuf.html">lbuf</a> *<a class="code" href="structjfs__log.html#a0218ce0666b89054e5ebf1b14ec19ae4">lbuf_free</a>; <span class="comment">/* 4: free lbufs */</span></div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="structjfs__log.html#a29a451bcd47fd7cbfbf206c9bbe6c3fb">  382</a></span>&#160;    wait_queue_head_t <a class="code" href="structjfs__log.html#a29a451bcd47fd7cbfbf206c9bbe6c3fb">free_wait</a>;    <span class="comment">/* 4: */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">/* log write */</span></div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="structjfs__log.html#a4fd0e8610a2becd423970b0980949833">  385</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a4fd0e8610a2becd423970b0980949833">logtid</a>;     <span class="comment">/* 4: log tid */</span></div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="structjfs__log.html#a730826936ca1626359699e60a5b036b4">  386</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a730826936ca1626359699e60a5b036b4">page</a>;       <span class="comment">/* 4: page number of eol page */</span></div><div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="structjfs__log.html#ad7af1671e99f1b0973d0fb4a94dbb710">  387</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#ad7af1671e99f1b0973d0fb4a94dbb710">eor</a>;        <span class="comment">/* 4: eor of last record in eol page */</span></div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="structjfs__log.html#aa839e5b937a1da12857fff40eabaee77">  388</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structlbuf.html">lbuf</a> *<a class="code" href="structjfs__log.html#aa839e5b937a1da12857fff40eabaee77">bp</a>;    <span class="comment">/* 4: current log page buffer */</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="structjfs__log.html#a004625349d727d51d4d188d6e566f6a2">  390</a></span>&#160;    <span class="keyword">struct </span>mutex loglock;   <span class="comment">/* 4: log write serialization lock */</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">/* syncpt */</span></div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="structjfs__log.html#aab799660256c9f41acb75c3f8c2199dd">  393</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#aab799660256c9f41acb75c3f8c2199dd">nextsync</a>;       <span class="comment">/* 4: bytes to write before next syncpt */</span></div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="structjfs__log.html#a10591c289f137ce41ba38b8d3c69cacd">  394</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a10591c289f137ce41ba38b8d3c69cacd">active</a>;     <span class="comment">/* 4: */</span></div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="structjfs__log.html#a9f409ea17bac981607e160754eda2f61">  395</a></span>&#160;    wait_queue_head_t <a class="code" href="structjfs__log.html#a9f409ea17bac981607e160754eda2f61">syncwait</a>; <span class="comment">/* 4: */</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">/* commit */</span></div><div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="structjfs__log.html#aa97575e6f0713a0f253f5c8a334b16c4">  398</a></span>&#160;    uint <a class="code" href="structjfs__log.html#aa97575e6f0713a0f253f5c8a334b16c4">cflag</a>;     <span class="comment">/* 4: */</span></div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="structjfs__log.html#a3c6fd9c50382329d4a31acaebc1e79d6">  399</a></span>&#160;    <span class="keyword">struct </span>list_head cqueue; <span class="comment">/* FIFO commit queue */</span></div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="structjfs__log.html#a1fcb8f3742f38446a78282b9c0e4b737">  400</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structtblock.html">tblock</a> *<a class="code" href="structjfs__log.html#a1fcb8f3742f38446a78282b9c0e4b737">flush_tblk</a>; <span class="comment">/* tblk we&#39;re waiting on for flush */</span></div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="structjfs__log.html#a9d2d3b1f8052cd15ad91e2b177b3e6f9">  401</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a9d2d3b1f8052cd15ad91e2b177b3e6f9">gcrtc</a>;      <span class="comment">/* 4: GC_READY transaction count */</span></div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="structjfs__log.html#a151f567f07700fee64d0f345ea114125">  402</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structtblock.html">tblock</a> *<a class="code" href="structjfs__log.html#a151f567f07700fee64d0f345ea114125">gclrt</a>;   <span class="comment">/* 4: latest GC_READY transaction */</span></div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="structjfs__log.html#a51fc43bbde3622d51ca621a8915a6ee5">  403</a></span>&#160;    spinlock_t <a class="code" href="structjfs__log.html#a51fc43bbde3622d51ca621a8915a6ee5">gclock</a>;  <span class="comment">/* 4: group commit lock */</span></div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="structjfs__log.html#a0a4362f344b9ac1979cd4ca1c0c91d6d">  404</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a0a4362f344b9ac1979cd4ca1c0c91d6d">logsize</a>;        <span class="comment">/* 4: log data area size in byte */</span></div><div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="structjfs__log.html#a4ea061e7ba7b729369df03c66ff70335">  405</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a4ea061e7ba7b729369df03c66ff70335">lsn</a>;        <span class="comment">/* 4: end-of-log */</span></div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="structjfs__log.html#a259dda7af1f47ee7852fd3ae2a18c012">  406</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a259dda7af1f47ee7852fd3ae2a18c012">clsn</a>;       <span class="comment">/* 4: clsn */</span></div><div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="structjfs__log.html#a342eff99fabc62036432c8c62b21e299">  407</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a342eff99fabc62036432c8c62b21e299">syncpt</a>;     <span class="comment">/* 4: addr of last syncpt record */</span></div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="structjfs__log.html#a6efac40d61b1f7af621b814f13152f84">  408</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a6efac40d61b1f7af621b814f13152f84">sync</a>;       <span class="comment">/* 4: addr from last logsync() */</span></div><div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="structjfs__log.html#a66981399dfea0c493293142bc12f1c82">  409</a></span>&#160;    <span class="keyword">struct </span>list_head synclist;  <span class="comment">/* 8: logsynclist anchor */</span></div><div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="structjfs__log.html#a15fb20acb01e3a0253c4980e03c4eef4">  410</a></span>&#160;    spinlock_t <a class="code" href="structjfs__log.html#a15fb20acb01e3a0253c4980e03c4eef4">synclock</a>;    <span class="comment">/* 4: synclist lock */</span></div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="structjfs__log.html#a9e1dfbaa566e2891f528e7b6e4e6637a">  411</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structlbuf.html">lbuf</a> *<a class="code" href="structjfs__log.html#a9e1dfbaa566e2891f528e7b6e4e6637a">wqueue</a>;    <span class="comment">/* 4: log pageout queue */</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="structjfs__log.html#a57b8d9b2faf5e3889284367209e60428">  412</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a57b8d9b2faf5e3889284367209e60428">count</a>;      <span class="comment">/* 4: count */</span></div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="structjfs__log.html#a8c1f7e30824f525aa4e2e87957f785fd">  413</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structlogsuper.html#a1c23b97ba27fc36e1e628872d3c2e41f">uuid</a>[16];      <span class="comment">/* 16: 128-bit uuid of log device */</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="structjfs__log.html#a5021fdc12c836aec14d94878eda458dc">  415</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structjfs__log.html#a5021fdc12c836aec14d94878eda458dc">no_integrity</a>;   <span class="comment">/* 3: flag to disable journaling to disk */</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;};</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> * Log flag</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#ab20756be34092f5a5eab89e81e2d6ae0">  421</a></span>&#160;<span class="preprocessor">#define log_INLINELOG   1</span></div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#ad958314b1df8c4acbf981ae198c9f166">  422</a></span>&#160;<span class="preprocessor">#define log_SYNCBARRIER 2</span></div><div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aea6f245352dc968fbd81d0863503d782">  423</a></span>&#160;<span class="preprocessor">#define log_QUIESCE 3</span></div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a1a1066732d75c70aea8889dff65a6b74">  424</a></span>&#160;<span class="preprocessor">#define log_FLUSH   4</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"> * group commit flag</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">/* jfs_log */</span></div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a07eecaffac6114b753f46bf825116727">  430</a></span>&#160;<span class="preprocessor">#define logGC_PAGEOUT   0x00000001</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">/* tblock/lbuf */</span></div><div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a3cfeb4042189824dc68d8d0ec2513622">  433</a></span>&#160;<span class="preprocessor">#define tblkGC_QUEUE        0x0001</span></div><div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#ae6c694cb9db83adca76cf9d8c7924180">  434</a></span>&#160;<span class="preprocessor">#define tblkGC_READY        0x0002</span></div><div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a6079d5a163ad5c8ef3543b0b5103121f">  435</a></span>&#160;<span class="preprocessor">#define tblkGC_COMMIT       0x0004</span></div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a654aa8ad54fdaa6d6b13dd94ca917970">  436</a></span>&#160;<span class="preprocessor">#define tblkGC_COMMITTED    0x0008</span></div><div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a5562da0867eb7959971ec9509e52fe83">  437</a></span>&#160;<span class="preprocessor">#define tblkGC_EOP      0x0010</span></div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#af556ab4dcddb8be67be20c1ab01fbc98">  438</a></span>&#160;<span class="preprocessor">#define tblkGC_FREE     0x0020</span></div><div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a13b5c820cdd0f21890fc65513334cf09">  439</a></span>&#160;<span class="preprocessor">#define tblkGC_LEADER       0x0040</span></div><div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aa1f89bd7b81ff050bc9d661a879de8e0">  440</a></span>&#160;<span class="preprocessor">#define tblkGC_ERROR        0x0080</span></div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aa39cdaeeb8352d0e571c704bab9d7bf9">  441</a></span>&#160;<span class="preprocessor">#define tblkGC_LAZY     0x0100  // D230860</span></div><div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#afeffb29122ab0ad9e9d0fa74800192b1">  442</a></span>&#160;<span class="preprocessor">#define tblkGC_UNLOCKED     0x0200  // D230860</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"> *      log cache buffer header</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="structlbuf.html">  447</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlbuf.html">lbuf</a> {</div><div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="structlbuf.html#abc32e08b5252785714513074d227d171">  448</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structjfs__log.html">jfs_log</a> *<a class="code" href="structlbuf.html#abc32e08b5252785714513074d227d171">l_log</a>;  <span class="comment">/* 4: log associated with buffer */</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">     * data buffer base area</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="structlbuf.html#a61c9fdca76be905f50400d46928db00c">  453</a></span>&#160;    uint <a class="code" href="structlbuf.html#a61c9fdca76be905f50400d46928db00c">l_flag</a>;        <span class="comment">/* 4: pageout control flags */</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="structlbuf.html#ad3ee892de198937f4842146a7859b20f">  455</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structlbuf.html">lbuf</a> *<a class="code" href="structlbuf.html#ad3ee892de198937f4842146a7859b20f">l_wqnext</a>;  <span class="comment">/* 4: write queue link */</span></div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="structlbuf.html#a06aaa4a7e9641c67165175670bc97db1">  456</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structlbuf.html">lbuf</a> *<a class="code" href="structlbuf.html#a06aaa4a7e9641c67165175670bc97db1">l_freelist</a>;    <span class="comment">/* 4: freelistlink */</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="structlbuf.html#a1bed53285146ccbb4361d31659835653">  458</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structlbuf.html#a1bed53285146ccbb4361d31659835653">l_pn</a>;       <span class="comment">/* 4: log page number */</span></div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="structlbuf.html#a0ea79094203f30e310168825bc41ee73">  459</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structlbuf.html#a0ea79094203f30e310168825bc41ee73">l_eor</a>;      <span class="comment">/* 4: log record eor */</span></div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="structlbuf.html#ab3de95f6fef6bcaca1396fd69cd933e8">  460</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structlbuf.html#ab3de95f6fef6bcaca1396fd69cd933e8">l_ceor</a>;     <span class="comment">/* 4: committed log record eor */</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="structlbuf.html#a77147a6d481acaf09a1fd80842bae6bb">  462</a></span>&#160;    s64 <a class="code" href="structlbuf.html#a77147a6d481acaf09a1fd80842bae6bb">l_blkno</a>;        <span class="comment">/* 8: log page block number */</span></div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="structlbuf.html#ac5f1e302e5f343e21e705c17b22ee3ba">  463</a></span>&#160;    caddr_t <a class="code" href="structlbuf.html#ac5f1e302e5f343e21e705c17b22ee3ba">l_ldata</a>;    <span class="comment">/* 4: data page */</span></div><div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="structlbuf.html#a07e75db0a8f474c15f1cb91075290edc">  464</a></span>&#160;    <span class="keyword">struct </span>page *<a class="code" href="structlbuf.html#a07e75db0a8f474c15f1cb91075290edc">l_page</a>;    <span class="comment">/* The page itself */</span></div><div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="structlbuf.html#a6a355e7cf6f5ef4341be17e157daaa83">  465</a></span>&#160;    uint <a class="code" href="structlbuf.html#a6a355e7cf6f5ef4341be17e157daaa83">l_offset</a>;      <span class="comment">/* Offset of l_ldata within the page */</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="structlbuf.html#ab21b49d68192c067e904fe568675481e">  467</a></span>&#160;    wait_queue_head_t <a class="code" href="structlbuf.html#ab21b49d68192c067e904fe568675481e">l_ioevent</a>;    <span class="comment">/* 4: i/o done event */</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;};</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">/* Reuse l_freelist for redrive list */</span></div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a0c1f5c3acedd608861c4f2852d587fca">  471</a></span>&#160;<span class="preprocessor">#define l_redrive_next l_freelist</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"> *  logsynclist block</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"> * common logsyncblk prefix for jbuf_t and tblock</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="structlogsyncblk.html">  478</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlogsyncblk.html">logsyncblk</a> {</div><div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="structlogsyncblk.html#a87bfbb6f4a3f2803ea06c97f4ac9a938">  479</a></span>&#160;    u16 <a class="code" href="structlogsyncblk.html#a87bfbb6f4a3f2803ea06c97f4ac9a938">xflag</a>;      <span class="comment">/* flags */</span></div><div class="line"><a name="l00480"></a><span class="lineno"><a class="line" href="structlogsyncblk.html#aa795148b46340d8738c1eee1f0b14794">  480</a></span>&#160;    u16 <a class="code" href="structlogsyncblk.html#aa795148b46340d8738c1eee1f0b14794">flag</a>;       <span class="comment">/* only meaninful in tblock */</span></div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="structlogsyncblk.html#a021c1be0e36e40a5967850b6c0f85373">  481</a></span>&#160;    <a class="code" href="jfs__types_8h.html#a3cf3df95d13643f7e3b613fcf560b689">lid_t</a> <a class="code" href="structlogsyncblk.html#a021c1be0e36e40a5967850b6c0f85373">lid</a>;      <span class="comment">/* lock id */</span></div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="structlogsyncblk.html#a518e8a9d6c9a626abb2fa6b01d8ce721">  482</a></span>&#160;    s32 <a class="code" href="structlogsyncblk.html#a518e8a9d6c9a626abb2fa6b01d8ce721">lsn</a>;        <span class="comment">/* log sequence number */</span></div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="structlogsyncblk.html#a035134cd5b5a1aef5dc6c9e335abf05b">  483</a></span>&#160;    <span class="keyword">struct </span>list_head synclist;  <span class="comment">/* log sync list link */</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;};</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"> *  logsynclist serialization (per log)</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aeb9cc8439b83ffa99f7b737a6eb48e18">  490</a></span>&#160;<span class="preprocessor">#define LOGSYNC_LOCK_INIT(log) spin_lock_init(&amp;(log)-&gt;synclock)</span></div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#aa8c847dd7feacdf27f7f54d84127a90b">  491</a></span>&#160;<span class="preprocessor">#define LOGSYNC_LOCK(log, flags) spin_lock_irqsave(&amp;(log)-&gt;synclock, flags)</span></div><div class="line"><a name="l00492"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#af3dd8fb0b0222139c1976f216b0b82fa">  492</a></span>&#160;<span class="preprocessor">#define LOGSYNC_UNLOCK(log, flags) \</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">    spin_unlock_irqrestore(&amp;(log)-&gt;synclock, flags)</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">/* compute the difference in bytes of lsn from sync point */</span></div><div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="jfs__logmgr_8h.html#a7586ce4ee31a633cfb5f657dee37e663">  496</a></span>&#160;<span class="preprocessor">#define logdiff(diff, lsn, log)\</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">{\</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">    diff = (lsn) - (log)-&gt;syncpt;\</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">    if (diff &lt; 0)\</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">        diff += (log)-&gt;logsize;\</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">}</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="jfs__logmgr_8h.html#a545f670f4bb4e6725d2429085b7d0b5d">lmLogOpen</a>(<span class="keyword">struct</span> <a class="code" href="structsuper__block.html">super_block</a> *<a class="code" href="ntfs_2debug_8h.html#a65b1b0602e37268ec9bc2c240a676c39">sb</a>);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="jfs__logmgr_8h.html#a68b74f9d04e75d7e2e11440ebaa451da">lmLogClose</a>(<span class="keyword">struct</span> <a class="code" href="structsuper__block.html">super_block</a> *<a class="code" href="ntfs_2debug_8h.html#a65b1b0602e37268ec9bc2c240a676c39">sb</a>);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="jfs__logmgr_8h.html#a9a35bb7161043a66c34d1a8367ac4169">lmLogShutdown</a>(<span class="keyword">struct</span> <a class="code" href="structjfs__log.html">jfs_log</a> * log);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="jfs__logmgr_8h.html#a4218e987b26491def8e4f3deea169dc5">lmLogInit</a>(<span class="keyword">struct</span> <a class="code" href="structjfs__log.html">jfs_log</a> * log);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="jfs__logmgr_8h.html#a9a80a1a5368838f97df73883ca0d1ce9">lmLogFormat</a>(<span class="keyword">struct</span> <a class="code" href="structjfs__log.html">jfs_log</a> *log, s64 logAddress, <span class="keywordtype">int</span> logSize);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="jfs__logmgr_8h.html#a2fbed54d55ef92e2fdd273fa6cb7410f">lmGroupCommit</a>(<span class="keyword">struct</span> <a class="code" href="structjfs__log.html">jfs_log</a> *, <span class="keyword">struct</span> <a class="code" href="structtblock.html">tblock</a> *);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="jfs__logmgr_8h.html#a5214992fc5919c66eee76da1329a899c">jfsIOWait</a>(<span class="keywordtype">void</span> *);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="jfs__logmgr_8h.html#ac4f06ef1d6899abe950ef50b56d96fc8">jfs_flush_journal</a>(<span class="keyword">struct</span> <a class="code" href="structjfs__log.html">jfs_log</a> * log, <span class="keywordtype">int</span> wait);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="jfs__logmgr_8h.html#aeebf97c993f3a59a4c67969d58e3e99f">jfs_syncpt</a>(<span class="keyword">struct</span> <a class="code" href="structjfs__log.html">jfs_log</a> *log, <span class="keywordtype">int</span> hard_sync);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#endif              </span><span class="comment">/* _H_JFS_LOGMGR */</span><span class="preprocessor"></span></div><div class="ttc" id="structpxd__t_html"><div class="ttname"><a href="structpxd__t.html">pxd_t</a></div><div class="ttdef"><b>Definition:</b> jfs_types.h:65</div></div>
<div class="ttc" id="structjfs__log_html_a29a451bcd47fd7cbfbf206c9bbe6c3fb"><div class="ttname"><a href="structjfs__log.html#a29a451bcd47fd7cbfbf206c9bbe6c3fb">jfs_log::free_wait</a></div><div class="ttdeci">wait_queue_head_t free_wait</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:382</div></div>
<div class="ttc" id="structlrd_html_a700d4dfc504008c48b6cba07d3b80d9b"><div class="ttname"><a href="structlrd.html#a700d4dfc504008c48b6cba07d3b80d9b">lrd::nextent</a></div><div class="ttdeci">__le32 nextent</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:311</div></div>
<div class="ttc" id="structlogpage_html_a69094c460c73efef80867cae793c2112"><div class="ttname"><a href="structlogpage.html#a69094c460c73efef80867cae793c2112">logpage::rsrvd</a></div><div class="ttdeci">__le16 rsrvd</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:125</div></div>
<div class="ttc" id="structjfs__log_html_a4fd0e8610a2becd423970b0980949833"><div class="ttname"><a href="structjfs__log.html#a4fd0e8610a2becd423970b0980949833">jfs_log::logtid</a></div><div class="ttdeci">int logtid</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:385</div></div>
<div class="ttc" id="structlrd_html_a3fed9dfb5db5803488ddfcb3c9db76fc"><div class="ttname"><a href="structlrd.html#a3fed9dfb5db5803488ddfcb3c9db76fc">lrd::logtid</a></div><div class="ttdeci">__le32 logtid</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:205</div></div>
<div class="ttc" id="structjfs__log_html_aa839e5b937a1da12857fff40eabaee77"><div class="ttname"><a href="structjfs__log.html#aa839e5b937a1da12857fff40eabaee77">jfs_log::bp</a></div><div class="ttdeci">struct lbuf * bp</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:388</div></div>
<div class="ttc" id="structjfs__log_html_a32505e181daaec6af230873399ff4a69"><div class="ttname"><a href="structjfs__log.html#a32505e181daaec6af230873399ff4a69">jfs_log::serial</a></div><div class="ttdeci">int serial</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:373</div></div>
<div class="ttc" id="structjfs__log_html_a151f567f07700fee64d0f345ea114125"><div class="ttname"><a href="structjfs__log.html#a151f567f07700fee64d0f345ea114125">jfs_log::gclrt</a></div><div class="ttdeci">struct tblock * gclrt</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:402</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a68b74f9d04e75d7e2e11440ebaa451da"><div class="ttname"><a href="jfs__logmgr_8h.html#a68b74f9d04e75d7e2e11440ebaa451da">lmLogClose</a></div><div class="ttdeci">int lmLogClose(struct super_block *sb)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:1456</div></div>
<div class="ttc" id="structjfs__log_html_aa97575e6f0713a0f253f5c8a334b16c4"><div class="ttname"><a href="structjfs__log.html#aa97575e6f0713a0f253f5c8a334b16c4">jfs_log::cflag</a></div><div class="ttdeci">uint cflag</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:398</div></div>
<div class="ttc" id="structjfs__log_html_aab799660256c9f41acb75c3f8c2199dd"><div class="ttname"><a href="structjfs__log.html#aab799660256c9f41acb75c3f8c2199dd">jfs_log::nextsync</a></div><div class="ttdeci">int nextsync</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:393</div></div>
<div class="ttc" id="structjfs__log_html_ab25394812380a0c889344819dc321c16"><div class="ttname"><a href="structjfs__log.html#ab25394812380a0c889344819dc321c16">jfs_log::base</a></div><div class="ttdeci">s64 base</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:375</div></div>
<div class="ttc" id="structjfs__log_html_a9f409ea17bac981607e160754eda2f61"><div class="ttname"><a href="structjfs__log.html#a9f409ea17bac981607e160754eda2f61">jfs_log::syncwait</a></div><div class="ttdeci">wait_queue_head_t syncwait</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:395</div></div>
<div class="ttc" id="structlrd_html_a29fcf857809650d9a6b17581be3a419a"><div class="ttname"><a href="structlrd.html#a29fcf857809650d9a6b17581be3a419a">lrd::iagnum</a></div><div class="ttdeci">__le32 iagnum</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:283</div></div>
<div class="ttc" id="structlrd_html_a8bc8ef778f5697e4eefa2cbd79b3179a"><div class="ttname"><a href="structlrd.html#a8bc8ef778f5697e4eefa2cbd79b3179a">lrd::type</a></div><div class="ttdeci">__le16 type</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:207</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a9a80a1a5368838f97df73883ca0d1ce9"><div class="ttname"><a href="jfs__logmgr_8h.html#a9a80a1a5368838f97df73883ca0d1ce9">lmLogFormat</a></div><div class="ttdeci">int lmLogFormat(struct jfs_log *log, s64 logAddress, int logSize)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:2377</div></div>
<div class="ttc" id="structsuper__block_html"><div class="ttname"><a href="structsuper__block.html">super_block</a></div><div class="ttdef"><b>Definition:</b> ubifs.h:968</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a5214992fc5919c66eee76da1329a899c"><div class="ttname"><a href="jfs__logmgr_8h.html#a5214992fc5919c66eee76da1329a899c">jfsIOWait</a></div><div class="ttdeci">int jfsIOWait(void *)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:2333</div></div>
<div class="ttc" id="structlbuf_html_a0ea79094203f30e310168825bc41ee73"><div class="ttname"><a href="structlbuf.html#a0ea79094203f30e310168825bc41ee73">lbuf::l_eor</a></div><div class="ttdeci">int l_eor</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:459</div></div>
<div class="ttc" id="structlrd_html_ac6e04aed99a1fadb0759bc59aa68b14e"><div class="ttname"><a href="structlrd.html#ac6e04aed99a1fadb0759bc59aa68b14e">lrd::type</a></div><div class="ttdeci">__le32 type</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:310</div></div>
<div class="ttc" id="structjfs__log_html"><div class="ttname"><a href="structjfs__log.html">jfs_log</a></div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:366</div></div>
<div class="ttc" id="cifsacl_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="cifsacl_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">__le16 type</div><div class="ttdef"><b>Definition:</b> cifsacl.h:1175</div></div>
<div class="ttc" id="structjfs__log_html_a0218ce0666b89054e5ebf1b14ec19ae4"><div class="ttname"><a href="structjfs__log.html#a0218ce0666b89054e5ebf1b14ec19ae4">jfs_log::lbuf_free</a></div><div class="ttdeci">struct lbuf * lbuf_free</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:381</div></div>
<div class="ttc" id="structlogsuper_html_acd1e5b5943222d930b2f0e6631de06df"><div class="ttname"><a href="structlogsuper.html#acd1e5b5943222d930b2f0e6631de06df">logsuper::version</a></div><div class="ttdeci">__le32 version</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:66</div></div>
<div class="ttc" id="structjfs__log_html_a9b6294ce161d9c59e2cb3ffed63a4e6f"><div class="ttname"><a href="structjfs__log.html#a9b6294ce161d9c59e2cb3ffed63a4e6f">jfs_log::flag</a></div><div class="ttdeci">unsigned long flag</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:379</div></div>
<div class="ttc" id="structlbuf_html_a06aaa4a7e9641c67165175670bc97db1"><div class="ttname"><a href="structlbuf.html#a06aaa4a7e9641c67165175670bc97db1">lbuf::l_freelist</a></div><div class="ttdeci">struct lbuf * l_freelist</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:456</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a2fbed54d55ef92e2fdd273fa6cb7410f"><div class="ttname"><a href="jfs__logmgr_8h.html#a2fbed54d55ef92e2fdd273fa6cb7410f">lmGroupCommit</a></div><div class="ttdeci">int lmGroupCommit(struct jfs_log *, struct tblock *)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:679</div></div>
<div class="ttc" id="structlbuf_html_a1bed53285146ccbb4361d31659835653"><div class="ttname"><a href="structlbuf.html#a1bed53285146ccbb4361d31659835653">lbuf::l_pn</a></div><div class="ttdeci">int l_pn</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:458</div></div>
<div class="ttc" id="structlogsuper_html_a1c23b97ba27fc36e1e628872d3c2e41f"><div class="ttname"><a href="structlogsuper.html#a1c23b97ba27fc36e1e628872d3c2e41f">logsuper::uuid</a></div><div class="ttdeci">char uuid[16]</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:76</div></div>
<div class="ttc" id="structlrd_html"><div class="ttname"><a href="structlrd.html">lrd</a></div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:201</div></div>
<div class="ttc" id="structlogsuper_html_a4e1172999b84c471b767e7a385491e69"><div class="ttname"><a href="structlogsuper.html#a4e1172999b84c471b767e7a385491e69">logsuper::size</a></div><div class="ttdeci">__le32 size</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:68</div></div>
<div class="ttc" id="structlogpage_html"><div class="ttname"><a href="structlogpage.html">logpage</a></div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:122</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a9a35bb7161043a66c34d1a8367ac4169"><div class="ttname"><a href="jfs__logmgr_8h.html#a9a35bb7161043a66c34d1a8367ac4169">lmLogShutdown</a></div><div class="ttdeci">int lmLogShutdown(struct jfs_log *log)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:1652</div></div>
<div class="ttc" id="structlbuf_html_ac5f1e302e5f343e21e705c17b22ee3ba"><div class="ttname"><a href="structlbuf.html#ac5f1e302e5f343e21e705c17b22ee3ba">lbuf::l_ldata</a></div><div class="ttdeci">caddr_t l_ldata</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:463</div></div>
<div class="ttc" id="structjfs__log_html_a51fc43bbde3622d51ca621a8915a6ee5"><div class="ttname"><a href="structjfs__log.html#a51fc43bbde3622d51ca621a8915a6ee5">jfs_log::gclock</a></div><div class="ttdeci">spinlock_t gclock</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:403</div></div>
<div class="ttc" id="structlogsuper_html_a1dabbf9393eaaa736875005a3ea3b87d"><div class="ttname"><a href="structlogsuper.html#a1dabbf9393eaaa736875005a3ea3b87d">logsuper::label</a></div><div class="ttdeci">char label[16]</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:77</div></div>
<div class="ttc" id="structlbuf_html_ab3de95f6fef6bcaca1396fd69cd933e8"><div class="ttname"><a href="structlbuf.html#ab3de95f6fef6bcaca1396fd69cd933e8">lbuf::l_ceor</a></div><div class="ttdeci">int l_ceor</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:460</div></div>
<div class="ttc" id="structlogpage_html_a15505ac4a5d802a22d15e02ba5b6dfd8"><div class="ttname"><a href="structlogpage.html#a15505ac4a5d802a22d15e02ba5b6dfd8">logpage::eor</a></div><div class="ttdeci">__le16 eor</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:126</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_ac4f06ef1d6899abe950ef50b56d96fc8"><div class="ttname"><a href="jfs__logmgr_8h.html#ac4f06ef1d6899abe950ef50b56d96fc8">jfs_flush_journal</a></div><div class="ttdeci">void jfs_flush_journal(struct jfs_log *log, int wait)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:1530</div></div>
<div class="ttc" id="structjfs__log_html_a15fb20acb01e3a0253c4980e03c4eef4"><div class="ttname"><a href="structjfs__log.html#a15fb20acb01e3a0253c4980e03c4eef4">jfs_log::synclock</a></div><div class="ttdeci">spinlock_t synclock</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:410</div></div>
<div class="ttc" id="structjfs__log_html_a10591c289f137ce41ba38b8d3c69cacd"><div class="ttname"><a href="structjfs__log.html#a10591c289f137ce41ba38b8d3c69cacd">jfs_log::active</a></div><div class="ttdeci">int active</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:394</div></div>
<div class="ttc" id="structlogsyncblk_html_aa795148b46340d8738c1eee1f0b14794"><div class="ttname"><a href="structlogsyncblk.html#aa795148b46340d8738c1eee1f0b14794">logsyncblk::flag</a></div><div class="ttdeci">u16 flag</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:480</div></div>
<div class="ttc" id="structjfs__log_html_a0a4362f344b9ac1979cd4ca1c0c91d6d"><div class="ttname"><a href="structjfs__log.html#a0a4362f344b9ac1979cd4ca1c0c91d6d">jfs_log::logsize</a></div><div class="ttdeci">int logsize</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:404</div></div>
<div class="ttc" id="structjfs__log_html_a5021fdc12c836aec14d94878eda458dc"><div class="ttname"><a href="structjfs__log.html#a5021fdc12c836aec14d94878eda458dc">jfs_log::no_integrity</a></div><div class="ttdeci">int no_integrity</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:415</div></div>
<div class="ttc" id="structlogsuper_html_a1d63bfc11ff3e3e7fad8ba650af5ae99"><div class="ttname"><a href="structlogsuper.html#a1d63bfc11ff3e3e7fad8ba650af5ae99">logsuper::end</a></div><div class="ttdeci">__le32 end</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:75</div></div>
<div class="ttc" id="structlrd_html_ac8dafa635309faf05c2dd3e9c0e07d56"><div class="ttname"><a href="structlrd.html#ac8dafa635309faf05c2dd3e9c0e07d56">lrd::length</a></div><div class="ttdeci">__le16 length</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:208</div></div>
<div class="ttc" id="structlbuf_html_a07e75db0a8f474c15f1cb91075290edc"><div class="ttname"><a href="structlbuf.html#a07e75db0a8f474c15f1cb91075290edc">lbuf::l_page</a></div><div class="ttdeci">struct page * l_page</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:464</div></div>
<div class="ttc" id="structlvd_html"><div class="ttname"><a href="structlvd.html">lvd</a></div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:357</div></div>
<div class="ttc" id="summary_8h_html_a63c41f9614ee9a4e1beb75eabad72f22"><div class="ttname"><a href="summary_8h.html#a63c41f9614ee9a4e1beb75eabad72f22">inode</a></div><div class="ttdeci">jint32_t inode</div><div class="ttdef"><b>Definition:</b> summary.h:848</div></div>
<div class="ttc" id="structlogsuper_html_a8081fb5d91eae8feea6eb989193b57d4"><div class="ttname"><a href="structlogsuper.html#a8081fb5d91eae8feea6eb989193b57d4">logsuper::active</a></div><div class="ttdeci">struct logsuper::@298 active[MAX_ACTIVE]</div></div>
<div class="ttc" id="structjfs__log_html_ad7af1671e99f1b0973d0fb4a94dbb710"><div class="ttname"><a href="structjfs__log.html#ad7af1671e99f1b0973d0fb4a94dbb710">jfs_log::eor</a></div><div class="ttdeci">int eor</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:387</div></div>
<div class="ttc" id="structlogsuper_html_a42e2346a689127982cc36c2f9d996c69"><div class="ttname"><a href="structlogsuper.html#a42e2346a689127982cc36c2f9d996c69">logsuper::serial</a></div><div class="ttdeci">__le32 serial</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:67</div></div>
<div class="ttc" id="structlogsuper_html_ae7987bfba88103aac7c4297fcee3e6eb"><div class="ttname"><a href="structlogsuper.html#ae7987bfba88103aac7c4297fcee3e6eb">logsuper::magic</a></div><div class="ttdeci">__le32 magic</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:65</div></div>
<div class="ttc" id="structjfs__log_html_a9e1dfbaa566e2891f528e7b6e4e6637a"><div class="ttname"><a href="structjfs__log.html#a9e1dfbaa566e2891f528e7b6e4e6637a">jfs_log::wqueue</a></div><div class="ttdeci">struct lbuf * wqueue</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:411</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a545f670f4bb4e6725d2429085b7d0b5d"><div class="ttname"><a href="jfs__logmgr_8h.html#a545f670f4bb4e6725d2429085b7d0b5d">lmLogOpen</a></div><div class="ttdeci">int lmLogOpen(struct super_block *sb)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:1079</div></div>
<div class="ttc" id="structlrd_html_a28dcd41272e4d2d9b00deaf382063c68"><div class="ttname"><a href="structlrd.html#a28dcd41272e4d2d9b00deaf382063c68">lrd::sync</a></div><div class="ttdeci">__le32 sync</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:294</div></div>
<div class="ttc" id="ntfs_2debug_8h_html_a65b1b0602e37268ec9bc2c240a676c39"><div class="ttname"><a href="ntfs_2debug_8h.html#a65b1b0602e37268ec9bc2c240a676c39">sb</a></div><div class="ttdeci">const struct super_block * sb</div><div class="ttdef"><b>Definition:</b> debug.h:62</div></div>
<div class="ttc" id="structjfs__log_html_a57b8d9b2faf5e3889284367209e60428"><div class="ttname"><a href="structjfs__log.html#a57b8d9b2faf5e3889284367209e60428">jfs_log::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:412</div></div>
<div class="ttc" id="structjfs__log_html_a259dda7af1f47ee7852fd3ae2a18c012"><div class="ttname"><a href="structjfs__log.html#a259dda7af1f47ee7852fd3ae2a18c012">jfs_log::clsn</a></div><div class="ttdeci">int clsn</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:406</div></div>
<div class="ttc" id="structlvd_html_a1b69d7017cd2c61decc80833d398f1bc"><div class="ttname"><a href="structlvd.html#a1b69d7017cd2c61decc80833d398f1bc">lvd::offset</a></div><div class="ttdeci">__le16 offset</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:358</div></div>
<div class="ttc" id="jfs__filsys_8h_html"><div class="ttname"><a href="jfs__filsys_8h.html">jfs_filsys.h</a></div></div>
<div class="ttc" id="structlbuf_html"><div class="ttname"><a href="structlbuf.html">lbuf</a></div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:447</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a7f4eb7d6e1f681c2bb441132bc68d3eb"><div class="ttname"><a href="jfs__logmgr_8h.html#a7f4eb7d6e1f681c2bb441132bc68d3eb">LOGPSIZE</a></div><div class="ttdeci">#define LOGPSIZE</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:30</div></div>
<div class="ttc" id="structlbuf_html_abc32e08b5252785714513074d227d171"><div class="ttname"><a href="structlbuf.html#abc32e08b5252785714513074d227d171">lbuf::l_log</a></div><div class="ttdeci">struct jfs_log * l_log</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:448</div></div>
<div class="ttc" id="structjfs__log_html_a6efac40d61b1f7af621b814f13152f84"><div class="ttname"><a href="structjfs__log.html#a6efac40d61b1f7af621b814f13152f84">jfs_log::sync</a></div><div class="ttdeci">int sync</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:408</div></div>
<div class="ttc" id="structjfs__log_html_a4ea061e7ba7b729369df03c66ff70335"><div class="ttname"><a href="structjfs__log.html#a4ea061e7ba7b729369df03c66ff70335">jfs_log::lsn</a></div><div class="ttdeci">int lsn</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:405</div></div>
<div class="ttc" id="structlogsuper_html_a95fbf442099e9d466cf1b001e910ffed"><div class="ttname"><a href="structlogsuper.html#a95fbf442099e9d466cf1b001e910ffed">logsuper::bsize</a></div><div class="ttdeci">__le32 bsize</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:69</div></div>
<div class="ttc" id="structlbuf_html_a61c9fdca76be905f50400d46928db00c"><div class="ttname"><a href="structlbuf.html#a61c9fdca76be905f50400d46928db00c">lbuf::l_flag</a></div><div class="ttdeci">uint l_flag</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:453</div></div>
<div class="ttc" id="cifspdu_8h_html_aaa61af584164f982573a6890174ef943"><div class="ttname"><a href="cifspdu_8h.html#aaa61af584164f982573a6890174ef943">data</a></div><div class="ttdeci">__u8 * data</div><div class="ttdef"><b>Definition:</b> cifspdu.h:457</div></div>
<div class="ttc" id="structlbuf_html_ab21b49d68192c067e904fe568675481e"><div class="ttname"><a href="structlbuf.html#ab21b49d68192c067e904fe568675481e">lbuf::l_ioevent</a></div><div class="ttdeci">wait_queue_head_t l_ioevent</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:467</div></div>
<div class="ttc" id="structjfs__log_html_a342eff99fabc62036432c8c62b21e299"><div class="ttname"><a href="structjfs__log.html#a342eff99fabc62036432c8c62b21e299">jfs_log::syncpt</a></div><div class="ttdeci">int syncpt</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:407</div></div>
<div class="ttc" id="structjfs__log_html_acb95df7d76bb856226ba6949769acc8b"><div class="ttname"><a href="structjfs__log.html#acb95df7d76bb856226ba6949769acc8b">jfs_log::bdev</a></div><div class="ttdeci">struct block_device * bdev</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:372</div></div>
<div class="ttc" id="structlogsuper_html_acedb929e0da078a28f6a4b612767f6f1"><div class="ttname"><a href="structlogsuper.html#acedb929e0da078a28f6a4b612767f6f1">logsuper::state</a></div><div class="ttdeci">__le32 state</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:73</div></div>
<div class="ttc" id="structlogsyncblk_html_a87bfbb6f4a3f2803ea06c97f4ac9a938"><div class="ttname"><a href="structlogsyncblk.html#a87bfbb6f4a3f2803ea06c97f4ac9a938">logsyncblk::xflag</a></div><div class="ttdeci">u16 xflag</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:479</div></div>
<div class="ttc" id="structlrd_html_a1a29e5888db47a01c09f2705349aed47"><div class="ttname"><a href="structlrd.html#a1a29e5888db47a01c09f2705349aed47">lrd::pxd</a></div><div class="ttdeci">pxd_t pxd</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:235</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a3326e3c63b90eef3a41e0c25e886c3e2"><div class="ttname"><a href="jfs__logmgr_8h.html#a3326e3c63b90eef3a41e0c25e886c3e2">MAX_ACTIVE</a></div><div class="ttdeci">#define MAX_ACTIVE</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:62</div></div>
<div class="ttc" id="structlogsuper_html"><div class="ttname"><a href="structlogsuper.html">logsuper</a></div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:64</div></div>
<div class="ttc" id="structlogsyncblk_html_a518e8a9d6c9a626abb2fa6b01d8ce721"><div class="ttname"><a href="structlogsyncblk.html#a518e8a9d6c9a626abb2fa6b01d8ce721">logsyncblk::lsn</a></div><div class="ttdeci">s32 lsn</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:482</div></div>
<div class="ttc" id="structlbuf_html_ad3ee892de198937f4842146a7859b20f"><div class="ttname"><a href="structlbuf.html#ad3ee892de198937f4842146a7859b20f">lbuf::l_wqnext</a></div><div class="ttdeci">struct lbuf * l_wqnext</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:455</div></div>
<div class="ttc" id="structjfs__log_html_a76e17828e73acd8c0b34b98bad314ee3"><div class="ttname"><a href="structjfs__log.html#a76e17828e73acd8c0b34b98bad314ee3">jfs_log::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:376</div></div>
<div class="ttc" id="structlrd_html_a9c99d35ba39d6282a85f150662f981fa"><div class="ttname"><a href="structlrd.html#a9c99d35ba39d6282a85f150662f981fa">lrd::rsrvd</a></div><div class="ttdeci">__le16 rsrvd</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:250</div></div>
<div class="ttc" id="structjfs__log_html_a730826936ca1626359699e60a5b036b4"><div class="ttname"><a href="structjfs__log.html#a730826936ca1626359699e60a5b036b4">jfs_log::page</a></div><div class="ttdeci">int page</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:386</div></div>
<div class="ttc" id="structlrd_html_a1ad4f2425cea3b3451bad4a622dd6e1e"><div class="ttname"><a href="structlrd.html#a1ad4f2425cea3b3451bad4a622dd6e1e">lrd::fileset</a></div><div class="ttdeci">__le32 fileset</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:231</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_a4218e987b26491def8e4f3deea169dc5"><div class="ttname"><a href="jfs__logmgr_8h.html#a4218e987b26491def8e4f3deea169dc5">lmLogInit</a></div><div class="ttdeci">int lmLogInit(struct jfs_log *log)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:1262</div></div>
<div class="ttc" id="structtblock_html"><div class="ttname"><a href="structtblock.html">tblock</a></div><div class="ttdef"><b>Definition:</b> jfs_txnmgr.h:33</div></div>
<div class="ttc" id="structjfs__log_html_a1fcb8f3742f38446a78282b9c0e4b737"><div class="ttname"><a href="structjfs__log.html#a1fcb8f3742f38446a78282b9c0e4b737">jfs_log::flush_tblk</a></div><div class="ttdeci">struct tblock * flush_tblk</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:400</div></div>
<div class="ttc" id="structlogsyncblk_html"><div class="ttname"><a href="structlogsyncblk.html">logsyncblk</a></div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:478</div></div>
<div class="ttc" id="structlbuf_html_a77147a6d481acaf09a1fd80842bae6bb"><div class="ttname"><a href="structlbuf.html#a77147a6d481acaf09a1fd80842bae6bb">lbuf::l_blkno</a></div><div class="ttdeci">s64 l_blkno</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:462</div></div>
<div class="ttc" id="jfs__logmgr_8h_html_aeebf97c993f3a59a4c67969d58e3e99f"><div class="ttname"><a href="jfs__logmgr_8h.html#aeebf97c993f3a59a4c67969d58e3e99f">jfs_syncpt</a></div><div class="ttdeci">void jfs_syncpt(struct jfs_log *log, int hard_sync)</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.c:1059</div></div>
<div class="ttc" id="structlogsuper_html_ab2a37d89ba722e25dd7e82ae5e8a866c"><div class="ttname"><a href="structlogsuper.html#ab2a37d89ba722e25dd7e82ae5e8a866c">logsuper::flag</a></div><div class="ttdeci">__le32 flag</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:72</div></div>
<div class="ttc" id="structlrd_html_a888496055b9fc5136178666dd1ad38e9"><div class="ttname"><a href="structlrd.html#a888496055b9fc5136178666dd1ad38e9">lrd::aggregate</a></div><div class="ttdeci">__le32 aggregate</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:209</div></div>
<div class="ttc" id="structlrd_html_a59d4fed4a76eaca757d4ef1211b7673a"><div class="ttname"><a href="structlrd.html#a59d4fed4a76eaca757d4ef1211b7673a">lrd::l2linesize</a></div><div class="ttdeci">__le16 l2linesize</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:234</div></div>
<div class="ttc" id="structlogpage_html_a182e3b842ebd0883383619927aef06f2"><div class="ttname"><a href="structlogpage.html#a182e3b842ebd0883383619927aef06f2">logpage::page</a></div><div class="ttdeci">__le32 page</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:124</div></div>
<div class="ttc" id="structjfs__log_html_a9d2d3b1f8052cd15ad91e2b177b3e6f9"><div class="ttname"><a href="structjfs__log.html#a9d2d3b1f8052cd15ad91e2b177b3e6f9">jfs_log::gcrtc</a></div><div class="ttdeci">int gcrtc</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:401</div></div>
<div class="ttc" id="structlrd_html_a6f498aadee9bdecb388290ab2d2aef34"><div class="ttname"><a href="structlrd.html#a6f498aadee9bdecb388290ab2d2aef34">lrd::inode</a></div><div class="ttdeci">__le32 inode</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:232</div></div>
<div class="ttc" id="structlrd_html_a8a601b1971aa00c29ccd2bf2b1ff4490"><div class="ttname"><a href="structlrd.html#a8a601b1971aa00c29ccd2bf2b1ff4490">lrd::inoext_idx</a></div><div class="ttdeci">__le32 inoext_idx</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:284</div></div>
<div class="ttc" id="jfs__lock_8h_html"><div class="ttname"><a href="jfs__lock_8h.html">jfs_lock.h</a></div></div>
<div class="ttc" id="structlvd_html_a407b2cca01587f18c8e14b1b5f6ba013"><div class="ttname"><a href="structlvd.html#a407b2cca01587f18c8e14b1b5f6ba013">lvd::length</a></div><div class="ttdeci">__le16 length</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:359</div></div>
<div class="ttc" id="jfs__types_8h_html_a3cf3df95d13643f7e3b613fcf560b689"><div class="ttname"><a href="jfs__types_8h.html#a3cf3df95d13643f7e3b613fcf560b689">lid_t</a></div><div class="ttdeci">u16 lid_t</div><div class="ttdef"><b>Definition:</b> jfs_types.h:40</div></div>
<div class="ttc" id="structlrd_html_a17572705c7ffc5f39afbbbd824f24f83"><div class="ttname"><a href="structlrd.html#a17572705c7ffc5f39afbbbd824f24f83">lrd::nxd</a></div><div class="ttdeci">__le16 nxd</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:266</div></div>
<div class="ttc" id="structlbuf_html_a6a355e7cf6f5ef4341be17e157daaa83"><div class="ttname"><a href="structlbuf.html#a6a355e7cf6f5ef4341be17e157daaa83">lbuf::l_offset</a></div><div class="ttdeci">uint l_offset</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:465</div></div>
<div class="ttc" id="structjfs__log_html_aa420c99480b8f10386c2ce9343495581"><div class="ttname"><a href="structjfs__log.html#aa420c99480b8f10386c2ce9343495581">jfs_log::l2bsize</a></div><div class="ttdeci">int l2bsize</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:377</div></div>
<div class="ttc" id="structlogsuper_html_a36b240fbab2d20ee831e64bcfb2d482d"><div class="ttname"><a href="structlogsuper.html#a36b240fbab2d20ee831e64bcfb2d482d">logsuper::l2bsize</a></div><div class="ttdeci">__le32 l2bsize</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:70</div></div>
<div class="ttc" id="structlrd_html_a6eab4a1db37b1402ec56cfc4bf417de7"><div class="ttname"><a href="structlrd.html#a6eab4a1db37b1402ec56cfc4bf417de7">lrd::backchain</a></div><div class="ttdeci">__le32 backchain</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:206</div></div>
<div class="ttc" id="structlogsyncblk_html_a021c1be0e36e40a5967850b6c0f85373"><div class="ttname"><a href="structlogsyncblk.html#a021c1be0e36e40a5967850b6c0f85373">logsyncblk::lid</a></div><div class="ttdeci">lid_t lid</div><div class="ttdef"><b>Definition:</b> jfs_logmgr.h:481</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_9e050d77ec0f89a0ef4aa4bdafff2849.html">jfs</a></li><li class="navelem"><a class="el" href="jfs__logmgr_8h.html">jfs_logmgr.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
